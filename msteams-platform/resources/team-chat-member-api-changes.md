---
title: Alterações na API de bot para membros da equipe/chat
author: ojasvichoudhary
description: Descreve as alterações futuras e em andamento nas APIs bot usadas para recuperar membros de equipes e chats
keywords: lista de membros da equipe de apis de estrutura de bot
ms.topic: reference
ms.author: ojchoudh
ms.openlocfilehash: ee90c9c324f11e191cf596bcf8e27cd2bef41240
ms.sourcegitcommit: f5ee3fa5ef6126d9bf845948d27d9067b3bbb994
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/06/2021
ms.locfileid: "51596179"
---
# <a name="changes-to-teams-bot-apis-for-fetching-team-and-chat-members"></a><span data-ttu-id="f81ad-104">Alterações nas APIs de bot do Teams para buscar membros de equipe e chat</span><span class="sxs-lookup"><span data-stu-id="f81ad-104">Changes to Teams bot APIs for fetching team and chat members</span></span>

>[!NOTE]
> <span data-ttu-id="f81ad-105">Começamos com o processo de deprecation para `TeamsInfo.getMembers` `TeamsInfo.GetMembersAsync` e APIs.</span><span class="sxs-lookup"><span data-stu-id="f81ad-105">We've started with the deprecation process for `TeamsInfo.getMembers` and `TeamsInfo.GetMembersAsync` APIs.</span></span> <span data-ttu-id="f81ad-106">Inicialmente, elas serão fortemente aceleradas para 5 solicitações por minuto e retornarão um máximo de 10 mil membros por equipe.</span><span class="sxs-lookup"><span data-stu-id="f81ad-106">Initially, they will be heavily throttled to 5 requests per minute and return a maximum of 10K members per team.</span></span> <span data-ttu-id="f81ad-107">Isso fará com que a lista completa não seja retornada à medida que o tamanho da equipe aumenta.</span><span class="sxs-lookup"><span data-stu-id="f81ad-107">This will result in the full roster not being returned as team size increases.</span></span> 
> 
> <span data-ttu-id="f81ad-108">Você deve atualizar para a versão **4.10** ou superior do SDK da Estrutura de Bot e alternar para os pontos de extremidade da API paginada ou para a API de usuário `TeamsInfo.GetMemberAsync` único.</span><span class="sxs-lookup"><span data-stu-id="f81ad-108">**You must update to version 4.10 or higher of the Bot Framework SDK** and switch to the paginated API endpoints, or the `TeamsInfo.GetMemberAsync` single user API.</span></span> <span data-ttu-id="f81ad-109">Isso também se aplica ao bot mesmo que você não esteja usando diretamente essas APIs, pois os SDKs mais antigos chamam essas APIs durante [eventos membersAdded.](../bots/how-to/conversations/subscribe-to-conversation-events.md#team-members-added)</span><span class="sxs-lookup"><span data-stu-id="f81ad-109">This also applies to your bot even if you're not directly using these APIs, as older SDKs call these APIs during [membersAdded](../bots/how-to/conversations/subscribe-to-conversation-events.md#team-members-added) events.</span></span> <span data-ttu-id="f81ad-110">Para exibir a lista de alterações futuras, consulte [ALTERAÇÕES da API](team-chat-member-api-changes.md#api-changes).</span><span class="sxs-lookup"><span data-stu-id="f81ad-110">To view the list of upcoming changes, see [API changes](team-chat-member-api-changes.md#api-changes).</span></span> 

<span data-ttu-id="f81ad-111">Atualmente, os desenvolvedores de bot que querem recuperar informações para um ou mais membros de um chat ou equipe usam as APIs de bot do Microsoft Teams `TeamsInfo.GetMembersAsync` (para C#) ou `TeamsInfo.getMembers` (para TYPEScript/Node.js) [APIs (documentadas aqui)](../bots/how-to/get-teams-context.md#fetching-the-roster-or-user-profile).</span><span class="sxs-lookup"><span data-stu-id="f81ad-111">Currently, bot developers who want to retrieve information for one or more members of a chat or team use the Microsoft Teams bot APIs `TeamsInfo.GetMembersAsync` (for C#) or `TeamsInfo.getMembers` (for TypeScript/Node.js) APIs [(documented here)](../bots/how-to/get-teams-context.md#fetching-the-roster-or-user-profile).</span></span> <span data-ttu-id="f81ad-112">Essas APIs têm várias deficiências hoje em dia:</span><span class="sxs-lookup"><span data-stu-id="f81ad-112">These APIs have several shortcomings today:</span></span>

* <span data-ttu-id="f81ad-113">**Para equipes grandes, o desempenho é ruim e os tempos-de-tempo são mais prováveis.**</span><span class="sxs-lookup"><span data-stu-id="f81ad-113">**For large teams, performance is poor and timeouts are more likely.**</span></span> <span data-ttu-id="f81ad-114">O tamanho máximo da equipe cresceu consideravelmente desde que o Microsoft Teams foi lançado no início de 2017.</span><span class="sxs-lookup"><span data-stu-id="f81ad-114">The maximum team size has grown considerably since Microsoft Teams was released in early 2017.</span></span> <span data-ttu-id="f81ad-115">Como retorna toda a lista de membros, leva muito tempo para que a chamada da API retorne para equipes grandes, e não é incomum que a chamada tenha tempo de espera e você precisa `GetMembersAsync` / `getMembers` tentar novamente.</span><span class="sxs-lookup"><span data-stu-id="f81ad-115">Since `GetMembersAsync`/`getMembers` returns the entire member list, it takes a long time for the API call to return for large teams, and it’s not uncommon for the call to time out and you have to try again.</span></span>
* <span data-ttu-id="f81ad-116">**Obter detalhes de perfil para um único usuário é complicado.**</span><span class="sxs-lookup"><span data-stu-id="f81ad-116">**Getting profile details for a single user is cumbersome.**</span></span> <span data-ttu-id="f81ad-117">Para obter as informações de perfil de um único usuário, você precisa recuperar toda a lista de membros e pesquisar o que deseja.</span><span class="sxs-lookup"><span data-stu-id="f81ad-117">To get the profile information for a single user, you have to retrieve the entire member list and then search for the one you want.</span></span> <span data-ttu-id="f81ad-118">True, há uma função auxiliar no SDK da Estrutura de Bots para torná-lo mais simples, mas, sob as cobertas, não é eficiente.</span><span class="sxs-lookup"><span data-stu-id="f81ad-118">True, there’s a helper function in the Bot Framework SDK to make it simpler, but under the covers it’s not efficient.</span></span>

<span data-ttu-id="f81ad-119">Separadamente, com a introdução de equipes em toda a organização, percebemos que era hora de alinhar melhor essas APIs com controles de privacidade do Office 365: os bots usados em equipes grandes são capazes de recuperar informações básicas de perfil, que é semelhante à permissão do `User.ReadBasic.All` Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="f81ad-119">Separately, with the introduction of org-wide teams, we realized it was time to better align these APIs with Office 365 privacy controls: bots used in large teams are able to retrieve basic profile information, which is similar to the `User.ReadBasic.All` Microsoft Graph permission.</span></span> <span data-ttu-id="f81ad-120">Os administradores de locatários têm um grande controle sobre quais aplicativos e bots podem ser usados em seu locatário, mas essas configurações são diferentes das que regem o Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="f81ad-120">Tenant administrators have a great deal of control over which apps and bots can be used in their tenant, but these settings are different than the ones governing Microsoft Graph.</span></span>

<span data-ttu-id="f81ad-121">Aqui está uma representação JSON de exemplo do que é retornado por essas APIs hoje.</span><span class="sxs-lookup"><span data-stu-id="f81ad-121">Here’s a sample JSON representation of what’s returned by these APIs today.</span></span> <span data-ttu-id="f81ad-122">Vou fazer referência a alguns dos campos abaixo.</span><span class="sxs-lookup"><span data-stu-id="f81ad-122">I’ll refer to some of the fields below.</span></span>

```json
[{
    "id": "29:1GcS4EyB_oSI8A88XmWBN7NJFyMqe3QGnJdgLfFGkJnVelzRGos0bPbpsfJjcbAD22bmKc4GMbrY2g4JDrrA8vM06X1-cHHle4zOE6U4ttcc",
    "name": "Anon1 (Guest)",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "anonymous"
}, {
    "id": "29:1bSnHZ7Js2STWrgk6ScEErLk1Lp2zQuD5H2qQ960rtvstKp8tKLl-3r8b6DoW0QxZimuTxk_kupZ1DBMpvIQQUAZL-PNj0EORDvRZXy8kvWk",
    "objectId": "76b0b09f-d410-48fd-993e-84da521a597b",
    "givenName": "John",
    "surname": "Patterson",
    "email": "johnp@fabrikam.com",
    "userPrincipalName": "johnp@fabrikam.com",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "user"
}, {
    "id": "29:1URzNQM1x1PNMr1D7L5_lFe6qF6gEfAbkdG8_BUxOW2mTKryQqEZtBTqDt10-MghkzjYDuUj4KG6nvg5lFAyjOLiGJ4jzhb99WrnI7XKriCs",
    "objectId": "6b7b3b2a-2c4b-4175-8582-41c9e685c1b5",
    "givenName": "Rick",
    "surname": "Stevens",
    "email": "Rick.Stevens@fabrikam.com",
    "userPrincipalName": "rstevens@fabrikam.com",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "user"
}]
```

## <a name="api-changes"></a><span data-ttu-id="f81ad-123">Alterações na API</span><span class="sxs-lookup"><span data-stu-id="f81ad-123">API changes</span></span>

<span data-ttu-id="f81ad-124">Aqui estão as alterações futuras da API:</span><span class="sxs-lookup"><span data-stu-id="f81ad-124">Here are the upcoming API changes:</span></span>

* <span data-ttu-id="f81ad-125">Criamos uma nova API para recuperar informações de perfil para [`TeamsInfo.GetPagedMembersAsync`](~/bots/how-to/get-teams-context.md?tabs=dotnet#fetching-the-roster-or-user-profile) membros de um chat/equipe.</span><span class="sxs-lookup"><span data-stu-id="f81ad-125">We've created a new API [`TeamsInfo.GetPagedMembersAsync`](~/bots/how-to/get-teams-context.md?tabs=dotnet#fetching-the-roster-or-user-profile) for retrieving profile information for members of a chat/team.</span></span> <span data-ttu-id="f81ad-126">Essa API agora está disponível com o SDK da Estrutura de Bot 4.10.</span><span class="sxs-lookup"><span data-stu-id="f81ad-126">This API is now available with the Bot Framework 4.10 SDK.</span></span> <span data-ttu-id="f81ad-127">Para desenvolvimento em todas as outras versões, use o [`GetConversationPagedMembers`](/dotnet/api/microsoft.bot.connector.conversationsextensions.getconversationpagedmembersasync?view=botbuilder-dotnet-stable&preserve-view=true) método.</span><span class="sxs-lookup"><span data-stu-id="f81ad-127">For development in all other versions use the [`GetConversationPagedMembers`](/dotnet/api/microsoft.bot.connector.conversationsextensions.getconversationpagedmembersasync?view=botbuilder-dotnet-stable&preserve-view=true) method.</span></span>
  > [!NOTE]
  > <span data-ttu-id="f81ad-128">Em v3 ou v4, a melhor ação é atualizar para a versão de ponto mais recente.</span><span class="sxs-lookup"><span data-stu-id="f81ad-128">In either v3 or v4, the best action is to upgrade to the latest point release.</span></span>
* <span data-ttu-id="f81ad-129">Criamos uma nova API para recuperar as informações de perfil [`TeamsInfo.GetMemberAsync`](~/bots/how-to/get-teams-context.md?tabs=dotnet#get-single-member-details) de um único usuário.</span><span class="sxs-lookup"><span data-stu-id="f81ad-129">We've created a new API [`TeamsInfo.GetMemberAsync`](~/bots/how-to/get-teams-context.md?tabs=dotnet#get-single-member-details) for retrieving the profile information for a single user.</span></span> <span data-ttu-id="f81ad-130">Ele pega a ID da equipe/chat e uma [UPN](https://docs.microsoft.com/windows/win32/ad/naming-properties#userprincipalname) ( , consulte acima `userPrincipalName` ), Azure Active Directory Object ID ( , consulte acima ) ou a ID do usuário do Teams ( , consulte acima ) como parâmetros e retorna as informações de perfil desse  `objectId`  `id` usuário. </span><span class="sxs-lookup"><span data-stu-id="f81ad-130">It takes the ID of the team/chat and a [UPN](https://docs.microsoft.com/windows/win32/ad/naming-properties#userprincipalname) (`userPrincipalName`, *see above*), Azure Active Directory Object ID (`objectId`, *see above*), or the Teams user ID (`id`, *see above*) as parameters and returns the profile information for that user.</span></span>
  > [!NOTE]
  > <span data-ttu-id="f81ad-131">Estamos mudando para corresponder ao que é chamado no objeto `objectId` de uma mensagem da Estrutura de `aadObjectId` `Activity` Bot.</span><span class="sxs-lookup"><span data-stu-id="f81ad-131">We're changing `objectId` to `aadObjectId` to match what it's called in the `Activity` object of a Bot Framework message.</span></span> <span data-ttu-id="f81ad-132">A nova API está disponível com a versão 4.10 do SDK da Estrutura de Bots.</span><span class="sxs-lookup"><span data-stu-id="f81ad-132">The new API is available with version 4.10 of the Bot Framework SDK.</span></span> <span data-ttu-id="f81ad-133">Ele estará disponível em breve na extensão do Teams SDK Bot Framework 3.x também; Enquanto isso, você pode usar o ponto de extremidade [REST.](~/bots/how-to/get-teams-context.md?tabs=json#get-single-member-details)</span><span class="sxs-lookup"><span data-stu-id="f81ad-133">It will soon be available in the Teams SDK extension Bot Framework 3.x as well; meanwhile you can use the [REST](~/bots/how-to/get-teams-context.md?tabs=json#get-single-member-details) endpoint.</span></span>
* <span data-ttu-id="f81ad-134">`TeamsInfo.GetMembersAsync` (C#) e (TypeScript/Node.js) é formalmente preterido e vai parar de funcionar no final `TeamsInfo.getMembers` de 2021.</span><span class="sxs-lookup"><span data-stu-id="f81ad-134">`TeamsInfo.GetMembersAsync` (C#) and `TeamsInfo.getMembers` (TypeScript/Node.js) is formally deprecated and will stop working in late 2021.</span></span> <span data-ttu-id="f81ad-135">Atualize seus bots para usar as APIs paiadas.</span><span class="sxs-lookup"><span data-stu-id="f81ad-135">Please update your bots to use the paged APIs.</span></span> <span data-ttu-id="f81ad-136">(Isso também se aplica à [API REST subjacente que essas APIs usam](~/bots/how-to/get-teams-context.md?tabs=json).)</span><span class="sxs-lookup"><span data-stu-id="f81ad-136">(This also applies to the [underlying REST API these APIs use](~/bots/how-to/get-teams-context.md?tabs=json).)</span></span>
* <span data-ttu-id="f81ad-137">Até o final de 2021, os bots não poderão recuperar proativamente as propriedades ou para membros de um chat/equipe e precisarão usar o Microsoft Graph para `userPrincipalName` `email` recuperá-las.</span><span class="sxs-lookup"><span data-stu-id="f81ad-137">By late 2021, bots will not be able to proactively retrieve the `userPrincipalName` or `email` properties for members of a chat/team and will need to use Microsoft Graph to retrieve them.</span></span> <span data-ttu-id="f81ad-138">Especificamente, `userPrincipalName` e as propriedades não serão retornadas da nova API a partir do final de `email` `GetConversationPagedMembers` 2021.</span><span class="sxs-lookup"><span data-stu-id="f81ad-138">Specifically, `userPrincipalName` and `email` properties won't be returned from the new `GetConversationPagedMembers` API starting in late 2021.</span></span> <span data-ttu-id="f81ad-139">Os bots terão que usar o Microsoft Graph com um token de acesso para recuperar essas informações.</span><span class="sxs-lookup"><span data-stu-id="f81ad-139">Bots will have to use Microsoft Graph with an access token to retrieve this information.</span></span> <span data-ttu-id="f81ad-140">Obviamente, essa é uma grande mudança: devemos facilitar a aplicação de um token de acesso aos bots e simplificar o processo de consentimento do usuário final.</span><span class="sxs-lookup"><span data-stu-id="f81ad-140">This is obviously a major change: We must make it easier for bots to get an access token, and we must streamline and simplify the end-user consent process.</span></span>

## <a name="feedback-and-more-information"></a><span data-ttu-id="f81ad-141">Comentários e mais informações</span><span class="sxs-lookup"><span data-stu-id="f81ad-141">Feedback and more information</span></span>

<span data-ttu-id="f81ad-142">Vamos usar esta página para fornecer informações atualizadas sobre essas alterações.</span><span class="sxs-lookup"><span data-stu-id="f81ad-142">We'll use this page for providing up to date information on these changes.</span></span> <span data-ttu-id="f81ad-143">Se você tiver dúvidas, use o "Enviar comentários > nesta página" na seção **Comentários** abaixo.</span><span class="sxs-lookup"><span data-stu-id="f81ad-143">If you have questions, use the "Send feedback > on this page" in the **Feedback** section below.</span></span>
