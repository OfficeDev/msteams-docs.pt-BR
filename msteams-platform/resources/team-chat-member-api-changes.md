---
title: Alterações de API de bot para membros de equipe/chat (atualização 2020)
author: ojasvichoudhary
description: Descreve as alterações futuras e em andamento das APIs de bot usadas para recuperar membros de equipes e chats
keywords: lista de membros da equipe de APIs da estrutura de bot
ms.topic: reference
ms.author: ojchoudh
ms.openlocfilehash: 926e4e39e4b5c3f1ba34a4458cf6f17612d86841
ms.sourcegitcommit: b13b38a104946c32cd5245a7af706070e534927d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/28/2020
ms.locfileid: "44800974"
---
# <a name="changes-to-teams-bot-apis-for-fetching-teamchat-members"></a><span data-ttu-id="cbf9f-104">Alterações nas APIs de bot do teams para buscar membros da equipe/chat</span><span class="sxs-lookup"><span data-stu-id="cbf9f-104">Changes to Teams Bot APIs for Fetching Team/Chat Members</span></span>

<span data-ttu-id="cbf9f-105">Atualmente, os desenvolvedores de bot que desejam recuperar informações de um ou mais membros de um chat ou uma equipe usam as APIs do Microsoft Teams bot APIs `TeamsInfo.GetMembersAsync` (para C#) ou `TeamsInfo.getMembers` (para TypeScript/Node.js) [(documentadas aqui)](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#fetching-the-roster-or-user-profile).</span><span class="sxs-lookup"><span data-stu-id="cbf9f-105">Currently, bot developers who want to retrieve information for one or more members of a chat or team use the Microsoft Teams bot APIs `TeamsInfo.GetMembersAsync` (for C#) or `TeamsInfo.getMembers` (for TypeScript/Node.js) APIs [(documented here)](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#fetching-the-roster-or-user-profile).</span></span> <span data-ttu-id="cbf9f-106">Essas APIs têm várias deficiências atuais:</span><span class="sxs-lookup"><span data-stu-id="cbf9f-106">These APIs have several shortcomings today:</span></span>

* <span data-ttu-id="cbf9f-107">**Para equipes grandes, o desempenho é ruim e os tempos limites são mais prováveis.**</span><span class="sxs-lookup"><span data-stu-id="cbf9f-107">**For large teams, performance is poor and timeouts are more likely.**</span></span> <span data-ttu-id="cbf9f-108">O tamanho máximo da equipe cresceu consideravelmente desde que o Microsoft Teams foi lançado no início de 2017.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-108">The maximum team size has grown considerably since Microsoft Teams was released in early 2017.</span></span> <span data-ttu-id="cbf9f-109">Como `GetMembersAsync` / `getMembers` retorna toda a lista de membros, ela demora muito para que a chamada de API seja retornada para equipes grandes e não é incomum a chamada para o tempo limite e você precisa tentar novamente.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-109">Since `GetMembersAsync`/`getMembers` returns the entire member list, it takes a long time for the API call to return for large teams, and it’s not uncommon for the call to time out and you have to try again.</span></span>
* <span data-ttu-id="cbf9f-110">**Obter detalhes de perfil para um único usuário é complicado.**</span><span class="sxs-lookup"><span data-stu-id="cbf9f-110">**Getting profile details for a single user is cumbersome.**</span></span> <span data-ttu-id="cbf9f-111">Para obter as informações de perfil de um único usuário, você precisa recuperar toda a lista de membros e pesquisar o que desejar.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-111">To get the profile information for a single user, you have to retrieve the entire member list and then search for the one you want.</span></span> <span data-ttu-id="cbf9f-112">True, há uma função auxiliar no SDK da estrutura de bot para torná-la mais simples, mas nas capas não é eficiente.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-112">True, there’s a helper function in the Bot Framework SDK to make it simpler, but under the covers it’s not efficient.</span></span>

<span data-ttu-id="cbf9f-113">Separadamente, com a introdução de equipes de toda a organização, percebemos que era o tempo para alinhar melhor essas APIs com os controles de privacidade do Office 365: os bots usados em grandes equipes podem recuperar informações básicas do perfil, que é semelhante à `User.ReadBasic.All` permissão do Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-113">Separately, with the introduction of org-wide teams, we realized it was time to better align these APIs with Office 365 privacy controls: bots used in large teams are able to retrieve basic profile information, which is similar to the `User.ReadBasic.All` Microsoft Graph permission.</span></span> <span data-ttu-id="cbf9f-114">Os administradores de locatários têm uma grande quantidade de controle sobre quais aplicativos e bots podem ser usados em seus locatários, mas essas configurações são diferentes das que governam o Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-114">Tenant administrators have a great deal of control over which apps and bots can be used in their tenant, but these settings are different than the ones governing Microsoft Graph.</span></span>

<span data-ttu-id="cbf9f-115">Aqui está uma representação JSON de amostra do que é retornado por essas APIs hoje.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-115">Here’s a sample JSON representation of what’s returned by these APIs today.</span></span> <span data-ttu-id="cbf9f-116">Consultarei alguns dos campos abaixo.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-116">I’ll refer to some of the fields below.</span></span>

```json
[{
    "id": "29:1GcS4EyB_oSI8A88XmWBN7NJFyMqe3QGnJdgLfFGkJnVelzRGos0bPbpsfJjcbAD22bmKc4GMbrY2g4JDrrA8vM06X1-cHHle4zOE6U4ttcc",
    "objectId": "9d3e08f9-a7ae-43aa-a4d3-de3f319a8a9c",
    "givenName": "Larry",
    "surname": "Brown",
    "email": "Larry.Brown@fabrikam.com",
    "userPrincipalName": "labrown@fabrikam.com"
}, {
    "id": "29:1bSnHZ7Js2STWrgk6ScEErLk1Lp2zQuD5H2qQ960rtvstKp8tKLl-3r8b6DoW0QxZimuTxk_kupZ1DBMpvIQQUAZL-PNj0EORDvRZXy8kvWk",
    "objectId": "76b0b09f-d410-48fd-993e-84da521a597b",
    "givenName": "John",
    "surname": "Patterson",
    "email": "johnp@fabrikam.com",
    "userPrincipalName": "johnp@fabrikam.com"
}, {
    "id": "29:1URzNQM1x1PNMr1D7L5_lFe6qF6gEfAbkdG8_BUxOW2mTKryQqEZtBTqDt10-MghkzjYDuUj4KG6nvg5lFAyjOLiGJ4jzhb99WrnI7XKriCs",
    "objectId": "6b7b3b2a-2c4b-4175-8582-41c9e685c1b5",
    "givenName": "Rick",
    "surname": "Stevens",
    "email": "Rick.Stevens@fabrikam.com",
    "userPrincipalName": "rstevens@fabrikam.com"
}]
```

## <a name="api-changes"></a><span data-ttu-id="cbf9f-117">Alterações na API</span><span class="sxs-lookup"><span data-stu-id="cbf9f-117">API Changes</span></span>
<span data-ttu-id="cbf9f-118">Aqui estão as futuras alterações da API:</span><span class="sxs-lookup"><span data-stu-id="cbf9f-118">Here are the upcoming API changes:</span></span>

* <span data-ttu-id="cbf9f-119">Criamos uma nova API [`TeamsInfo.GetPagedMembersAsync`](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#fetching-the-roster-or-user-profile) para recuperar informações de perfil para os membros de um chat/equipe.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-119">We've created a new API [`TeamsInfo.GetPagedMembersAsync`](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#fetching-the-roster-or-user-profile) for retrieving profile information for members of a chat/team.</span></span> <span data-ttu-id="cbf9f-120">Essa API está agora disponível com o SDK do bot Framework 4,8.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-120">This API is now available with the Bot Framework 4.8 SDK.</span></span> <span data-ttu-id="cbf9f-121">Para desenvolvimento em todas as outras versões, use o [`GetConversationPagedMembers`](https://docs.microsoft.com/dotnet/api/microsoft.bot.connector.conversationsextensions.getconversationpagedmembersasync?view=botbuilder-dotnet-stable) método.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-121">For development in all other versions use the [`GetConversationPagedMembers`](https://docs.microsoft.com/dotnet/api/microsoft.bot.connector.conversationsextensions.getconversationpagedmembersasync?view=botbuilder-dotnet-stable) method.</span></span> <span data-ttu-id="cbf9f-122">**Observação**: em V3 ou v4, a melhor ação é atualizar para a versão mais recente do ponto (3.30.2 ou 4,8, respectivamente).</span><span class="sxs-lookup"><span data-stu-id="cbf9f-122">**Note**: In either v3 or v4, the best action is to upgrade to the latest point release (3.30.2 or 4.8 respectively).</span></span> 
* <span data-ttu-id="cbf9f-123">Criamos uma nova API [`TeamsInfo.GetMemberAsync`](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#get-single-member-details) para recuperar as informações de perfil de um único usuário.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-123">We've created a new API [`TeamsInfo.GetMemberAsync`](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#get-single-member-details) for retrieving the profile information for a single user.</span></span> <span data-ttu-id="cbf9f-124">Ele usa a ID do Team/Chat e um [UPN](https://docs.microsoft.com/windows/win32/ad/naming-properties#userprincipalname) ( `userPrincipalName` , *Confira acima*), a ID de objeto do Azure Active Directory (, confira `objectId` *acima*) ou a ID de usuário do Microsoft Teams ( `id` , *Confira acima*) como parâmetros e retorna as informações de perfil desse usuário.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-124">It takes the ID of the team/chat and a [UPN](https://docs.microsoft.com/windows/win32/ad/naming-properties#userprincipalname) (`userPrincipalName`, *see above*), Azure Active Directory Object ID (`objectId`, *see above*), or the Teams user ID (`id`, *see above*) as parameters and returns the profile information for that user.</span></span> <span data-ttu-id="cbf9f-125">**Observação**: estamos mudando `objectId` para `aadObjectId` coincidir o que é chamado no `Activity` objeto de uma mensagem da estrutura de bot.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-125">**Note**: We're changing `objectId` to `aadObjectId` to match what it's called in the `Activity` object of a Bot Framework message.</span></span> <span data-ttu-id="cbf9f-126">A nova API está disponível com a versão 4,8 do SDK da estrutura do bot.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-126">The new API is available with version 4.8 of the Bot Framework SDK.</span></span> <span data-ttu-id="cbf9f-127">Em breve, ele estará disponível na estrutura de bot de extensão do SDK do teams 3. x também; enquanto você pode usar o ponto de extremidade [REST](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=json#get-single-member-details) .</span><span class="sxs-lookup"><span data-stu-id="cbf9f-127">It will soon be available in the Teams SDK extension Bot Framework 3.x as well; meanwhile you can use the [REST](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=json#get-single-member-details) endpoint.</span></span>
* <span data-ttu-id="cbf9f-128">`TeamsInfo.GetMembersAsync`(C#) e `TeamsInfo.getMembers` (TypeScript/Node.js) é formalmente preterida e deixará de funcionar no tarde 2021.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-128">`TeamsInfo.GetMembersAsync` (C#) and `TeamsInfo.getMembers` (TypeScript/Node.js) is formally deprecated and will stop working in late 2021.</span></span> <span data-ttu-id="cbf9f-129">Anunciaremos um cronograma específico em maio de 2020, com base nos comentários dos desenvolvedores.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-129">We'll announce a specific timetable in May 2020, based on feedback from developers.</span></span> <span data-ttu-id="cbf9f-130">Depois que a nova API paginável estiver disponível, os desenvolvedores devem atualizar seus bots para usá-la.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-130">Once the new paged API is available, developers should update their bots to use it.</span></span> <span data-ttu-id="cbf9f-131">(Isso também se aplica à [API REST subjacente que essas APIs usam](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=json#tabpanel_CeZOj-G++Q_json).)</span><span class="sxs-lookup"><span data-stu-id="cbf9f-131">(This also applies to the [underlying REST API these APIs use](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=json#tabpanel_CeZOj-G++Q_json).)</span></span>
* <span data-ttu-id="cbf9f-132">No final de 2021, os bots não poderão recuperar proativamente as `userPrincipalName` Propriedades ou os `email` membros de um chat/equipe e precisarão usar o Microsoft Graph para recuperá-los.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-132">By late 2021, bots will not be able to proactively retrieve the `userPrincipalName` or `email` properties for members of a chat/team and will need to use Microsoft Graph to retrieve them.</span></span> <span data-ttu-id="cbf9f-133">Especificamente, `userPrincipalName` e `email` as propriedades não serão retornadas da nova `GetConversationPagedMembers` API a partir da última 2021.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-133">Specifically, `userPrincipalName` and `email` properties won't be returned from the new `GetConversationPagedMembers` API starting in late 2021.</span></span> <span data-ttu-id="cbf9f-134">Os bots terão que usar o Microsoft Graph com um token de acesso para recuperar essas informações.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-134">Bots will have to use Microsoft Graph with an access token to retrieve this information.</span></span> <span data-ttu-id="cbf9f-135">Isso é obviamente uma alteração importante: devemos facilitar para os bots a obter um token de acesso, e devemos simplificar e simplificar o processo de consentimento do usuário final.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-135">This is obviously a major change: We must make it easier for bots to get an access token, and we must streamline and simplify the end-user consent process.</span></span>

## <a name="feedback-and-more-information"></a><span data-ttu-id="cbf9f-136">Comentários e mais informações</span><span class="sxs-lookup"><span data-stu-id="cbf9f-136">Feedback and More Information</span></span>
<span data-ttu-id="cbf9f-137">Usaremos essa página para fornecer informações atualizadas sobre essas alterações.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-137">We'll use this page for providing up to date information on these changes.</span></span> <span data-ttu-id="cbf9f-138">Se você tiver dúvidas, use o "enviar comentários > nesta página" na seção **comentários** abaixo.</span><span class="sxs-lookup"><span data-stu-id="cbf9f-138">If you have questions, use the "Send feedback > on this page" in the **Feedback** section below.</span></span> 
