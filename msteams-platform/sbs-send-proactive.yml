### YamlMime:Tutorial
title: Enviar mensagens proativas
metadata:
  title: Enviar mensagens proativas
  description: Neste artigo, você aprenderá a enviar mensagens proativas, como mensagens de boas-vindas, mensagens agendadas e notificações de um bot.
  audience: Developer
  level: Beginner
  ms.date: 06/23/2021
  ms.topic: interactive-tutorial
  nextTutorialHref: ./bots/how-to/conversations/send-proactive-messages.md
  nextTutorialTitle: Leia mais sobre mensagens proativas
  ms.custom: mvc
  ms.localizationpriority: high
  ms.openlocfilehash: 9c763e584bcd574c2fc511000f6470d7608e3ac0
  ms.sourcegitcommit: b72f51377f41be18ee9b70b042f736605f755cf1
  ms.translationtype: MT
  ms.contentlocale: pt-BR
  ms.lasthandoff: 10/21/2022
  ms.locfileid: "68670069"
items:
- durationInMinutes: 1
  content: "Uma mensagem proativa é qualquer mensagem enviada por um bot que não esteja em resposta a uma solicitação de um usuário que inclui mensagens, como:\n - Mensagem de boas-vindas\n - Notificações\n - Mensagens agendadas\n \nEste guia passo a passo ajuda você a enviar uma mensagem proativa de um bot. Você verá as seguintes saídas:\n\n* Mensagem de olá proativa no chat.  \n\n  :::image type=\"content\" source=\"~/assets/images/proactive-scenario/proactive-helo1.png\" alt-text=\"Mensagem proativa olá\":::\n\n* Mensagem de olá proativa como um cartão adaptável.\n\n  :::image type=\"content\" source=\"~/assets/images/proactive-scenario/proactive-helo-in-adaptive-card.png\" alt-text=\"Mensagem proativa olá no cartão adaptável\"::: \n"
- title: Pré-requisitos
  durationInMinutes: 2
  content: "Verifique se você instala o seguinte:    \n\n| &nbsp; | Instalar | Para usar... |\n | --- | --- | --- |\n | **Required** | &nbsp; | &nbsp; |\n | &nbsp; | [Visual Studio 2022 versão 17.3](https://visualstudio.microsoft.com)<br> Instale uma das duas cargas de trabalho a seguir:<br> • ASP.NET e desenvolvimento web <br> • Desenvolvimento entre plataformas do .NET Core | Você pode instalar a versão corporativa no Visual Studio 2022 e instalar as cargas de trabalho. |\n | &nbsp; | [ngrok](https://ngrok.com/download) | Os recursos do aplicativo Teams (bots de conversa, extensões de mensagem e webhooks de entrada) exigem conexões de entrada. Um túnel conecta seu sistema de desenvolvimento ao Teams. Não é necessário para aplicativos que incluem apenas guias. Esse pacote é instalado no diretório do projeto (usando npm `devDependencies`). |\n | &nbsp; | [Conta de desenvolvedor do Microsoft 365](/microsoftteams/platform/concepts/build-and-test/prepare-your-o365-tenant) | Acesso à conta do Teams com as permissões apropriadas para instalar um aplicativo. |\n | &nbsp; | [Portal do Desenvolvedor do Teams](https://dev.teams.microsoft.com/) | Portal baseado na Web para configurar, gerenciar e distribuir seu aplicativo do Teams, inclusive para sua organização ou para a loja do Teams. |\n"
- title: Configurar o ambiente local
  durationInMinutes: 3
  content: "1.  Baixe o [código de exemplo](https://github.com/MicrosoftDocs/msteams-docs/tree/master/msteams-platform/assets/downloads/SendProactiveMessages.zip) (arquivo zip) e extraia os arquivos.\n1.  Acesse os arquivos extraídos e clique duas vezes **em ProactiveBot.csproj**. A solução é aberta no Visual Studio.\n1.  No Visual Studio, clique com o botão direito do mouse no projeto (**ProactiveBot**) e selecione **Compilar** para criar a solução.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/proactivebot-project1.png\" alt-text=\"Projeto bot proativo\":::\n\n    <br>\n\n    <details>\n\n    <summary><b>Solução de Problemas</b></summary>\n\n    Se você receber o erro **De não localizar o pacote** , siga estas etapas:\n\n    1.  Acesse **Ferramentas Configurações** >  do **Gerenciador de Pacotes** >  do **NuGet** Package Manager.\n    1.  Na janela **Opções** exibida, selecione **Fontes de Pacote** do **Gerenciador de Pacotes** >  do NuGet.\n    1.  Selecione **Adicionar**.\n    1.  Insira `nuget.org` no **Nome** e `https://api.nuget.org/v3/index.json` nos campos **Origem** .\n    1.  Selecione **Atualizar** e **OK**.\n    1.  Recompile seu projeto.\n    <br>\n\n    </details>\n    \n1. Descompactar para instalar o ngrok.\n   * Windows: clique duas vezes em `ngrok.zip`.\n   * Linux ou OS X: descompacte o ngrok do terminal e execute o `unzip /path/to/ngrok.zip` comando.\n1. Use o ngrok para criar um túnel para os pontos de extremidade HTTPS disponíveis publicamente do servidor Web localmente. Execute o seguinte comando no ngrok:\n\n    ```bash\n    ngrok http --host-header=localhost 3978\n    ```\n    \n1. No ngrok, copie a URL HTTPS. \n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/ngrok-base-url1.png\" alt-text=\"URL base do ngrok.\"lightbox=\"~/assets/images/proactive-scenario/ngrok-base-url1.png\":::   \n"
- title: Habilitar a visualização do desenvolvedor
  durationInMinutes: 1
  content: >
    1. Habilite o carregamento de aplicativos no console de administração do seu locatário.
        1. Acessar o [Centro de administração do Microsoft 365](https://admin.microsoft.com/Adminportal/Home?source=applauncher#/homepage#/) com suas credenciais de administrador.
        1. No painel esquerdo, selecione **Mostrar Tudo**.
        1. Selecione **Teams**.

           :::image type="content" source="./assets/images/meeting-token-generator/meeting-token-generator-admincenter_1.png" alt-text="Menu do Centro de administração" border="true":::
- title: Criar e instalar o aplicativo teams
  durationInMinutes: 5
  content: "1. Abra [o Portal do Desenvolvedor para Teams](https://dev.teams.microsoft.com).\n\n   A página a seguir é exibida:\n\n   :::image type=\"content\" source=\"~/assets/images/proactive-scenario/developer-portal-intro.png\" alt-text=\"Introdução ao Portal do Desenvolvedor\":::\n\n1. Selecione **Aplicativo de Importação de** **Aplicativos** > .\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/upload-app-package.png\" alt-text=\"Pacote Select-upload\":::  \n\n1. Selecione **AppManifest** e selecione **Abrir**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-app-package.png\" alt-text=\"Selecionar Pacote de aplicativo\":::\n\n1. Selecione **Importar**.\n\n     :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-import.png\" alt-text=\"Selecionar Importar\":::\n\n    A página a seguir é exibida:\n\n     :::image type=\"content\" source=\"~/assets/images/proactive-scenario/proactive-message.png\" alt-text=\"Mensagem proativa.\"lightbox=\"~/assets/images/proactive-scenario/proactive-message.png\"::: \n\n1. Selecione Bot **de Recursos de** > **Aplicativo**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-app-features.png\" alt-text=\"Selecionar Recursos de Aplicativo\":::\n\n1. Selecione **Criar um novo bot**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-bot.png\" alt-text=\"Selecionar bot\":::     \n    \n1. Selecione **Novo Bot**. \n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/create-new-bot.png\" alt-text=\"Criar um novo bot\":::\n\n    A janela **Adicionar bot** é exibida.\n\n1. Insira **Bot de Mensagem Proativa** e selecione **Adicionar**.\n\n     :::image type=\"content\" source=\"~/assets/images/proactive-scenario/enter-proactive-message.png\" alt-text=\"Inserir mensagem proativa\":::\n\n    Agora, o bot Bot Proactive Message é adicionado com êxito ao aplicativo. Você pode ver o **Nome do Bot** e a **ID do Bot**.\n\n     :::image type=\"content\" source=\"~/assets/images/proactive-scenario/bot-name.png\" alt-text=\"Nome e ID do Bot\":::\n\n   > [!TIP]\n   > Salve a **ID do Bot** para referência futura.\n\n1. Clique duas vezes no **bot Mensagem Proativa**.\n\n   A página **Demonstração de Mensagem Proativa** é exibida.\n\n1. **Selecione Configurar** e defina o **endereço ponto de extremidade** na forma de `https://your ngrok/api/messages`.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-configure.png\" alt-text=\"Selecione Configurar\":::\n\n1. Selecione **Segredos** >  do **cliente Adicionar um segredo do cliente para o bot**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/secret.png\" alt-text=\"Selecionar Segredo\":::\n\n1. A janela **Novo segredo do cliente gerado** é exibida e selecione **OK**.    \n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/new-secret.png\" alt-text=\"Novo Segredo\":::\n\n    > [!TIP]\n    > Salve o novo valor **de segredo do cliente** para referência futura.\n\n1. Selecione o ícone Aplicativos :::image type=\"icon\" source=\"~/assets/images/proactive-scenario/apps-icon.png\"::: e selecione **Demonstração de Mensagem Proativa**.\n\n     :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-apps.png\" alt-text=\"Selecionar Aplicativos\":::\n\n    A página a seguir é exibida:\n\n     :::image type=\"content\" source=\"~/assets/images/proactive-scenario/overview-page.png\" alt-text=\"Página Visão Geral\":::\n\n1. Selecione **Recursos do Aplicativo** em **Configurar e selecione** **Bot**.\n\n     :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-app-features1.png\" alt-text=\"Selecionar recursos de aplicativo\":::\n\n1. Selecione **Bot de Mensagem Proativa** na lista suspensa **Selecionar um bot existente** .\n\n     :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-send-proactive-message.png\" alt-text=\"Selecione enviar mensagens proativas\":::\n\n1. Selecione **Salvar Pessoal** > .\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-personal.png\" alt-text=\"Selecionar pessoal\":::\n\n1. Abra o arquivo **appsettings.json** no Visual Studio e atualize as seguintes informações:\n\n    * Defina **o MicrosoftAppID** como sua ID do bot.\n    * Defina **o MicrosoftAppPassword como** o valor da ID secreta do cliente.\n\n   :::image type=\"content\" source=\"~/assets/images/proactive-scenario/appsettings.png\" alt-text=\"Arquivo Configurações do Aplicativo\":::\n\n1. Selecione **Depurar** > **Iniciar Depuração**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/debug.png\" alt-text=\"Selecionar Depuração\":::\n\n   O exemplo de mensagem proativa correspondente é exibido:\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/proactive-confirm.png\" alt-text=\"Confirmação Proativa\":::\n\n1. Voltar ao Portal do Desenvolvedor, selecione **Visualização no Teams**.\n    \n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/preview-teams.png\" alt-text=\"Equipes de Visualização\":::\n\n1. Selecione **Adicionar**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-add.png\" alt-text=\"Selecionar Adicionar\":::\n\n   A página a seguir é exibida.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/teams-open1.png\" alt-text=\"Teams Open\":::\n\n   Abra o navegador.\n\n1. Copie e cole a `http://localhost:3978/api/notify` URL no navegador para obter uma mensagem de olá proativa no chat.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/url-paste.png\" alt-text=\"Colar URL\":::\n\n1. Vá para o Teams. Você recebe uma mensagem de olá proativa do bot quando a instalação for bem-sucedida.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/proactive-reply.png\" alt-text=\"Resposta proativa\":::\n"
- title: Adicionar cartão adaptável à mensagem proativa
  durationInMinutes: 10
  content: "1. No Visual Studio, interrompa o processo de depuração.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/stop-debugging.png\" alt-text=\"Parar de depuração\":::\n\n1. Clique com o botão direito do mouse **em Dependências**, **selecione Gerenciar Pacotes NuGet**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/dependencies.png\" alt-text=\"Dependências proativas\":::\n\n1. No **NuGet ProactiveBot**, selecione **Procurar** e **pesquise AdaptiveCards**. \n1. Selecione **Instalar**. \n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-adaptive cards.png\" alt-text=\"selecione Cartões Adaptáveis\":::\n\n1. Na janela **Visualizar alterações** , selecione **OK**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-ok.png\" alt-text=\"selecione Ok\":::\n\n1. Abra o arquivo **NotifyController.cs** em **Controladores**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-notify.png\" alt-text=\"Selecionar Notificar\":::\n\n1. Substitua o código existente `BotCallback` pelo seguinte código para enviar a mensagem cartão adaptável:     \n    \n   ```csharp\n   private async Task BotCallback(ITurnContext turnContext, CancellationToken cancellationToken)\n    {\n                AdaptiveCard card = new AdaptiveCard(new AdaptiveSchemaVersion(1, 0));\n\n                card.Body.Add(new AdaptiveTextBlock()\n                {\n                    Text = \"Proactive Hello\",\n                    Size = AdaptiveTextSize.ExtraLarge\n                });\n\n                card.Body.Add(new AdaptiveImage()\n                {\n                    Url = new Uri(\"http://adaptivecards.io/content/cats/1.png\")\n                });\n\n                Attachment attachment = new Attachment()\n                {\n                    ContentType = AdaptiveCard.ContentType,\n                    Content = card\n                };\n\n                await turnContext.SendActivityAsync(MessageFactory.Attachment(attachment));\n    }\n   ```  \n\n1. Pressione **F5** para executar o código.\n\n   O exemplo de mensagem proativa correspondente é exibido:\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/proactive-confirm.png\" alt-text=\"Confirmação Proativa\":::\n\n1. Acesse o Teams e desinstale seu aplicativo. \n\n1. Reinstale o mesmo aplicativo para obter o `conversationUpdate` evento.   \n\n1. Copie e cole a `http://localhost:3978/api/notify` URL no navegador para obter uma mensagem de olá proativa no Cartão Adaptável.     \n"
- title: Desafio completo
  durationInMinutes: 3
  content: >
    Você veio com algo assim? É assim que a mensagem de olá proativa no Cartão Adaptável é exibida:


    :::image type="content" source="~/assets/images/proactive-scenario/proactive-helo-in-adaptive-card.png" alt-text="Mensagem proativa olá no cartão adaptável":::
- content: >-
    Você concluiu o cenário.

    * Você pode enviar notificações diariamente ou solicitar comentários do usuário periodicamente.

    * Manipular limites de limitação para evitar várias notificações.
