## <a name="add-a-messaging-extension-to-your-app"></a><span data-ttu-id="3b328-101">Adicionar uma extensão de mensagens ao seu aplicativo</span><span class="sxs-lookup"><span data-stu-id="3b328-101">Add a messaging extension to your app</span></span>

<span data-ttu-id="3b328-102">Uma extensão de mensagens é um serviço hospedado na nuvem que escuta solicitações de usuário e responde com dados estruturados, como um [cartão](~/task-modules-and-cards/what-are-cards.md).</span><span class="sxs-lookup"><span data-stu-id="3b328-102">A messaging extension is a cloud-hosted service that listens to user requests and responds with structured data, such as a [card](~/task-modules-and-cards/what-are-cards.md).</span></span> <span data-ttu-id="3b328-103">Você integra seu serviço com Microsoft Teams por meio de objetos da Estrutura de `Activity` Bot.</span><span class="sxs-lookup"><span data-stu-id="3b328-103">You integrate your service with Microsoft Teams via Bot Framework `Activity` objects.</span></span> <span data-ttu-id="3b328-104">Nossas extensões .NET e Node.js para o SDK do Construtor de Bots podem ajudá-lo a adicionar a funcionalidade de extensão de mensagens ao seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="3b328-104">Our .NET and Node.js extensions for the Bot Builder SDK can help you add messaging extension functionality to your app.</span></span>

![Diagrama de fluxo de mensagens para extensões de mensagens](~/assets/images/compose-extensions/ceflow.png)

### <a name="register-in-the-bot-framework"></a><span data-ttu-id="3b328-106">Registrar-se na Estrutura de Bots</span><span class="sxs-lookup"><span data-stu-id="3b328-106">Register in the Bot Framework</span></span>

<span data-ttu-id="3b328-107">Se você ainda não fez isso, primeiro registre um bot com o Microsoft Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="3b328-107">If you haven’t done so already, you must first register a bot with the Microsoft Bot Framework.</span></span> <span data-ttu-id="3b328-108">A ID do aplicativo Microsoft e os pontos de extremidade de retorno de chamada para seu bot, conforme definido lá, serão usados na extensão de mensagens para receber e responder às solicitações do usuário.</span><span class="sxs-lookup"><span data-stu-id="3b328-108">The Microsoft app ID and callback endpoints for your bot, as defined there, will be used in your messaging extension to receive and respond to user requests.</span></span> <span data-ttu-id="3b328-109">Lembre-se de habilitar o Microsoft Teams do seu bot.</span><span class="sxs-lookup"><span data-stu-id="3b328-109">Remember to enable the Microsoft Teams channel for your bot.</span></span>

<span data-ttu-id="3b328-110">Grave a ID do aplicativo bot e a senha do aplicativo, você precisará fornecer a ID do aplicativo no manifesto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="3b328-110">Record your bot app ID and app password, you will need to supply the app ID in your app manifest.</span></span>

### <a name="update-your-app-manifest"></a><span data-ttu-id="3b328-111">Atualizar o manifesto do aplicativo</span><span class="sxs-lookup"><span data-stu-id="3b328-111">Update your app manifest</span></span>

<span data-ttu-id="3b328-112">Assim como com bots e guias, você atualiza o [manifesto](~/resources/schema/manifest-schema.md#composeextensions) do seu aplicativo para incluir as propriedades de extensão de mensagens.</span><span class="sxs-lookup"><span data-stu-id="3b328-112">As with bots and tabs, you update the [manifest](~/resources/schema/manifest-schema.md#composeextensions) of your app to include the messaging extension properties.</span></span> <span data-ttu-id="3b328-113">Essas propriedades regem como sua extensão de mensagens aparece e se comporta no cliente Microsoft Teams de mensagens.</span><span class="sxs-lookup"><span data-stu-id="3b328-113">These properties govern how your messaging extension appears and behaves in the Microsoft Teams client.</span></span> <span data-ttu-id="3b328-114">As extensões de mensagens são suportadas começando com v1.0 do manifesto.</span><span class="sxs-lookup"><span data-stu-id="3b328-114">Messaging extensions are supported beginning with v1.0 of the manifest.</span></span>

#### <a name="declare-your-messaging-extension"></a><span data-ttu-id="3b328-115">Declarar sua extensão de mensagens</span><span class="sxs-lookup"><span data-stu-id="3b328-115">Declare your messaging extension</span></span>

<span data-ttu-id="3b328-116">Para adicionar uma extensão de mensagens, inclua uma nova estrutura JSON de nível superior em seu manifesto com a `composeExtensions` propriedade.</span><span class="sxs-lookup"><span data-stu-id="3b328-116">To add a messaging extension, include a new top-level JSON structure in your manifest with the `composeExtensions` property.</span></span> <span data-ttu-id="3b328-117">Atualmente, você está limitado a criar uma única extensão de mensagens para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="3b328-117">Currently, you are limited to creating a single messaging extension for your app.</span></span>

> [!NOTE]
> <span data-ttu-id="3b328-118">O manifesto refere-se a extensões de mensagens como `composeExtensions` .</span><span class="sxs-lookup"><span data-stu-id="3b328-118">The manifest refers to messaging extensions as `composeExtensions`.</span></span> <span data-ttu-id="3b328-119">Isso é para manter a compatibilidade com compatibilidade com backward.</span><span class="sxs-lookup"><span data-stu-id="3b328-119">This is to maintain backward compatibility.</span></span>

<span data-ttu-id="3b328-120">A definição de extensão é um objeto que tem a seguinte estrutura:</span><span class="sxs-lookup"><span data-stu-id="3b328-120">The extension definition is an object that has the following structure:</span></span>

| <span data-ttu-id="3b328-121">Nome da propriedade</span><span class="sxs-lookup"><span data-stu-id="3b328-121">Property name</span></span> | <span data-ttu-id="3b328-122">Finalidade</span><span class="sxs-lookup"><span data-stu-id="3b328-122">Purpose</span></span> | <span data-ttu-id="3b328-123">Obrigatório?</span><span class="sxs-lookup"><span data-stu-id="3b328-123">Required?</span></span> |
|---|---|---|
| `botId` | <span data-ttu-id="3b328-124">O ID exclusivo do aplicativo Microsoft para o bot conforme registrado na estrutura do bot.</span><span class="sxs-lookup"><span data-stu-id="3b328-124">The unique Microsoft app ID for the bot as registered with the Bot Framework.</span></span> <span data-ttu-id="3b328-125">Normalmente, isso deve ser o mesmo que a ID do seu aplicativo Teams geral.</span><span class="sxs-lookup"><span data-stu-id="3b328-125">This should typically be the same as the ID for your overall Teams app.</span></span> | <span data-ttu-id="3b328-126">Sim</span><span class="sxs-lookup"><span data-stu-id="3b328-126">Yes</span></span> |
| `scopes` | <span data-ttu-id="3b328-127">Matriz declarando se essa extensão pode ser adicionada `personal` ou `team` escopos (ou ambos).</span><span class="sxs-lookup"><span data-stu-id="3b328-127">Array declaring whether this extension can be added to `personal` or `team` scopes (or both).</span></span> | <span data-ttu-id="3b328-128">Sim</span><span class="sxs-lookup"><span data-stu-id="3b328-128">Yes</span></span> |
| `canUpdateConfiguration` | <span data-ttu-id="3b328-129">Habilita **Configurações** item de menu.</span><span class="sxs-lookup"><span data-stu-id="3b328-129">Enables **Settings** menu item.</span></span> | <span data-ttu-id="3b328-130">Não</span><span class="sxs-lookup"><span data-stu-id="3b328-130">No</span></span> |
| `commands` | <span data-ttu-id="3b328-131">Matriz de comandos compatíveis com essa extensão de mensagens.</span><span class="sxs-lookup"><span data-stu-id="3b328-131">Array of commands that this messaging extension supports.</span></span> <span data-ttu-id="3b328-132">Você está limitado a 10 comandos.</span><span class="sxs-lookup"><span data-stu-id="3b328-132">You are limited to 10 commands.</span></span> | <span data-ttu-id="3b328-133">Sim</span><span class="sxs-lookup"><span data-stu-id="3b328-133">Yes</span></span> |

#### <a name="define-commands"></a><span data-ttu-id="3b328-134">Definir comandos</span><span class="sxs-lookup"><span data-stu-id="3b328-134">Define commands</span></span>

<span data-ttu-id="3b328-135">Sua extensão de mensagens deve declarar um comando, que aparece quando o usuário seleciona seu aplicativo no botão **Mais** opções (**&#8943;**) na caixa de redação.</span><span class="sxs-lookup"><span data-stu-id="3b328-135">Your messaging extension should declare one command, which appears when the user selects your app from the **More options** (**&#8943;**) button in the compose box.</span></span>

![Captura de tela da lista de extensões de mensagens no Teams](~/assets/images/compose-extensions/compose-extension-list.png)

<span data-ttu-id="3b328-137">No manifesto do aplicativo, o item de comando é um objeto com a seguinte estrutura:</span><span class="sxs-lookup"><span data-stu-id="3b328-137">In the app manifest, your command item is an object with the following structure:</span></span>

| <span data-ttu-id="3b328-138">Nome da propriedade</span><span class="sxs-lookup"><span data-stu-id="3b328-138">Property name</span></span> | <span data-ttu-id="3b328-139">Finalidade</span><span class="sxs-lookup"><span data-stu-id="3b328-139">Purpose</span></span> | <span data-ttu-id="3b328-140">Obrigatório?</span><span class="sxs-lookup"><span data-stu-id="3b328-140">Required?</span></span> | <span data-ttu-id="3b328-141">Versão mínima do manifesto</span><span class="sxs-lookup"><span data-stu-id="3b328-141">Minimum manifest version</span></span> |
|---|---|---|---|
| `id` | <span data-ttu-id="3b328-142">ID exclusiva que você atribui a esse comando.</span><span class="sxs-lookup"><span data-stu-id="3b328-142">Unique ID that you assign to this command.</span></span> <span data-ttu-id="3b328-143">A solicitação do usuário incluirá essa ID.</span><span class="sxs-lookup"><span data-stu-id="3b328-143">The user request will include this ID.</span></span> | <span data-ttu-id="3b328-144">Sim</span><span class="sxs-lookup"><span data-stu-id="3b328-144">Yes</span></span> | <span data-ttu-id="3b328-145">1.0</span><span class="sxs-lookup"><span data-stu-id="3b328-145">1.0</span></span> |
| `title` | <span data-ttu-id="3b328-146">Nome do comando.</span><span class="sxs-lookup"><span data-stu-id="3b328-146">Command name.</span></span> <span data-ttu-id="3b328-147">Esse valor aparece na interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="3b328-147">This value appears in the UI.</span></span> | <span data-ttu-id="3b328-148">Sim</span><span class="sxs-lookup"><span data-stu-id="3b328-148">Yes</span></span> | <span data-ttu-id="3b328-149">1.0</span><span class="sxs-lookup"><span data-stu-id="3b328-149">1.0</span></span> |
| `description` | <span data-ttu-id="3b328-150">Texto de ajuda que indica o que esse comando faz.</span><span class="sxs-lookup"><span data-stu-id="3b328-150">Help text indicating what this command does.</span></span> <span data-ttu-id="3b328-151">Esse valor aparece na interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="3b328-151">This value appears in the UI.</span></span> | <span data-ttu-id="3b328-152">Sim</span><span class="sxs-lookup"><span data-stu-id="3b328-152">Yes</span></span> | <span data-ttu-id="3b328-153">1.0</span><span class="sxs-lookup"><span data-stu-id="3b328-153">1.0</span></span> |
| `type` | <span data-ttu-id="3b328-154">De definir o tipo de comando.</span><span class="sxs-lookup"><span data-stu-id="3b328-154">Set the type of command.</span></span> <span data-ttu-id="3b328-155">Os valores possíveis incluem `query` e `action`.</span><span class="sxs-lookup"><span data-stu-id="3b328-155">Possible values include `query` and `action`.</span></span> <span data-ttu-id="3b328-156">Se não estiver presente, o valor padrão será definido como `query` .</span><span class="sxs-lookup"><span data-stu-id="3b328-156">If not present the default value is set to `query`.</span></span> | <span data-ttu-id="3b328-157">Não</span><span class="sxs-lookup"><span data-stu-id="3b328-157">No</span></span> | <span data-ttu-id="3b328-158">1.4</span><span class="sxs-lookup"><span data-stu-id="3b328-158">1.4</span></span> |
| `initialRun` | <span data-ttu-id="3b328-159">Parâmetro opcional, usado com `query` comandos.</span><span class="sxs-lookup"><span data-stu-id="3b328-159">Optional parameter, used with `query` commands.</span></span> <span data-ttu-id="3b328-160">Se definido como **true**, indica que esse comando deve ser executado assim que o usuário escolher esse comando na interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="3b328-160">If set to **true**, indicates this command should be executed as soon as the user chooses this command in the UI.</span></span> | <span data-ttu-id="3b328-161">Não</span><span class="sxs-lookup"><span data-stu-id="3b328-161">No</span></span> | <span data-ttu-id="3b328-162">1.0</span><span class="sxs-lookup"><span data-stu-id="3b328-162">1.0</span></span> |
| `fetchTask` | <span data-ttu-id="3b328-163">Parâmetro opcional, usado com `action` comandos.</span><span class="sxs-lookup"><span data-stu-id="3b328-163">Optional parameter, used with `action` commands.</span></span> <span data-ttu-id="3b328-164">De definida **como true** para buscar o cartão adaptável ou a URL da Web para exibição no módulo [de tarefa](~/task-modules-and-cards/what-are-task-modules.md).</span><span class="sxs-lookup"><span data-stu-id="3b328-164">Set to **true** to fetch the adaptive card or web url to display within the [task module](~/task-modules-and-cards/what-are-task-modules.md).</span></span> <span data-ttu-id="3b328-165">Isso é usado quando as entradas para o comando são dinâmicas em vez `action` de um conjunto estático de parâmetros.</span><span class="sxs-lookup"><span data-stu-id="3b328-165">This is used when the inputs to the `action` command is dynamic as opposed to a static set of parameters.</span></span> <span data-ttu-id="3b328-166">Observe que a lista de parâmetros estáticos se definida como **true** para o comando é ignorada.</span><span class="sxs-lookup"><span data-stu-id="3b328-166">Note that the if set to **true** the static parameter list for the command is ignored.</span></span> | <span data-ttu-id="3b328-167">Não</span><span class="sxs-lookup"><span data-stu-id="3b328-167">No</span></span> | <span data-ttu-id="3b328-168">1.4</span><span class="sxs-lookup"><span data-stu-id="3b328-168">1.4</span></span> |
| `parameters` | <span data-ttu-id="3b328-169">Lista estática de parâmetros para o comando.</span><span class="sxs-lookup"><span data-stu-id="3b328-169">Static list of parameters for the command.</span></span> | <span data-ttu-id="3b328-170">Sim</span><span class="sxs-lookup"><span data-stu-id="3b328-170">Yes</span></span> | <span data-ttu-id="3b328-171">1.0</span><span class="sxs-lookup"><span data-stu-id="3b328-171">1.0</span></span> |
| `parameter.name` | <span data-ttu-id="3b328-172">O nome do parâmetro.</span><span class="sxs-lookup"><span data-stu-id="3b328-172">The name of the parameter.</span></span> <span data-ttu-id="3b328-173">Isso é enviado ao seu serviço na solicitação do usuário.</span><span class="sxs-lookup"><span data-stu-id="3b328-173">This is sent to your service in the user request.</span></span> | <span data-ttu-id="3b328-174">Sim</span><span class="sxs-lookup"><span data-stu-id="3b328-174">Yes</span></span> | <span data-ttu-id="3b328-175">1.0</span><span class="sxs-lookup"><span data-stu-id="3b328-175">1.0</span></span> |
| `parameter.description` | <span data-ttu-id="3b328-176">Descreve as finalidades desse parâmetro ou o exemplo do valor que deve ser fornecido.</span><span class="sxs-lookup"><span data-stu-id="3b328-176">Describes this parameter’s purposes or example of the value that should be provided.</span></span> <span data-ttu-id="3b328-177">Esse valor aparece na interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="3b328-177">This value appears in the UI.</span></span> | <span data-ttu-id="3b328-178">Sim</span><span class="sxs-lookup"><span data-stu-id="3b328-178">Yes</span></span> | <span data-ttu-id="3b328-179">1.0</span><span class="sxs-lookup"><span data-stu-id="3b328-179">1.0</span></span> |
| `parameter.title` | <span data-ttu-id="3b328-180">Título ou rótulo de parâmetro fácil de usar curto.</span><span class="sxs-lookup"><span data-stu-id="3b328-180">Short user-friendly parameter title or label.</span></span> | <span data-ttu-id="3b328-181">Sim</span><span class="sxs-lookup"><span data-stu-id="3b328-181">Yes</span></span> | <span data-ttu-id="3b328-182">1.0</span><span class="sxs-lookup"><span data-stu-id="3b328-182">1.0</span></span> |
| `parameter.inputType` | <span data-ttu-id="3b328-183">De acordo com o tipo de entrada necessário.</span><span class="sxs-lookup"><span data-stu-id="3b328-183">Set to the type of input required.</span></span> <span data-ttu-id="3b328-184">Os valores possíveis `text` `textarea` incluem , `number` , , , , `date` `time` `toggle` .</span><span class="sxs-lookup"><span data-stu-id="3b328-184">Possible values include `text`, `textarea`, `number`, `date`, `time`, `toggle`.</span></span> <span data-ttu-id="3b328-185">O padrão é definido como `text` .</span><span class="sxs-lookup"><span data-stu-id="3b328-185">Default is set to `text`.</span></span> | <span data-ttu-id="3b328-186">Não</span><span class="sxs-lookup"><span data-stu-id="3b328-186">No</span></span> | <span data-ttu-id="3b328-187">1.4</span><span class="sxs-lookup"><span data-stu-id="3b328-187">1.4</span></span> |
| `context` | <span data-ttu-id="3b328-188">Matriz opcional de valores que define o contexto em que a ação da mensagem está disponível.</span><span class="sxs-lookup"><span data-stu-id="3b328-188">Optional array of values that defines the context the message action is available in.</span></span> <span data-ttu-id="3b328-189">Os valores possíveis `message` são `compose` , ou `commandBox` .</span><span class="sxs-lookup"><span data-stu-id="3b328-189">Possible values are `message`, `compose`, or `commandBox`.</span></span> <span data-ttu-id="3b328-190">O padrão é `["compose", "commandBox"]`.</span><span class="sxs-lookup"><span data-stu-id="3b328-190">Default is `["compose", "commandBox"]`.</span></span> | <span data-ttu-id="3b328-191">Não</span><span class="sxs-lookup"><span data-stu-id="3b328-191">No</span></span> | <span data-ttu-id="3b328-192">1,5</span><span class="sxs-lookup"><span data-stu-id="3b328-192">1.5</span></span> |
