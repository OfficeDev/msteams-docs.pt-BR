---
title: Criar uma página de remoção de guias
author: surbhigupta
description: Como criar uma página de remoção de tabulação
keywords: teams tabs group channel configurble remove delete
localization_priority: Normal
ms.topic: conceptual
ms.author: lajanuar
ms.openlocfilehash: 1b4ef5435ad1be82726edbf02d7205c0b1feba06
ms.sourcegitcommit: 4d9d1542e04abacfb252511c665a7229d8bb7162
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/25/2021
ms.locfileid: "53140191"
---
# <a name="create-a-removal-page"></a><span data-ttu-id="b0670-104">Criar uma página de remoção</span><span class="sxs-lookup"><span data-stu-id="b0670-104">Create a removal page</span></span>

<span data-ttu-id="b0670-105">Você pode estender e aprimorar a experiência do usuário suportando opções de remoção e modificação em seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b0670-105">You can extend and enhance the user experience by supporting removal and modification options in your app.</span></span> <span data-ttu-id="b0670-106">Teams permite que os usuários renomeiem ou removam uma guia de canal ou grupo e você pode permitir que os usuários reconfigurem sua guia após a instalação.</span><span class="sxs-lookup"><span data-stu-id="b0670-106">Teams enables users to rename or remove a channel or group tab and you can permit users to reconfigure your tab after installation.</span></span> <span data-ttu-id="b0670-107">Além disso, a experiência de remoção de tabulação fornece aos usuários opções pós-remoção para excluir ou arquivar conteúdo.</span><span class="sxs-lookup"><span data-stu-id="b0670-107">Additionally, the tab removal experience provides the users with post-removal options to delete or archive content.</span></span>

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a><span data-ttu-id="b0670-108">Permitir que sua guia seja reconfigurada após a instalação</span><span class="sxs-lookup"><span data-stu-id="b0670-108">Enable your tab to be reconfigured after installation</span></span>

<span data-ttu-id="b0670-109">Seu **manifest.json** define os recursos e recursos da guia.</span><span class="sxs-lookup"><span data-stu-id="b0670-109">Your **manifest.json** defines your tab's features and capabilities.</span></span> <span data-ttu-id="b0670-110">A propriedade da instância de tabulação tem um valor Boolean que indica se um usuário pode modificar ou `canUpdateConfiguration` reconfigurar a guia depois que ela for criada.</span><span class="sxs-lookup"><span data-stu-id="b0670-110">The tab instance `canUpdateConfiguration` property takes a Boolean value that indicates whether a user can modify or reconfigure the tab after it is created.</span></span> <span data-ttu-id="b0670-111">A tabela a seguir fornece os detalhes da propriedade:</span><span class="sxs-lookup"><span data-stu-id="b0670-111">The following table provides the property details:</span></span>

|<span data-ttu-id="b0670-112">Nome</span><span class="sxs-lookup"><span data-stu-id="b0670-112">Name</span></span>| <span data-ttu-id="b0670-113">Tipo</span><span class="sxs-lookup"><span data-stu-id="b0670-113">Type</span></span>| <span data-ttu-id="b0670-114">Tamanho máximo</span><span class="sxs-lookup"><span data-stu-id="b0670-114">Maximum size</span></span> | <span data-ttu-id="b0670-115">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="b0670-115">Required</span></span> | <span data-ttu-id="b0670-116">Descrição</span><span class="sxs-lookup"><span data-stu-id="b0670-116">Description</span></span>|
|---|---|---|---|---|
|`canUpdateConfiguration`|<span data-ttu-id="b0670-117">Booliano</span><span class="sxs-lookup"><span data-stu-id="b0670-117">Boolean</span></span>|||<span data-ttu-id="b0670-118">Um valor que indica se uma instância da configuração da guia pode ser atualizada pelo usuário após a criação.</span><span class="sxs-lookup"><span data-stu-id="b0670-118">A value indicating whether an instance of the tab's configuration can be updated by the user after creation.</span></span> <span data-ttu-id="b0670-119">O padrão é `true`.</span><span class="sxs-lookup"><span data-stu-id="b0670-119">Default is `true`.</span></span> |

<span data-ttu-id="b0670-120">Quando sua guia é carregada em um chat de canal ou grupo, Teams adiciona um menu suspenso com o botão direito do mouse para sua guia. As opções disponíveis são determinadas pela `canUpdateConfiguration` configuração.</span><span class="sxs-lookup"><span data-stu-id="b0670-120">When your tab is uploaded to a channel or group chat, Teams adds a right-click drop-down menu for your tab. The available options are determined by the `canUpdateConfiguration` setting.</span></span> <span data-ttu-id="b0670-121">A tabela a seguir fornece os detalhes da configuração:</span><span class="sxs-lookup"><span data-stu-id="b0670-121">The following table provides the setting details:</span></span>

| `canUpdateConfiguration`| <span data-ttu-id="b0670-122">verdadeiro</span><span class="sxs-lookup"><span data-stu-id="b0670-122">true</span></span>   | <span data-ttu-id="b0670-123">falso</span><span class="sxs-lookup"><span data-stu-id="b0670-123">false</span></span> | <span data-ttu-id="b0670-124">description</span><span class="sxs-lookup"><span data-stu-id="b0670-124">description</span></span> |
| ----------------------- | :----: | ----- | ----------- |
|     <span data-ttu-id="b0670-125">Configurações</span><span class="sxs-lookup"><span data-stu-id="b0670-125">Settings</span></span>            |   <span data-ttu-id="b0670-126">√</span><span class="sxs-lookup"><span data-stu-id="b0670-126">√</span></span>    |       |<span data-ttu-id="b0670-127">A `configurationUrl` página é recarregada em um IFrame permitindo que o usuário reconfigure a guia.</span><span class="sxs-lookup"><span data-stu-id="b0670-127">The `configurationUrl` page is reloaded in an IFrame allowing the user to reconfigure the tab.</span></span> |
|     <span data-ttu-id="b0670-128">Renomear</span><span class="sxs-lookup"><span data-stu-id="b0670-128">Rename</span></span>              |   <span data-ttu-id="b0670-129">√</span><span class="sxs-lookup"><span data-stu-id="b0670-129">√</span></span>    |   <span data-ttu-id="b0670-130">√</span><span class="sxs-lookup"><span data-stu-id="b0670-130">√</span></span>   | <span data-ttu-id="b0670-131">O usuário pode alterar o nome da guia conforme aparece na barra de guias.</span><span class="sxs-lookup"><span data-stu-id="b0670-131">The user can change the tab name as it appears in the tab bar.</span></span>          |
|     <span data-ttu-id="b0670-132">Remover</span><span class="sxs-lookup"><span data-stu-id="b0670-132">Remove</span></span>              |   <span data-ttu-id="b0670-133">√</span><span class="sxs-lookup"><span data-stu-id="b0670-133">√</span></span>    |   <span data-ttu-id="b0670-134">√</span><span class="sxs-lookup"><span data-stu-id="b0670-134">√</span></span>   |  <span data-ttu-id="b0670-135">Se a propriedade e o valor são incluídos na página de configuração , a página de remoção é carregada em `removeURL` um IFrame e apresentada ao usuário.  </span><span class="sxs-lookup"><span data-stu-id="b0670-135">If the  `removeURL` property and value are included in the **configuration page**, the **removal page** is loaded into an IFrame and presented to the user.</span></span> <span data-ttu-id="b0670-136">Se uma página de remoção não estiver incluída, o usuário será apresentado com uma caixa de diálogo confirmar.</span><span class="sxs-lookup"><span data-stu-id="b0670-136">If a removal page is not included, the user is presented with a confirm dialog box.</span></span>          |

## <a name="create-a-tab-removal-page-for-your-application"></a><span data-ttu-id="b0670-137">Criar uma página de remoção de tabulação para seu aplicativo</span><span class="sxs-lookup"><span data-stu-id="b0670-137">Create a tab removal page for your application</span></span>

<span data-ttu-id="b0670-138">A página de remoção opcional é uma página HTML que você hospeda e é exibida quando a guia é removida.</span><span class="sxs-lookup"><span data-stu-id="b0670-138">The optional removal page is an HTML page that you host and is displayed when the tab is removed.</span></span> <span data-ttu-id="b0670-139">A URL da página de remoção é designada pelo `setSettings()` método em sua página de configuração.</span><span class="sxs-lookup"><span data-stu-id="b0670-139">The removal page URL is designated by the `setSettings()` method within your configuration page.</span></span> <span data-ttu-id="b0670-140">Assim como todas as páginas em seu aplicativo, a página de remoção deve estar em conformidade [com Teams pré-requisitos da guia](../../../tabs/how-to/tab-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="b0670-140">As with all pages in your app, the removal page must comply with [Teams tab prerequisites](../../../tabs/how-to/tab-requirements.md).</span></span>

### <a name="register-a-remove-handler"></a><span data-ttu-id="b0670-141">Registrar um manipulador de remoção</span><span class="sxs-lookup"><span data-stu-id="b0670-141">Register a remove handler</span></span>

<span data-ttu-id="b0670-142">Opcionalmente, na lógica da página de remoção, você pode invocar o manipulador de eventos quando o usuário `registerOnRemoveHandler((RemoveEvent) => {}` remover uma configuração de guia existente.</span><span class="sxs-lookup"><span data-stu-id="b0670-142">Optionally, within your removal page logic, you can  invoke the `registerOnRemoveHandler((RemoveEvent) => {}` event handler when the user removes an existing tab configuration.</span></span> <span data-ttu-id="b0670-143">O método entra na interface e executa o código no [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) manipulador quando um usuário tenta remover o conteúdo.</span><span class="sxs-lookup"><span data-stu-id="b0670-143">The method takes in the [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) interface and executes the code in the handler when a user attempts to remove content.</span></span> <span data-ttu-id="b0670-144">O método é usado para executar operações de limpeza, como a remoção do recurso subjacente que está no conteúdo da guia.</span><span class="sxs-lookup"><span data-stu-id="b0670-144">The method is used to perform cleanup operations such as removing the underlying resource powering the tab content.</span></span> <span data-ttu-id="b0670-145">Por vez, apenas um manipulador de remoção pode ser registrado.</span><span class="sxs-lookup"><span data-stu-id="b0670-145">At a time only one remove handler can be registered.</span></span>

<span data-ttu-id="b0670-146">A `RemoveEvent` interface descreve um objeto com dois métodos:</span><span class="sxs-lookup"><span data-stu-id="b0670-146">The `RemoveEvent` interface describes an object with two methods:</span></span>

* <span data-ttu-id="b0670-147">A `notifySuccess()` função é necessária.</span><span class="sxs-lookup"><span data-stu-id="b0670-147">The `notifySuccess()` function is required.</span></span> <span data-ttu-id="b0670-148">Indica que a remoção do recurso subjacente foi bem-sucedida e seu conteúdo pode ser removido.</span><span class="sxs-lookup"><span data-stu-id="b0670-148">It indicates that the removal of the underlying resource succeeded and its content can be removed.</span></span>

* <span data-ttu-id="b0670-149">A `notifyFailure(string)` função é opcional.</span><span class="sxs-lookup"><span data-stu-id="b0670-149">The `notifyFailure(string)` function is optional.</span></span> <span data-ttu-id="b0670-150">Indica que a remoção do recurso subjacente falhou e seu conteúdo não pode ser removido.</span><span class="sxs-lookup"><span data-stu-id="b0670-150">It indicates that removal of the underlying resource failed and its content cannot be removed.</span></span> <span data-ttu-id="b0670-151">O parâmetro de cadeia de caracteres opcional especifica um motivo para a falha.</span><span class="sxs-lookup"><span data-stu-id="b0670-151">The optional string parameter specifies a reason for the failure.</span></span> <span data-ttu-id="b0670-152">Se fornecido, essa cadeia de caracteres será exibida para o usuário; senão um erro genérico é exibido.</span><span class="sxs-lookup"><span data-stu-id="b0670-152">If provided, this string is displayed to the user; else a generic error is displayed.</span></span>

#### <a name="use-the-getsettings-function"></a><span data-ttu-id="b0670-153">Usar a `getSettings()` função</span><span class="sxs-lookup"><span data-stu-id="b0670-153">Use the `getSettings()` function</span></span>

<span data-ttu-id="b0670-154">Você pode usar `getSettings()` para atribuir o conteúdo da guia a ser removido.</span><span class="sxs-lookup"><span data-stu-id="b0670-154">You can use `getSettings()`to assign the tab content to be removed.</span></span> <span data-ttu-id="b0670-155">A função assume e fornece os valores de propriedade `getSettings((Settings) =>{})` [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) de configurações válidos que podem ser recuperados.</span><span class="sxs-lookup"><span data-stu-id="b0670-155">The `getSettings((Settings) =>{})` function takes in the [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) and provides the valid settings property values that can be retrieved.</span></span>

#### <a name="use-the-getcontext-function"></a><span data-ttu-id="b0670-156">Usar a `getContext()` função</span><span class="sxs-lookup"><span data-stu-id="b0670-156">Use the `getContext()` function</span></span>

<span data-ttu-id="b0670-157">Você pode usar `getContext()` para obter o contexto atual no qual o quadro está sendo executado.</span><span class="sxs-lookup"><span data-stu-id="b0670-157">You can use `getContext()` to get the current context in which the frame is running.</span></span> <span data-ttu-id="b0670-158">A `getContext((Context) =>{})` função assume o [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true) .</span><span class="sxs-lookup"><span data-stu-id="b0670-158">The `getContext((Context) =>{})` function takes in the [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true).</span></span> <span data-ttu-id="b0670-159">A função fornece valores de propriedade válidos que você pode usar na lógica da página de remoção para determinar o conteúdo `Context` a ser exibido na página de remoção.</span><span class="sxs-lookup"><span data-stu-id="b0670-159">The function provides valid `Context` property values that you can use in your removal page logic to determine the content to display in the removal page.</span></span>

#### <a name="include-authentication"></a><span data-ttu-id="b0670-160">Incluir autenticação</span><span class="sxs-lookup"><span data-stu-id="b0670-160">Include authentication</span></span>

<span data-ttu-id="b0670-161">A autenticação é necessária antes de permitir que um usuário exclua o conteúdo da guia.</span><span class="sxs-lookup"><span data-stu-id="b0670-161">Authentication is required before allowing a user to delete the tab content.</span></span> <span data-ttu-id="b0670-162">As informações de contexto podem ser usadas para ajudar a construir solicitações de autenticação e URLs de página de autorização.</span><span class="sxs-lookup"><span data-stu-id="b0670-162">Context information can be used to help construct authentication requests and authorization page URLs.</span></span> <span data-ttu-id="b0670-163">Consulte [Microsoft Teams fluxo de autenticação para guias](~/tabs/how-to/authentication/auth-flow-tab.md).</span><span class="sxs-lookup"><span data-stu-id="b0670-163">See [Microsoft Teams authentication flow for tabs](~/tabs/how-to/authentication/auth-flow-tab.md).</span></span> <span data-ttu-id="b0670-164">Certifique-se de que todos os domínios usados em suas páginas de tabulação estão listados na `manifest.json` `validDomains` matriz.</span><span class="sxs-lookup"><span data-stu-id="b0670-164">Make sure that all domains used in your tab pages are listed in the `manifest.json` `validDomains` array.</span></span>

<span data-ttu-id="b0670-165">Veja a seguir um bloco de código de remoção de tabulação de exemplo:</span><span class="sxs-lookup"><span data-stu-id="b0670-165">The following is a sample tab removal code block:</span></span>

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>

```

<span data-ttu-id="b0670-166">Quando um usuário seleciona **Remover** do menu suspenso da guia, Teams carrega a página opcional atribuída na página de configuração , em `removeUrl` um IFrame.</span><span class="sxs-lookup"><span data-stu-id="b0670-166">When a user selects **Remove** from the tab's drop-down menu, Teams loads the optional `removeUrl` page assigned in your **configuration page**, into an IFrame.</span></span> <span data-ttu-id="b0670-167">O usuário é mostrado um botão carregado com a função que chama e habilita o botão Remover mostrado na parte inferior da página de remoção `onClick()` `microsoftTeams.settings.setValidityState(true)` IFrame. </span><span class="sxs-lookup"><span data-stu-id="b0670-167">The user is shown a button loaded with the `onClick()` function that calls `microsoftTeams.settings.setValidityState(true)` and enables the **Remove** button shown at the bottom of the removal page IFrame.</span></span>

<span data-ttu-id="b0670-168">Depois que o manipulador de remoção for executado, `removeEvent.notifySuccess()` ou `removeEvent.notifyFailure()` notifica Teams do resultado de remoção de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="b0670-168">After the remove handler is executed, `removeEvent.notifySuccess()` or `removeEvent.notifyFailure()` notifies Teams of the content removal outcome.</span></span>

>[!NOTE]
> * <span data-ttu-id="b0670-169">Para garantir que o controle de um usuário autorizado sobre uma guia não seja inibido, Teams remove a guia em casos de sucesso e falha.</span><span class="sxs-lookup"><span data-stu-id="b0670-169">To ensure that an authorized user's control over a tab is not inhibited, Teams removes the tab in both success and failure cases.</span></span>
> * <span data-ttu-id="b0670-170">Teams habilita o **botão Remover** após cinco segundos, mesmo que sua guia não tenha chamado `setValidityState()` .</span><span class="sxs-lookup"><span data-stu-id="b0670-170">Teams enables the **Remove** button after five seconds, even if your tab has not called `setValidityState()`.</span></span>
> * <span data-ttu-id="b0670-171">Quando o usuário seleciona **Remover**, Teams remove a guia após 30 segundos, independentemente de as ações ter sido concluídas ou não.</span><span class="sxs-lookup"><span data-stu-id="b0670-171">When the user selects **Remove**, Teams removes the tab after 30 seconds regardless of whether the actions have been completed or not.</span></span>

## <a name="see-also"></a><span data-ttu-id="b0670-172">Também consulte</span><span class="sxs-lookup"><span data-stu-id="b0670-172">See also</span></span>

* [<span data-ttu-id="b0670-173">Teams guias</span><span class="sxs-lookup"><span data-stu-id="b0670-173">Teams tabs</span></span>](~/tabs/what-are-tabs.md)
* [<span data-ttu-id="b0670-174">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="b0670-174">Prerequisites</span></span>](~/tabs/how-to/tab-requirements.md)
* [<span data-ttu-id="b0670-175">Criar uma guia pessoal</span><span class="sxs-lookup"><span data-stu-id="b0670-175">Create a personal tab</span></span>](~/tabs/how-to/create-personal-tab.md)
* [<span data-ttu-id="b0670-176">Criar um canal ou uma guia de grupo</span><span class="sxs-lookup"><span data-stu-id="b0670-176">Create a channel or group tab</span></span>](~/tabs/how-to/create-channel-group-tab.md)
* [<span data-ttu-id="b0670-177">Criar uma página de conteúdo</span><span class="sxs-lookup"><span data-stu-id="b0670-177">Create a content page</span></span>](~/tabs/how-to/create-tab-pages/content-page.md)
* [<span data-ttu-id="b0670-178">Criar uma página de configuração</span><span class="sxs-lookup"><span data-stu-id="b0670-178">Create a configuration page</span></span>](~/tabs/how-to/create-tab-pages/configuration-page.md)
* [<span data-ttu-id="b0670-179">Obtenha contexto para sua guia</span><span class="sxs-lookup"><span data-stu-id="b0670-179">Get context for your tab</span></span>](~/tabs/how-to/access-teams-context.md)
* [<span data-ttu-id="b0670-180">Criar guias com Cartões Adaptáveis</span><span class="sxs-lookup"><span data-stu-id="b0670-180">Build tabs with Adaptive Cards</span></span>](~/tabs/how-to/build-adaptive-card-tabs.md)
* [<span data-ttu-id="b0670-181">Link de guias desdobradas e Exibição de Estágio</span><span class="sxs-lookup"><span data-stu-id="b0670-181">Tabs link unfurling and Stage View</span></span>](~/tabs/tabs-link-unfurling.md)
* [<span data-ttu-id="b0670-182">Criar abas para conversação</span><span class="sxs-lookup"><span data-stu-id="b0670-182">Create conversational tabs</span></span>](~/tabs/how-to/conversational-tabs.md)
* [<span data-ttu-id="b0670-183">Alterações na margem da guia</span><span class="sxs-lookup"><span data-stu-id="b0670-183">Tab margin changes</span></span>](~/resources/removing-tab-margins.md)

## <a name="next-step"></a><span data-ttu-id="b0670-184">Próxima etapa</span><span class="sxs-lookup"><span data-stu-id="b0670-184">Next step</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="b0670-185">Guias em dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="b0670-185">Tabs on mobile</span></span>](~/tabs/design/tabs-mobile.md)