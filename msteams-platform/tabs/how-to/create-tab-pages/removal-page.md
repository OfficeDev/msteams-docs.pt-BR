---
title: Criar uma página de remoção de guia
author: laujan
description: Como criar uma página de remoção de guia
keywords: guias do teams grupo de grupos configuráveis remover excluir
ms.topic: conceptual
ms.author: ''
ms.openlocfilehash: 576a3bc88d8776a193b48868d37df204c3112fd8
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/01/2020
ms.locfileid: "41672456"
---
# <a name="modify-or-remove-a-channel-group-tab"></a><span data-ttu-id="bda1b-104">Modificar ou remover uma guia de grupo de canais</span><span class="sxs-lookup"><span data-stu-id="bda1b-104">Modify or remove a channel group tab</span></span>

<span data-ttu-id="bda1b-105">Você pode estender e aprimorar a experiência do usuário oferecendo suporte às opções de remoção e modificação no seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="bda1b-105">You can extend and enhance the user experience by supporting removal and modification options in your app.</span></span> <span data-ttu-id="bda1b-106">O Microsoft Teams permite que os usuários renomeie ou removam uma guia de canal/grupo e você possa permitir que os usuários reconfigurem sua guia após a instalação.</span><span class="sxs-lookup"><span data-stu-id="bda1b-106">Teams enables users to rename or remove a channel/group tab and you can permit users to reconfigure your tab after installation.</span></span> <span data-ttu-id="bda1b-107">Além disso, sua experiência de remoção de guia pode incluir a designação do que acontece com o conteúdo quando sua guia é removida ou com opções de remoção de usuários, como excluir ou arquivar o conteúdo.</span><span class="sxs-lookup"><span data-stu-id="bda1b-107">Additionally, your tab removal experience can include designating what happens to the content when your tab is removed or giving users post-removal options such as deleting or archiving the content.</span></span>

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a><span data-ttu-id="bda1b-108">Habilitar sua guia para ser reconfigurada após a instalação</span><span class="sxs-lookup"><span data-stu-id="bda1b-108">Enable your tab to be reconfigured after installation</span></span>

<span data-ttu-id="bda1b-109">O **manifest. JSON** define os recursos e recursos da guia.</span><span class="sxs-lookup"><span data-stu-id="bda1b-109">Your **manifest.json** defines your tab's features and capabilities.</span></span> <span data-ttu-id="bda1b-110">A Propriedade Tab `canUpdateConfiguration` Instance tem um valor Boolean que indica se um usuário pode modificar ou reconfigurar a guia após ela ser criada:</span><span class="sxs-lookup"><span data-stu-id="bda1b-110">The tab instance `canUpdateConfiguration` property takes a Boolean value that indicates whether a user can modify or reconfigure the tab after it is created:</span></span>

|<span data-ttu-id="bda1b-111">Nome</span><span class="sxs-lookup"><span data-stu-id="bda1b-111">Name</span></span>| <span data-ttu-id="bda1b-112">Tipo</span><span class="sxs-lookup"><span data-stu-id="bda1b-112">Type</span></span>| <span data-ttu-id="bda1b-113">Tamanho máximo</span><span class="sxs-lookup"><span data-stu-id="bda1b-113">Maximum size</span></span> | <span data-ttu-id="bda1b-114">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="bda1b-114">Required</span></span> | <span data-ttu-id="bda1b-115">Descrição</span><span class="sxs-lookup"><span data-stu-id="bda1b-115">Description</span></span>|
|---|---|---|---|---|
|`canUpdateConfiguration`|<span data-ttu-id="bda1b-116">Booliano</span><span class="sxs-lookup"><span data-stu-id="bda1b-116">Boolean</span></span>|||<span data-ttu-id="bda1b-117">Um valor que indica se uma instância da configuração da guia pode ser atualizada pelo usuário após a criação.</span><span class="sxs-lookup"><span data-stu-id="bda1b-117">A value indicating whether an instance of the tab's configuration can be updated by the user after creation.</span></span> <span data-ttu-id="bda1b-118">Será`true`</span><span class="sxs-lookup"><span data-stu-id="bda1b-118">Default: `true`</span></span>|

<span data-ttu-id="bda1b-119">Quando sua guia for carregada para um chat de grupo ou canal, o Microsoft Teams adicionará um menu suspenso de clique com o botão direito do mouse para sua guia. As opções disponíveis são determinadas pela `canUpdateConfiguration` configuração:</span><span class="sxs-lookup"><span data-stu-id="bda1b-119">When your tab is uploaded to a channel or group chat, Teams will add a right-click drop-down menu for your tab. The available options are determined by the `canUpdateConfiguration` setting:</span></span>

| `canUpdateConfiguration`| <span data-ttu-id="bda1b-120">verdadeiro</span><span class="sxs-lookup"><span data-stu-id="bda1b-120">true</span></span>   | <span data-ttu-id="bda1b-121">falso</span><span class="sxs-lookup"><span data-stu-id="bda1b-121">false</span></span> | <span data-ttu-id="bda1b-122">description</span><span class="sxs-lookup"><span data-stu-id="bda1b-122">description</span></span> |
| ----------------------- | :----: | ----- | ----------- |
|     <span data-ttu-id="bda1b-123">Configurações</span><span class="sxs-lookup"><span data-stu-id="bda1b-123">Settings</span></span>            |   <span data-ttu-id="bda1b-124">√</span><span class="sxs-lookup"><span data-stu-id="bda1b-124">√</span></span>    |       |<span data-ttu-id="bda1b-125">A `configurationUrl` página é recarregada em um iframe, permitindo que o usuário Reconfigure a guia.</span><span class="sxs-lookup"><span data-stu-id="bda1b-125">The `configurationUrl` page is reloaded in an IFrame allowing the user to reconfigure the tab.</span></span>  |
|     <span data-ttu-id="bda1b-126">Renomear</span><span class="sxs-lookup"><span data-stu-id="bda1b-126">Rename</span></span>              |   <span data-ttu-id="bda1b-127">√</span><span class="sxs-lookup"><span data-stu-id="bda1b-127">√</span></span>    |   <span data-ttu-id="bda1b-128">√</span><span class="sxs-lookup"><span data-stu-id="bda1b-128">√</span></span>   | <span data-ttu-id="bda1b-129">O usuário pode alterar o nome da guia conforme ele aparece na barra de guias.</span><span class="sxs-lookup"><span data-stu-id="bda1b-129">The user can change the tab name as it appears in the tab bar.</span></span>          |
|     <span data-ttu-id="bda1b-130">Remover</span><span class="sxs-lookup"><span data-stu-id="bda1b-130">Remove</span></span>              |   <span data-ttu-id="bda1b-131">√</span><span class="sxs-lookup"><span data-stu-id="bda1b-131">√</span></span>    |   <span data-ttu-id="bda1b-132">√</span><span class="sxs-lookup"><span data-stu-id="bda1b-132">√</span></span>   |  <span data-ttu-id="bda1b-133">Se a `removeURL` Propriedade e o valor são incluídos na **página de configuração**, a **página de remoção** é carregada em um iframe e apresentada ao usuário.</span><span class="sxs-lookup"><span data-stu-id="bda1b-133">If the  `removeURL` property and value are included in the **configuration page**, the **removal page** is loaded into an IFrame and presented to the user.</span></span> <span data-ttu-id="bda1b-134">Se uma página de remoção não for incluída, a caixa de diálogo confirmar será exibida para o usuário.</span><span class="sxs-lookup"><span data-stu-id="bda1b-134">If a removal page is not included the user is presented with a confirm dialog box.</span></span>          |
|||||

## <a name="create-a-tab-removal-page-for-your-application"></a><span data-ttu-id="bda1b-135">Criar uma página de remoção de guia para seu aplicativo</span><span class="sxs-lookup"><span data-stu-id="bda1b-135">Create a tab removal page for your application</span></span>

<span data-ttu-id="bda1b-136">A página de remoção opcional é uma página HTML que você hospeda e é exibida quando a guia é removida.</span><span class="sxs-lookup"><span data-stu-id="bda1b-136">The optional removal page is an HTML page that you host and is displayed when the tab is removed.</span></span> <span data-ttu-id="bda1b-137">A URL da página de remoção é designada pelo `setSettings()` método dentro da sua página de configuração.</span><span class="sxs-lookup"><span data-stu-id="bda1b-137">The removal page URL is designated by the `setSettings()` method within your configuration page.</span></span> <span data-ttu-id="bda1b-138">Como em todas as páginas em seu aplicativo, a página de remoção deve estar em conformidade com [os requisitos de guia do teams](~/tabs/how-to/add-tab.md).</span><span class="sxs-lookup"><span data-stu-id="bda1b-138">As with all pages in your app, the removal page must comply with [Teams tab requirements](~/tabs/how-to/add-tab.md).</span></span>

### <a name="register-a-remove-handler"></a><span data-ttu-id="bda1b-139">Registrar um manipulador de remoção</span><span class="sxs-lookup"><span data-stu-id="bda1b-139">Register a remove handler</span></span>

<span data-ttu-id="bda1b-140">Opcionalmente, em sua lógica de página de remoção, você pode `registerOnRemoveHandler((RemoveEvent) => {}` invocar o manipulador de eventos quando o usuário remove uma configuração de guia existente.</span><span class="sxs-lookup"><span data-stu-id="bda1b-140">Optionally, within your removal page logic, you can  invoke the `registerOnRemoveHandler((RemoveEvent) => {}` event handler when the user removes an existing tab configuration.</span></span> <span data-ttu-id="bda1b-141">O método utiliza a [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest) interface e executa o código no manipulador quando um usuário tenta remover conteúdo.</span><span class="sxs-lookup"><span data-stu-id="bda1b-141">The  method takes in the [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest) interface and executes the code in the handler when a user attempts to remove content.</span></span> <span data-ttu-id="bda1b-142">Ele é usado para realizar operações de limpeza, como remover o recurso subjacente que força o conteúdo da guia.</span><span class="sxs-lookup"><span data-stu-id="bda1b-142">It is used to perform cleanup operations such as removing the underlying resource powering the tab content.</span></span> <span data-ttu-id="bda1b-143">Somente um manipulador de remoção pode ser registrado por vez.</span><span class="sxs-lookup"><span data-stu-id="bda1b-143">Only one remove handler can be registered at a time.</span></span>

<span data-ttu-id="bda1b-144">A `RemoveEvent` interface descreve um objeto com dois métodos:</span><span class="sxs-lookup"><span data-stu-id="bda1b-144">The `RemoveEvent` interface describes an object with two methods:</span></span>

* <span data-ttu-id="bda1b-145">A `notifySuccess()` função é necessária.</span><span class="sxs-lookup"><span data-stu-id="bda1b-145">The `notifySuccess()` function is required.</span></span> <span data-ttu-id="bda1b-146">Ela indica que a remoção do recurso subjacente foi bem-sucedida e seu conteúdo pode ser removido.</span><span class="sxs-lookup"><span data-stu-id="bda1b-146">It indicates that the removal of the underlying resource succeeded and its content can be removed.</span></span>

* <span data-ttu-id="bda1b-147">A `notifyFailure(string)` função é opcional.</span><span class="sxs-lookup"><span data-stu-id="bda1b-147">The `notifyFailure(string)` function is optional.</span></span> <span data-ttu-id="bda1b-148">Ela indica que a remoção do recurso subjacente falhou e seu conteúdo não pode ser removido.</span><span class="sxs-lookup"><span data-stu-id="bda1b-148">It indicates that removal of the underlying resource failed and its content cannot be removed.</span></span> <span data-ttu-id="bda1b-149">O parâmetro de cadeia de caracteres opcional especifica um motivo para a falha.</span><span class="sxs-lookup"><span data-stu-id="bda1b-149">The optional string parameter specifies a reason for the failure.</span></span> <span data-ttu-id="bda1b-150">Se fornecido, esta cadeia de caracteres é exibida para o usuário; caso contrário, um erro genérico é exibido.</span><span class="sxs-lookup"><span data-stu-id="bda1b-150">If provided, this string is displayed to the user; otherwise a generic error is displayed.</span></span>

#### <a name="use-the-getsettings-function"></a><span data-ttu-id="bda1b-151">Usar a `getSettings()` função</span><span class="sxs-lookup"><span data-stu-id="bda1b-151">Use the `getSettings()` function</span></span>

<span data-ttu-id="bda1b-152">Você pode usar `getSettings()`o para designar o conteúdo da guia a ser removido.</span><span class="sxs-lookup"><span data-stu-id="bda1b-152">You can use `getSettings()`to designate the tab content to be removed.</span></span> <span data-ttu-id="bda1b-153">A `getSettings((Settings) =>{})` função assume o [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest) e fornece os valores de propriedade de configurações válidos que podem ser recuperados.</span><span class="sxs-lookup"><span data-stu-id="bda1b-153">The `getSettings((Settings) =>{})` function takes in the [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest) and provides the valid settings property values that can be retrieved.</span></span>

#### <a name="use-the-getcontext-function"></a><span data-ttu-id="bda1b-154">Usar a `getContext()` função</span><span class="sxs-lookup"><span data-stu-id="bda1b-154">Use the `getContext()` function</span></span>

<span data-ttu-id="bda1b-155">Você pode usar `getContext()` o para recuperar o contexto atual no qual o quadro está sendo executado.</span><span class="sxs-lookup"><span data-stu-id="bda1b-155">You can use `getContext()` to retrieves the current context in which the frame is running.</span></span> <span data-ttu-id="bda1b-156">A `getContext((Context) =>{})` função assume o [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest) e fornece valores de `Context` Propriedade válidos que você pode usar em sua lógica de página de remoção para determinar o conteúdo a ser exibido na página de remoção.</span><span class="sxs-lookup"><span data-stu-id="bda1b-156">The `getContext((Context) =>{})` function takes in the [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest) and provides valid `Context` property values that you can use in your removal page logic to determine the content to display in the removal page.</span></span>

#### <a name="include-authentication"></a><span data-ttu-id="bda1b-157">Incluir autenticação</span><span class="sxs-lookup"><span data-stu-id="bda1b-157">Include authentication</span></span>

<span data-ttu-id="bda1b-158">Você pode exigir autenticação antes de permitir que um usuário exclua o conteúdo da guia.</span><span class="sxs-lookup"><span data-stu-id="bda1b-158">You might require authentication before allowing a user to delete the tab content.</span></span> <span data-ttu-id="bda1b-159">As informações de contexto podem ser usadas para ajudar a construir solicitações de autenticação e URLs de página de autorização.</span><span class="sxs-lookup"><span data-stu-id="bda1b-159">Context information can be used to help construct authentication requests and authorization page URLs.</span></span> <span data-ttu-id="bda1b-160">Confira [o fluxo de autenticação do Microsoft Teams para guias](~/tabs/how-to/authentication/auth-flow-tab.md).</span><span class="sxs-lookup"><span data-stu-id="bda1b-160">See [Microsoft Teams authentication flow for tabs](~/tabs/how-to/authentication/auth-flow-tab.md).</span></span> <span data-ttu-id="bda1b-161">Certifique-se de que todos os domínios usados nas páginas da guia estão `manifest.json` `validDomains` listados na matriz.</span><span class="sxs-lookup"><span data-stu-id="bda1b-161">Make sure that all domains used in your tab pages are listed in the `manifest.json` `validDomains` array.</span></span>

<span data-ttu-id="bda1b-162">Veja a seguir um exemplo de bloco de código de remoção de guia:</span><span class="sxs-lookup"><span data-stu-id="bda1b-162">Below is a sample tab removal code block:</span></span>

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>

```

<span data-ttu-id="bda1b-163">Quando um usuário seleciona **remover** no menu suspenso da guia, o Teams carregará a página opcional `removeUrl` (designada na **página de configuração**) em um iframe.</span><span class="sxs-lookup"><span data-stu-id="bda1b-163">When a user selects **Remove** from the tab's drop-down menu, Teams will load the optional `removeUrl` page (designated in your **configuration page**) into an IFrame.</span></span> <span data-ttu-id="bda1b-164">Aqui, o usuário recebe um botão carregado com a `onClick()` função que chama `microsoftTeams.settings.setValidityState(true)` e habilita o botão **remover** localizado próximo à parte inferior da página de remoção iframe.</span><span class="sxs-lookup"><span data-stu-id="bda1b-164">Here, the user is presented with a button loaded with the `onClick()` function that calls `microsoftTeams.settings.setValidityState(true)` and enables the **Remove** button located near the bottom of the removal page IFrame.</span></span>

<span data-ttu-id="bda1b-165">Após a execução do manipulador remove, `removeEvent.notifySuccess()` ou `removeEvent.notifyFailure()` notifica as equipes sobre o resultado da remoção de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="bda1b-165">Following the execution of the remove handler, `removeEvent.notifySuccess()` or `removeEvent.notifyFailure()` notifies Teams of the content removal outcome.</span></span>

>[!NOTE]
><span data-ttu-id="bda1b-166">Para garantir que o controle de um usuário autorizado sobre uma guia não seja inibido, o Microsoft Teams removerá a guia nos casos de êxito e de falha. </span><span class="sxs-lookup"><span data-stu-id="bda1b-166">To ensure that an authorized user's control over a tab is not inhibited, Teams will remove the tab in both success and failure cases.</span></span>\
><span data-ttu-id="bda1b-167">O Microsoft Teams habilita o botão **remover** após 5 segundos, mesmo se sua `setValidityState()`guia não tiver chamado. </span><span class="sxs-lookup"><span data-stu-id="bda1b-167">Teams enables the **Remove** button after 5 seconds, even if your tab hasn't called `setValidityState()`.</span></span>\
><span data-ttu-id="bda1b-168">Quando o usuário seleciona **remover** o Teams remove a guia após 30 segundos, independentemente de suas ações terem sido concluídas.</span><span class="sxs-lookup"><span data-stu-id="bda1b-168">When the user selects **Remove** Teams removes the tab after 30 seconds regardless of whether your actions have completed.</span></span>
