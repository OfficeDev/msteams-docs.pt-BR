### YamlMime:Tutorial
title: Guia criar com cartões adaptáveis
metadata:
  title: Guia criar com cartões adaptáveis
  description: 'Neste tutorial, você aprenderá a configurar Cartões Adaptáveis em uma guia para Teams.'
  audience: Developer
  level: Beginner
  ms.date: 12/23/2021
  ms.topic: interactive-tutorial
  nextTutorialHref: tabs/how-to/authentication/auth-aad-sso.md
  nextTutorialTitle: Ler mais na autenticação de tabulação
  ms.custom: mvc
  ms.localizationpriority: high
items:
  - durationInMinutes: 1
    content: |
      As guias Cartão Adaptável são uma nova maneira de criar guias no Teams. Em vez de incorporar conteúdo da Web em um IFrame, você pode renderizar Cartões Adaptáveis em uma guia. Embora o front-end seja renderizado com Cartões Adaptáveis, o back-end é alimentado por um bot. O bot é responsável por aceitar solicitações e responder adequadamente com o Cartão Adaptável renderizado.

      Você pode criar suas guias com blocos de construção da interface do usuário (interface do usuário) relevantes nativos na área de trabalho, na Web e em dispositivos móveis.

      Este artigo ajuda você a entender:

      * As alterações necessárias para serem feitas no manifesto do aplicativo.
      * Identifica como as solicitações de atividade de invocação e envia informações na guia com Cartões Adaptáveis.
      * Efeito no fluxo de trabalho do módulo de tarefas.

      Este guia passo a passo ajuda você a criar guias com Cartões Adaptáveis na área de trabalho e no celular. Você verá a seguinte saída:

      ![Captura de tela do Desktop Mobile](~/assets/images/adaptive-cards/desktop-mobile-screenshot.png)
  - title: Pré-requisitos
    durationInMinutes: 1
    content: |
      Certifique-se de instalar as ferramentas a seguir e configurar seu ambiente de desenvolvimento

      * Microsoft Teams com uma conta (não uma conta de convidado).
      * [Visual Studio Code](https://code.visualstudio.com/)
      * [.NET Core SDK](https://dotnet.microsoft.com/download) versão 3.1
      * [ngrok](https://ngrok.com/) ou [Tunnel Relay](https://github.com/OfficeDev/microsoft-teams-tunnelrelay)
      * [Microsoft 365 conta de desenvolvedor](https://docs.microsoft.com/en-us/microsoftteams/platform/concepts/build-and-test/prepare-your-o365-tenant) ou acesso Teams conta com as permissões apropriadas para instalar um aplicativo.
  - title: Criar um Registro de Bot no Microsoft Azure portal
    durationInMinutes: 2
    content: |
      As guias Cartão Adaptável exigiriam que o Serviço bot do Azure criasse guias em equipes. Registre bot com o Serviço de Bot do Azure quando você o desenvolver e hospedá-lo no Azure. Execute o seguinte:
      1. Use ngrok para criar um túnel para os pontos de extremidade do servidor Web.
      1. Crie o recurso bot do Azure para registrar bot com o Serviço bot do Azure.
      1. Crie o segredo do cliente que habilita a autenticação SSO do bot.
      1. Adicione Microsoft Teams canal para implantar o bot em um canal Teams.
      1. Adicione o ponto de extremidade de mensagens ao túnel de ngrok que você criou.

      Use o ngrok para criar um túnel para os pontos de extremidade HTTPS disponíveis publicamente do servidor Web em execução local. Execute o seguinte comando em ngrok:

      ```bash
      ngrok http -host-header=rewrite 3978
      ```

      **Para criar o recurso bot do Azure**

      1. Abra [Microsoft Azure portal](https://portal.azure.com/).
      1. Selecione **Criar um recurso**.
      1. **Pesquise o bot do Azure** na caixa de pesquisa.
      1. Selecione **Bot do Azure**.

          ![Azure Bot](~/assets/images/adaptive-cards/azure-bot.png)

      1. Selecionar **Criar**.
      1. Insira o nome da alça do bot no **campo Manipular** Bot.
      1. Selecione sua **Assinatura** na lista de menus suspensos.
      1. Selecione seu **grupo De recursos** na lista de menus suspensos.
          
          Para criar um novo grupo de recursos, selecione **Criar** novo, insira nome do recurso, selecione **OK** e selecione o local necessário  na lista lista suspenso Novo local do grupo de recursos.

      1. Selecione **Tipo de Aplicativo** como **Multi Locatário** para **ID do Aplicativo Microsoft**.

          ![Multi Tenant](~/assets/images/adaptive-cards/multi-tenant.png)

          > [!NOTE]
          > Na **seção Criação do** tipo de ID do Microsoft **App, Criar nova ID do Microsoft App** já está selecionada para criar um novo bot. Você também pode selecionar **Usar o registro de aplicativo existente**, se já tiver registrado um bot. Insira a ID do Aplicativo microsoft **no campo ID do aplicativo** existente e insira valor **no campo Senha do aplicativo** existente.

      1. Selecione **Examinar + criar**.

          ![Criar Bot do Azure](~/assets/images/adaptive-cards/create-azure-bot.png)

      1. Se a validação for aprovada, selecione **Criar**.

          Leva alguns instantes para que o serviço de bot seja provisionado.

          ![Validação do Bot do Azure](~/assets/images/adaptive-cards/validation-pane.png)

      1. Selecione **Acessar recursos**. O bot e os recursos relacionados estão listados no grupo de recursos.

          ![Ir para o recurso](~/assets/images/adaptive-cards/go-to-resource-card.png)

          Agora seu bot do Azure é criado.

          ![Recurso de bot do Azure criado](~/assets/images/adaptive-cards/azure-bot-ui.png)

      **Para criar o segredo do cliente**

      1. Em **Configurações**, selecione **Configuração**. Salve a **ID do Microsoft App** (ID do cliente) para referência futura.

          ![ID do Aplicativo Microsoft](~/assets/images/adaptive-cards/config-microsoft-app-id.png)

          > [!NOTE]
          > Verifique **se MultiTenant** está selecionado em Tipo **de Bot**.

      1. Adjacente à **ID do Microsoft App**, selecione **Gerenciar**.

          ![Gerenciar Bot](~/assets/images/adaptive-cards/manage-bot-label.png)

      1. Na seção **Segredos do** cliente, selecione **Novo segredo do cliente**. **Adicionar uma janela de segredo do** cliente é exibida.  

          ![Novo segredo do cliente](~/assets/images/adaptive-cards/new-client-secret.png)

      1. Insira **Descrição** e selecione **Adicionar**.

          ![Segredo do cliente](~/assets/images/adaptive-cards/client-secret.png)

      1. Na coluna **Valor** , selecione **Copiar para área de transferência** e salve a ID do segredo do cliente para referência futura.

          ![Valor de segredo do cliente](~/assets/images/adaptive-cards/client-secret-value.png)
         
      **Para adicionar o Microsoft Teams canal**

      1. Vá para **Home**.

          ![Home page bot](~/assets/images/adaptive-cards/bot-home-page.png)

      1. Abra seu bot, que está listado na **seção Recursos recentes** .
      1. Selecione **Canais** no painel esquerdo e selecione **Teams** <img src="~/assets/images/bots/teamsicon.png" alt="Teams icon" width="20"/>.

          ![Canal Teams](~/assets/images/adaptive-cards/channel-teams.png)

      1. Selecione a caixa de seleção para aceitar os termos de serviço e selecione **Concordar**.</br>

          ![Selecionar termos de serviço](~/assets/images/adaptive-cards/select-terms-of-service.png)

      1. Selecione **Salvar**.

          ![Selecione Teams](~/assets/images/adaptive-cards/select-teams.png)

      **Para adicionar ponto de extremidade de mensagens**

      1. Vá para **Página** Inicial e selecione **Configuração** **em Configurações** no painel esquerdo.
      1. Vá para ngrok.
      1. Copie a URL HTTPS (https para io) conforme mostrado na imagem a seguir:

          ![URL HTTPS do ngrok](~/assets/images/adaptive-cards/ngrok-url.png)

      1. No **ponto de extremidade Mensagens**, adicione a URL HTTPS gerada a partir do ngrok e, no final da URL, adicione **/api/messages**.

          ![Ponto de extremidade de mensagens](~/assets/images/adaptive-cards/ngrok-messaging-endpoint.png)

      1. Selecione **Aplicar**.

          Você definiu com êxito um bot no Serviço de Bot do Azure e agora precisa configurar a conexão de serviço bot.
  - title: Configurar a conexão de serviço de bot
    durationInMinutes: 5
    content: |
      Para garantir que o Serviço bot permita que o usuário entre e acesse o bot, você deve configurar o SSO para seu bot. Para fazer isso, execute o seguinte:

      1. Adicionar URI de redirecionamento ao recurso de bot do Azure
      1. Expor ponto de extremidade da API
      1. Autorizar aplicativos cliente
      1. Adicionar quaisquer permissões de API necessárias para chamadas downstream
      1. Habilitar concessão implícita
      1. Manifesto de atualização
      1. Configurar a conexão de Serviço de Bot

      **Para adicionar o URI de redirecionamento ao recurso de bot do Azure**

      1. Selecione **Gerenciar** ao lado da **ID do Microsoft App**.

          ![Gerenciar Bot](~/assets/images/adaptive-cards/manage-bot-label.png)

      1. Selecione **Autenticação** no painel esquerdo do recurso bot.
      1. Em **Configurações de plataforma**, selecione **Adicionar uma plataforma**.
      1. Selecione **Web**.
      1. Insira **URIs de redirecionamento** como **https://token.botframework.com/.auth/web/redirect** e selecione **Configurar**.

          ![Configurar url de redirecionamento da Web](~/assets/images/adaptive-cards/configure-web-redirect-url.png)

          O URI de redirecionamento é adicionado ao recurso de bot do Azure.

          ![Exibir URL de redirecionamento da Web](~/assets/images/adaptive-cards/web-redirect-url-display.png)

      **Para expor o ponto de extremidade da API**

      1. Selecione **Expor uma API** no painel esquerdo.
      1. Selecione **Definir** para o URI de ID do Aplicativo.
      1. Use a **URL de ID** do Aplicativo mostrada e  adicione api:// em vez de https://  na **url do ngrok** e adicione no início da URL da ID do Aplicativo.

          ![URI da ID do Aplicativo](~/assets/images/adaptive-cards/app-id-url.png)

      1. Selecione **Salvar**.
      1. Selecione **Adicionar um escopo**.
      1. Em **Nome do escopo**, **digite access_as_user**.
      1. Em **Who pode consentir?**, alternar para **Administradores e usuários**.
      1. Insira os seguintes valores nas caixas:

          | Campo | Valor |
          | ----- | ----- |
          | Nome de exibição de consentimento do administrador | Teams pode acessar o perfil do usuário |
          | Descrição do consentimento do administrador | Permite Teams chamar as APIs web do aplicativo como o usuário atual. |
          | Nome de exibição de consentimento do usuário | Teams pode acessar seu perfil de usuário e fazer solicitações em seu nome |
          | Descrição do consentimento do usuário | Habilita Teams chamar as APIs desse aplicativo com os mesmos direitos que você tem. |

      1. Verifique se o **Estado** está definido como **Habilitado**.

          ![Adicionar um escopo](~/assets/images/adaptive-cards/add-scope.png)

      1. Selecione **Adicionar escopo**. O nome do escopo corresponde automaticamente ao URI de ID do aplicativo, com **/access_as_user** adicionado ao final.

      **Para autorizar aplicativos cliente**

      Adicione as seguintes IDs como **aplicativos cliente autorizados**, marque a caixa de seleção para **escopos autorizados** e selecione **Adicionar aplicativo**.      
      * 1fec8e78-bce4-4aaf-ab1b-5451cc387264 (Teams aplicativo móvel ou desktop)            
      * 5e3ce6c0-2b1f-4285-8d4b-75ee78787346 (Teams aplicativo Web)</br>

          ![Adicionar aplicativo cliente](~/assets/images/adaptive-cards/add-client-aapplication.png)      

      **Para adicionar quaisquer permissões de API necessárias para chamadas downstream**

      1. Selecione **permissões de API** no painel esquerdo.
      1. Selecione **Adicionar uma permissão**. **A janela Solicitar permissões de API** é exibida.
      1. Selecione **API da Microsoft**. Em seguida **, selecione Microsoft Graph** e selecione **Permissões delegadas**.
      1. Adicione qualquer permissão **delegada pelo** usuário que seu aplicativo exija para APIs de downstream, por exemplo, User.Read.</br>

          ![Permissões de API](~/assets/images/adaptive-cards/add-permissions.png)

      **Para habilitar a concessão implícita**

      1. Selecione **Autenticação** no painel esquerdo.
      1. Selecione **Caixas de seleção Tokens de** **acesso e tokens de ID** .</br>

          ![Tokens de autenticação](~/assets/images/adaptive-cards/authentication-tokens.png)

      1. Selecione **Salvar** para salvar as alterações.

      **Para atualizar manifesto**

      1. Selecione **Manifesto** no painel esquerdo.
      1. Verifique se o item config está definido como **"accessTokenAcceptedVersion": 2**. Caso não seja, altere seu valor para **2** e selecione **Salvar**.
          
          > [!NOTE]
          > Se você já estiver testando seu bot Teams, você deve sair deste aplicativo e sair Teams. Em seguida, entre novamente para ver essa alteração.

          ![Manifesto de atualização](~/assets/images/adaptive-cards/manifest.png)

      **Para configurar a conexão de Serviço de Bot**

      1. Vá para **Página** Inicial e selecione **Configuração** **em Configurações** no painel esquerdo.
      1. Selecione **Adicionar conexão OAuth Configurações**.
      1. Em **Nova Configuração de Conexão**, insira os seguintes detalhes:

          | Campo | Valor ou descrição |
          | ----- | ----- |
          | Nome | Digite o nome da nova configuração de conexão. Você pode usar o nome nas configurações do código de serviço de bot. |
          | Service Provider | Selecione **Azure Active Directory V2**. |
          | ID do cliente | Salvo anteriormente como sua **ID do Microsoft App**. |
          | Segredo do cliente | Salvo anteriormente **como Valor** da ID secreta do cliente. |
          | URL Exchange token | Use a **URL de ID do Aplicativo** obtida anteriormente durante a exposição do ponto de extremidade da API. |
          | ID do locatário | Insira **comum**. |
          | Scopes | Insira **User.Read e** também adicione todos os **Escopos necessários** ao especificar permissões para APIs de downstream. |

          :::image type="content" source="./assets/images/adaptive-cards/oauth-connection-setting.png" alt-text="Conexão de serviço bot":::

      1. Selecione **Salvar**.
  - title: Configurar o bot
    durationInMinutes: 1
    content: |
      Configure o exemplo de bot para entender como autenticar o bot de conversa no Microsoft Teams.

      **Para configurar e executar seu exemplo de bot**

      1. Vá para o repo https://github.com/OfficeDev/Microsoft-Teams-Samples.git.
      1. Selecione **Código** e selecione o menu suspenso.
      1. Selecione **Baixar ZIP**.

          ![Repo Download](~/assets/images/adaptive-cards/repo-download.png)

      1. Certifique-se de observar o Caminho do repositório baixado.
      1. No Explorador de Arquivos, selecione o **Project**.
      1. Vá para **Microsoft-Teams-Samples > exemplos > tab-adaptive-cards > csharp > pasta TabWithAdpativeCardFlow**.
      1. Abra o **arquivo appsettings.json** Visual Studio Code.
      1. Atualize **a configuração appsettings.json** para o bot `MicrosoftAppId`usar o , `MicrosoftAppPassword`e adicione seu URI ngrok como `ApplicationBaseUrl`.
      1. Use o nome da conexão OAuth como o **Nome da Conexão**.

          > [!NOTE]
          > Você pode obter a `MicrosoftAppId` partir da página Configuração do bot. The `MicrosoftAppPassword` is the Value for client secret ID that you saved previously.

          ![Appsettings Json](~/assets/images/adaptive-cards/appsettings-json.png)

      1. Selecione **Salvar**.
  - title: Configurar e carregar o aplicativo Teams
    durationInMinutes: 2
    content: |
      A maneira mais abrangente de testar seu bot é criando um pacote de aplicativos e carregando-o para Teams. Este método é a única maneira de testar a funcionalidade completa disponível para o bot, em todos os escopos. Você pode configurar e executar o aplicativo Teams carregando o arquivo **manifest.zip**.

      **Para executar o Teams, carregando o arquivo manifest.zip**

      1. No Explorador de Arquivos, vá para **Microsoft-Teams-Samples > exemplos > tab-adaptive-cards > csharp > TabWithAdpativeCardFlow > AppPackage** para abrir a pasta.
      1. Abra o **arquivo manifest.json** no Visual Studio Code.
      1. No arquivo **manifest.json** , encontre **{contentBotId}** e adicione sua ID do Microsoft App e salve.

          ![Config de manifesto](~/assets/images/adaptive-cards/manifest-vsc.png)

      1. No Explorador de Arquivos, vá para a **pasta AppPackage** .
      1. Feche o conteúdo da pasta **AppPackage** **para criarmanifest.zip**.

          > [!NOTE]
          > O **manifest.zip** deve conter pastas adicionais. Ele deve ter **arquivo de** origem json de manifesto, **ícone de** cor e ícone **de contorno** dentro da pasta zip.

      1. Vá para Teams.
      1. Para carregar **manifest.zip**, selecione **Armazenar > Gerenciar seus aplicativos > Upload um aplicativo** personalizado e abra **manifest.zip**.
      1. Selecione **Adicionar** para adicionar a guia ao seu chat.

          ![Guia no Teams app](~/assets/images/adaptive-cards/tab-in-teams.png)

          Você pode interagir com essa guia ao entrar.

      1. Envie uma mensagem para a guia.

          ![Captura de tela do Desktop Mobile](~/assets/images/adaptive-cards/desktop-mobile-screenshot.png)
  - title: Interagindo com a guia no Teams
    durationInMinutes: 1
    content: |
      As guias permitem que você acesse serviços e conteúdo em um espaço dedicado em um canal ou em um chat.

      Siga as etapas para usar a guia:

      1. No painel esquerdo do Teams, selecione as releições *** e escolha seu aplicativo na lista.
      1. Guia mostrando cartão adaptável com controles de ação.

          ![Guia mostrando cartão adaptável com controles de ação](~/assets/images/adaptive-cards/adaptive-cards-tab-action-controls.png)

      1. Selecione **Entrar e** escolha uma conta para acessar a guia.

          ![Entrar](~/assets/images/adaptive-cards/sign-in-page.png)

      1. Selecione **Mostrar Módulo de Tarefa** na home page.

          ![Mostrar Módulo de Tarefa](~/assets/images/adaptive-cards/tab-home-page.png)

      1. Tab/fetch é a primeira solicitação de invocação que seu bot recebe quando um usuário abre uma guia Cartão Adaptável. Quando o bot recebe a solicitação, ele envia uma resposta de continuação de tabulação ou uma resposta de tabulação.

          ![Módulo de Tarefa de Exemplo](~/assets/images/adaptive-cards/sample-task-module.png)

      1. **Função Enviar do Cartão Adaptável**
          **a solicitação de tarefa/** envio é acionada para o bot com os dados correspondentes por meio da Ação. 

          ![Cartão de envio de tarefa](~/assets/images/adaptive-cards/task-submit.png)

      1. A guia mantém você entrar, a menos que você selecione **Sair**.

          ![Sair](~/assets/images/adaptive-cards/sign-out.png)

      1. Atualize **para entrar** novamente.

          ![Saída de sucesso](~/assets/images/adaptive-cards/success-sign-out.png)
  - title: Desafio completo
    durationInMinutes: 1
    content: |
      Você achou algo assim?

      ![Captura de tela do Desktop Mobile](~/assets/images/adaptive-cards/desktop-mobile-screenshot.png)
  - content: |
      Você concluiu o tutorial para começar com cartões adaptáveis para Microsoft Teams usando a Estrutura de Bot.