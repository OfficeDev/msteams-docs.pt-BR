### YamlMime:Tutorial
title: Bot de chamada e reunião do Teams
metadata:
  title: Bot do Teams com chamada e reunião
  description: Com este módulo de aprendizado, saiba como configurar a funcionalidade de chamada e reunião em um bot para o Teams.
  audience: Developer
  level: Beginner
  ms.date: 02/08/2021
  ms.topic: interactive-tutorial
  nextTutorialHref: bots/calls-and-meetings/registering-calling-bot.md
  nextTutorialTitle: Registrar um bot de chamada
  ms.custom: mvc
  ms.localizationpriority: none
  ms.openlocfilehash: b57e9744699c7318674f387451f17afc66c5667e
  ms.sourcegitcommit: 88fb2e9a18de3bd84e3c604ff235fc753c8de8f5
  ms.translationtype: MT
  ms.contentlocale: pt-BR
  ms.lasthandoff: 11/02/2022
  ms.locfileid: "68818098"
items:
- durationInMinutes: 1
  content: >
    O bot de chamada e reunião do Microsoft Teams fornece funcionalidades básicas, como, criar uma chamada, ingressar em uma chamada, transferir ou redirecionar uma chamada, ingressar em uma reunião agendada e convidar os participantes integrando comunicações de nuvem API do Graph.


    Os bots podem interagir com chamadas e reuniões do Teams usando voz, vídeo e compartilhamento de tela em tempo real. Com APIs do Microsoft Graph para chamadas e reuniões online, os aplicativos do Teams podem interagir com usuários usando voz e vídeo para aprimorar sua experiência. Essas APIs permitem que você adicione os seguintes novos recursos:


    * Use o IVR (Interactive Voice Response).

    * Use o controle de chamada.

    * Forneça acesso a fluxos de áudio e vídeo em tempo real, incluindo compartilhamento de área de trabalho e aplicativo.


    Crie um bot e especifique informações e permissões adicionais para usar essas APIs do Graph em um aplicativo do Teams.


    Este guia passo a passo ajuda você a configurar o bot de chamada e reunião do Teams. Ao final deste tutorial, você pode obter a seguinte saída:


    :::image type="content" source="./assets/images/calls-and-meetings/final-output.png" alt-text="Saída final.":::
- title: Pré-requisitos
  durationInMinutes: 1
  content: "Certifique-se de instalar as seguintes ferramentas e configurar seu ambiente de desenvolvimento:\n\n | &nbsp; | Instalar | Para usar... |\n | --- | --- | --- |\n | **Required** | &nbsp; | &nbsp; |\n | &nbsp; | [Conta de desenvolvedor do Microsoft 365](/microsoftteams/platform/concepts/build-and-test/prepare-your-o365-tenant) | Acesso à conta do Teams com as permissões apropriadas para instalar um aplicativo. |\n | &nbsp; | [ngrok](https://ngrok.com/download) | Os recursos do aplicativo Teams (bots de conversa, extensões de mensagem e webhooks de entrada) exigem conexões de entrada. Um túnel conecta seu sistema de desenvolvimento ao Teams. Não é necessário para aplicativos que incluem apenas guias. Esse pacote é instalado no diretório do projeto (usando npm `devDependencies`). |\n | &nbsp; | [Visual Studio 2022 versão 17.3](https://visualstudio.microsoft.com)<br> Instale uma das duas cargas de trabalho a seguir:<br> • ASP.NET e desenvolvimento web <br> • Desenvolvimento entre plataformas do .NET Core | Você pode instalar a versão corporativa no Visual Studio 2022 e instalar as cargas de trabalho. |   \n | &nbsp; | [SDK do .NET Core versão 3.1 (não uma conta de convidado)](https://dotnet.microsoft.com/en-us/download) | Associações personalizadas para implantações de aplicativo de depuração local e Azure Functions. Se você ainda não instalou o SDK do .NET 3.1 (ou posterior) globalmente, a versão portátil poderá ser instalada. |\n | &nbsp; | [Microsoft Teams e uma conta do Teams](https://www.microsoft.com/microsoft-teams/download-app) | Microsoft Teams para colaborar com todos com quem você trabalha por meio de aplicativos para chats, reuniões, chamadas e tudo em um só lugar. |\n | &nbsp; | [Windows PowerShell](/microsoftteams/teams-powershell-install) | Instale executando todos os comandos. |\n"
- title: Configurar o bot de chamada e reunião
  durationInMinutes: 5
  content: "Registre um aplicativo usando o registro de aplicativo no Microsoft portal do Azure para que seu aplicativo se integre ao plataforma de identidade da Microsoft e chame a Microsoft API do Graph. Execute as etapas a seguir:\n\n1. Crie um túnel ngrok para os pontos de extremidade do servidor Web.\n1. Crie o recurso de bot do Azure para registrar bot com o serviço de bot do Azure.\n1. Crie o segredo do cliente que habilita a autenticação de SSO (logon único) do bot.\n1. Crie uma política para um usuário locatário de demonstração para criar reuniões online usando o PowerShell.\n1. Adicione permissões de API para chamadas downstream.\n1. Criar registro de canal de bot na conta do Azure.\n1. Adicione o canal do Microsoft Teams para implantar o bot em um canal do Teams.\n1. Adicione o ponto de extremidade de mensagens ao túnel ngrok que você criou.\n\n**Criar túnel ngrok**\n\nUse o ngrok para criar um túnel para os pontos de extremidade HTTPS disponíveis publicamente do servidor Web localmente. Execute o seguinte comando no ngrok:\n\n```bash\nngrok http --host-header=rewrite 3978\n```\n\n**Registrar um aplicativo no Azure**\n\n1. Vá para [portal do Azure](https://portal.azure.com/) usando sua conta microsoft pessoal.\n1. Selecione **Azure Active Directory**.\n\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/azure-active-directory.png\" alt-text=\"Diretório ativo do Azure.\":::\n\n1. No painel esquerdo, selecione **Registros de aplicativo**.\n1. Selecione **Novo registro**.\n\n   :::image type=\"content\" source=\"./assets/images/calls-and-meetings/azure-active-directory_1.png\" alt-text=\"Novo diretório ativo do Azure.\":::\n\n\n**O registro de uma** janela de aplicativo é exibido. Insira as informações de registro do aplicativo.\n\n  1. Em **Nome**, insira o nome do aplicativo exibido aos usuários.\n\n  1. Em **Tipos de conta com suporte**, selecione as contas que você deseja que seu aplicativo dê suporte.\n\n  1. No **URI de Redirecionamento (opcional),** selecione o tipo de **aplicativo Web ou Cliente Público (móvel e desktop)** e insira o URI de redirecionamento para seu aplicativo.\n\n     > [!NOTE]\n     > Para aplicativos Web, forneça o URI base como `http://localhost:31544`. Para aplicativos cliente públicos, forneça o URI usado por Azure AD para retornar respostas de token como `myapp://auth`.\n\n  1. Selecione **Registrar**.\n\n     :::image type=\"content\" source=\"./assets/images/calls-and-meetings/reg-app_2.png\" alt-text=\"Captura de tela mostrando a seleção de registro.\" lightbox=\"./assets/images/calls-and-meetings/reg-app_1.png\":::\n\n**Para criar o segredo do cliente**\n\n1. Na página **Visão geral** do bot, selecione **Essentials** e salve a **ID do Aplicativo (cliente)** (ID do Aplicativo Microsoft) para referência futura.\n\n   :::image type=\"content\" source=\"./assets/images/calls-and-meetings/microsoft-app-id-new_2.png\" alt-text=\"Captura de tela mostrando a ID do Aplicativo Microsoft.\":::\n\n1. Em **Gerenciar**, selecione **Certificados & segredos**.\n1. Selecione **Segredos** >  do **cliente Novo segredo do cliente**.\n\n**A janela adicionar um segredo do cliente** é exibida.\n\n  1. Insira **Descrição** para o segredo do cliente.\n  1. Selecione **Adicionar**.\n\n     :::image type=\"content\" source=\"./assets/images/calls-and-meetings/add-client_2.png\" alt-text=\"Captura de tela mostrando o segredo do cliente sendo adicionado.\"lightbox=\"./assets/images/calls-and-meetings/add-client_2.png\":::\n\n  1. Selecione **Copiar para área de transferência** para copiar os detalhes do **Valor** .\n\n     :::image type=\"content\" source=\"./assets/images/calls-and-meetings/client-secret_2.png\" alt-text=\"Tela de tela mostrando o valor que está sendo copiado para a área de transferência.\":::\n\n      > [!TIP]\n      > Salve os segredos do cliente **Valor** ou senha do aplicativo para referência futura.\n\n**Executar script do PowerShell para criar uma política**\n\n1. Crie uma política para um usuário locatário de demonstração criar reuniões online usando o seguinte script do PowerShell:\n\n    > [!NOTE]\n    > Execute Windows PowerShell PSI como administrador e execute o script.\n\n    ```PowerShell\n\n    New-CsApplicationAccessPolicy -Identity \"<<policy-identity/policy-name>>\" -AppIds \"<<azure-client-id>>\" -Description \"Policy-description\"\n    Grant-CsApplicationAccessPolicy -PolicyName \"<<policy-identity/policy-name>>\" -Identity \"<<object-id-of-the-user-to-whom-policy-need-to-be-granted>>\"\n\n    ```\n\n1. Substitua `azure-client-id` pela **ID do Aplicativo Microsoft** e `object-id` pela **ID do Locatário** da sua conta usada para entrar no Teams. Copie o link conforme mostrado na imagem a seguir e você pode encontrar a ID do locatário da sua conta do Teams no link obtido:\n\n    1. Selecione **Teams**.\n\n    1. Selecione a reticência ●●●.\n\n    1. Selecione **Obter um link para a equipe**.\n   \n       :::image type=\"content\" source=\"./assets/images/calls-and-meetings/teams-final.png\" alt-text=\"A captura de tela mostra a substituição de Microsoft-App ID.\":::\n   \n1. Adicione `PolicyName`, `azure-client-id`, `policy-description`e `object-id` no script do PowerShell.\n1. Entre com sua conta do Teams quando o PowerShell solicitar.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/powershell_1.png\" alt-text=\"A captura de tela mostra o PowerShell.\":::\n\n1. Execute o comando a seguir no PowerShell para verificar se a política foi criada com êxito ou não. Substitua o nome da política pelo nome da política definido.\n\n \n    ```PowerShell\n    Get-CsApplicationAccessPolicy -Identity “<<policy-identity/policy-name>>”\n    ```\n\n    > [!NOTE]\n    > Verifique se os scripts em execução não estão desabilitados em seu sistema. Para obter mais informações, consulte [políticas de execução](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-7.2).\n\n**Para adicionar permissões de API para chamadas downstream**\n\n> [!NOTE]\n> Verifique se sua conta pode conceder o consentimento do administrador para a Microsoft. Depois de adicionar permissões, selecione `Grant admin consent for Microsoft` para saber o status do consentimento.\n\n1. No painel **Gerenciar** do bot, selecione **permissões de API**.\n1. Selecione **Adicionar uma permissão**. **A janela Solicitar permissões de API** é exibida.\n1. Selecione **APIs da** > **Microsoft Microsoft Graph**.\n1. Selecione **Permissões de aplicativos**.\n1. Selecione permissões e adicione as seguintes permissões de aplicativos API do Graph ao seu Azure App e conceda o consentimento do administrador:\n    * `Calls.AccessMedia.All`\n    * `Calls.Initiate.All`\n    * `Calls.InitiateGroupCall.All`\n    * `Calls.JoinGroupCall.All`\n    * `Calls.JoinGroupCallAsGuest.All`\n    * `OnlineMeetings.ReadWrite.All`\n1. Selecione **Adicionar permissões**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/api-permissions_1.png\" alt-text=\"Captura de tela mostrando as permissões de adição de API.\" lightbox=\"./assets/images/calls-and-meetings/api-permissions_1.png\":::\n\n**Criar registro de canal de bot na conta do Azure**\n\n1. Acesse o [Portal do Azure](https://portal.azure.com/).\n1. Selecione **Criar um recurso**.\n1. Pesquise o **Bot do Azure** na caixa de pesquisa.\n1. Selecione **Bot do Azure**.\n1. Selecionar **Criar**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/azure-bot_1.png\" alt-text=\"Captura de tela mostrando a página inicial do bot do Azure.\":::\n  \n   **Criar uma janela do Bot do Azure** é exibida.\n\n1. Digite o nome do identificador do bot no campo **Identificador do bot**.\n1. Selecione sua **Assinatura** e **grupo de recursos** na lista suspensa.\n    \n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/create-azure-bot.png\" alt-text=\"Captura de tela mostrando a criação do bot do Azure.\":::\n  \n   Você também pode criar um novo grupo de recursos. Selecione **Criar nova** > inserir o nome do recurso > selecione **OK**.\n\n1. Selecione o local necessário na lista suspensa **Local do novo grupo de recursos** , se você tiver criado um novo grupo de recursos.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/newresource.png\" alt-text=\"Captura de tela mostrando o novo local do grupo de recursos.\":::\n\n1. Selecione **Tipo de Aplicativo** como **Vários Locatários**.\n\n    > [!NOTE]\n    > Na `Creation type` seção ID do Aplicativo da Microsoft, `Create new Microsoft App ID` já está selecionado para criar um novo bot. Você também pode selecionar `Use existing app registration`, se você já registrou um bot. Insira a ID do Aplicativo Microsoft no `Existing app ID` campo e insira valor no `Existing app password` campo.\n\n1. Selecione **Usar o registro de aplicativo existente** e insira **a ID do aplicativo** do Azure registrada no locatário de demonstração.\n1. Selecione **Rever + criar**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/review-create_1.png\" alt-text=\"Captura de tela mostrando a seleção de vários locatários.\":::\n\n1. Se a validação for aprovada, selecione **Criar**.\n\n   Levará alguns minutos para o serviço de bot ser provisionado.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/validation_1.png\" alt-text=\"Captura de tela mostrando o passe de validação.\":::\n\n1. Selecione **Vá para o recurso**. O bot e os respectivos recursos estão listados no grupo de recursos.\n\n    Agora, o bot do Azure foi criado.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/go-to-resource_1.png\" alt-text=\"Captura de tela mostrando a navegação para acessar o recurso.\":::\n\n**Para adicionar o canal do Microsoft Teams**\n\n1. Vá para a **Página Inicial**.\n1. Selecione seu bot nos **recursos recentes**.\n1. Selecione **Canais** no painel esquerdo.\n1. Selecione **Microsoft Teams** <img src=\"~/assets/images/bots/teamsicon.png\" alt=\"Teams icon\" width=\"20\"/>.    \n    \n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/channels-teams_1.png\" alt-text=\"Captura de tela mostrando canais do Teams.\":::\n\n1. Selecione a caixa de seleção para aceitar os **Termos de Serviço**.\n1. Selecione **Concordar**.\n\n    :::image type=\"content\" source=\"~/assets/images/calls-and-meetings/terms.png\" alt-text=\"Termos de serviço\":::\n\n1. Selecione **Aplicar**.\n\n   :::image type=\"content\" source=\"../msteams-platform/assets/images/teams-file-upload-bot/apply-teams_1.png\" alt-text=\"microsoft teams\":::\n\n1. Selecione **Microsoft Teams** e selecione **Guia de chamada** na página do canal do Teams.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/configure-teams.png\" alt-text=\"Configurar o Teams.\":::\n\n1. Selecione **Habilitar chamada** e atualize **o Webhook** com sua URL de ngrok HTTPS (https://yourngrok/api/callback) e adicione `/api/callback` no final.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/enable-calling_1.png\" alt-text=\"Habilitar a chamada.\":::\n\n1. Selecione **Aplicar**.\n\n**Para adicionar ponto de extremidade de mensagens**\n\n1. Vá para ngrok.\n1. Copie a URL HTTPS (https para io) conforme mostrado na imagem a seguir:\n    \n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/ngrok_1.png\" alt-text=\"Captura de tela mostrando a janela ngrok.\":::\n\n1. Vá para **Página Inicial** do bot.\n1. Selecione **Configuração** em **Configurações** no painel esquerdo.\n1. No **ponto de extremidade de mensagens**, adicione a URL HTTPS do ngrok e, no final da URL, adicione **/api/messages**.\n    \n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/messaging-endpoint_1.png\" alt-text=\"Captura de tela mostrando o ponto de extremidade de mensagens.\":::\n\n1. Selecione **Aplicar**.\n\n    Você configurou com êxito um bot no serviço de bot do Azure e precisa configurar a conexão do serviço de bot.\n"
- title: Atualizar e criar pacote de aplicativos do Teams
  durationInMinutes: 1
  content: "Configure o exemplo de bot para entender como autenticar o bot de conversa no Microsoft Teams e criar o pacote de aplicativos do Teams e carregá-lo na organização.\n\n1. Atualizar appsettings.json no Visual Studio.\n1. Atualize manifest.json no Visual Studio e compacte-o para o arquivo zip no Explorador de Arquivos.\n\n**Atualizar as configurações de aplicativos para chamar bot**\n\n1. Vá para o repositório https://github.com/OfficeDev/Microsoft-Teams-Samples.git.\n1. Selecione **Código** e selecione a lista suspensa.\n1. Selecione **Baixar ZIP**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/git_1.png\" alt-text=\"Captura de tela mostrando o download do repositório.\":::\n\n    > [!NOTE]\n    > Verifique o caminho do repositório baixado.\n\n1. No **Explorador de Arquivos**, acesse a pasta **csharp** **do microsoft-teams-samples-main** > **samples** > **bot-calling-meeting** > .\n1. Abra o arquivo **appsettings.json** no Visual Studio e atualize a configuração do bot.\n\n    * Você pode obter a `MicrosoftAppId` na página de configuração do bot. O `MicrosoftAppPassword` é o valor da ID de segredo do cliente que você salvou anteriormente.\n    * Você pode obter o `tenantId` ou `UserId` do link da conta usada para entrar no Teams. Siga o caminho na imagem para obter o link para `tenantId`:\n      \n       1. Selecione **Teams**.\n\n       1. Selecione reticências ●●●.\n\n       1. Selecione **Obter um link para a equipe**.\n\n     :::image type=\"content\" source=\"./assets/images/calls-and-meetings/teams-final.png\" alt-text=\"Captura de tela mostrando o link do Teams.\":::\n    \n    * Você pode obter o e `id` do `displayName` site do [Microsoft Graph Explorer](https://developer.microsoft.com/graph/graph-explorer):\n\n        * Entre na página usando sua conta de locatário do Teams.\n\n        * Adicione `Users` no final da URl na caixa de pesquisa.\n\n        * Selecione **Executar consulta**.\n        \n          :::image type=\"content\" source=\"./assets/images/calls-and-meetings/graph-explorer_1.png\" alt-text=\"Explorador de Grafo.\":::\n\n\n        * Os nomes de exibição e as IDs de usuário vinculados à sua conta são gerados.\n\n        * Escolha as três contas e adicione-as `DisplayName` ao e `UserId` em appsettings.json.\n   \n          :::image type=\"content\" source=\"./assets/images/calls-and-meetings/graph-explorer_2.png\" alt-text=\"Explorador de Grafo.\" lightbox=\"./assets/images/calls-and-meetings/graph-explorer_2.png\":::\n\n   \n        > [!NOTE]\n        > `TenantId` ou `UserId` da conta do Teams denota de onde você deseja iniciar a chamada e `DisplayName` `UserId` dos usuários denotam para quem você deseja redirecionar ou transferir a chamada.\n\n1. Substitua `MicrosoftAppId`, `ClientId`, `AppId` por **ID do aplicativo (cliente)** e `MicrosoftAppPassword`, `ClientSecret`e `AppSecret` pelo **Valor**.\n1. Substitua pela `BotBaseUrl` `ngrok` URL.\n1. Substitua `TenantId` e `UserId`.\n1. Substitua `DisplayName` e `Id`.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/appsettings_1.png\" alt-text=\"Captura de tela mostrando o Json Appsettings.\":::\n\n1. Selecione **Salvar**.\n\n**Para atualizar manifesto**\n\n1. No **Explorador de Arquivos**, acesse a pasta **Manifesto** **csharp** >  **do Microsoft-Teams-Samples-main** > **samples** > **bot-calling-meeting** > .\n1. Abra o arquivo `manifest.json` no Visual Studio.\n1. No arquivo, **substitua {id}, {BotId}** pela ID do `manifest.json` Aplicativo Microsoft.\n1. Adicione url ngrok em **validDomains** , excluindo https://.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/manifest_1.png\" alt-text=\"Captura de tela mostrando o manifesto.\" lightbox= \"./assets/images/calls-and-meetings/manifest_1.png\" :::\n\n1. Feche o conteúdo da pasta **Manifesto** para criar `manifest.zip`.\n\n    > [!NOTE]\n    > O `manifest.zip` não deve conter pastas extras nela. Ele deve ter `manifest json` o arquivo de origem, `color` o ícone e `outline` o ícone dentro da pasta zip.\n    > Carregue seu manifesto em seu locatário de demonstração para a organização ou sua conta do Teams e execute sua solução no Visual Studio.\n\n1. Vá para o Teams.\n1. Para carregar `manifest.zip`, selecione **Aplicativos > Gerenciar seus aplicativos > Carregar um aplicativo > Carregar um aplicativo personalizado**.\n\n   :::image type=\"content\" source=\"./assets/images/calls-and-meetings/upload.png\" alt-text=\"Captura de tela mostrando a seleção de adicionar saída.\":::\n\n1. Abra `manifest.zip` na pasta do repositório no Explorador de Arquivos.\n1. Selecione **Adicionar** para instalar o bot de chamada no Teams.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/output_1.png\" alt-text=\"Captura de tela mostrando a seleção de adicionar saída.\":::\n\n    Você pode interagir com esse bot após a depuração no Visual Studio.\n"
- title: Interagir com o bot de chamada e reunião
  durationInMinutes: 2
  content: "O bot permite que você acesse serviços e conteúdo em um espaço dedicado em um canal ou em um chat.\n\nExecute as seguintes etapas para usar o bot:\n\n1. No painel esquerdo do Teams, selecione as reticências ●●● e escolha seu aplicativo na lista.\n1. O bot envia um texto de boas-vindas com Cartão Adaptável.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/bot-with-adaptive-card.png\" alt-text=\"Cartão adaptável no bot.\":::\n\n1. Selecione **Criar Chamada**. \n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/placed-call.png\" alt-text=\"Captura de tela mostrando a chamada colocada.\":::\n\n1. Selecione **Transferir Chamada**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/transfer-call.png\" alt-text=\"A captura de tela mostra a chamada de transferência.\":::\n\n1. Você pode pedir ao bot para agendar uma reunião e convidar os participantes.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/meeting.png\" alt-text=\"A captura de tela mostra o bot de reunião.\":::\n"
- title: Desafio completo
  durationInMinutes: 1
  content: >
    Você veio com uma saída como esta?


    :::image type="content" source="./assets/images/calls-and-meetings/final-output.png" alt-text="Saída final.":::
- content: Você concluiu o tutorial para começar a usar a chamada de bot e o aplicativo de reunião para o Microsoft Teams.
