### YamlMime:Tutorial
title: Teams de chamada e reunião
metadata:
  title: Teams bot com chamada e reunião
  description: Neste tutorial, você aprenderá a configurar a chamada e a reunião em um bot para Teams.
  audience: Developer
  level: Beginner
  ms.date: 02/08/2021
  ms.topic: interactive-tutorial
  nextTutorialHref: bots/calls-and-meetings/registering-calling-bot.md
  nextTutorialTitle: Registrar um bot de chamada
  ms.custom: mvc
  ms.localizationpriority: none
  ms.openlocfilehash: 0ceeea6474ab1ce0c20bcd51b65f792dfadd43c8
  ms.sourcegitcommit: 9bdd930523041377b52dadffbd8cd52a86a047d7
  ms.translationtype: MT
  ms.contentlocale: pt-BR
  ms.lasthandoff: 02/08/2022
  ms.locfileid: "62444002"
items:
- durationInMinutes: 1
  content: >
    O bot de chamada e reunião fornece funcionalidades básicas, como criar uma chamada, participar de uma chamada, transferir ou redirecionar uma chamada, participar de uma reunião agendada e convidar os participantes integrando a API de comunicações na nuvem Graph API.


    Os bots podem interagir com Teams e reuniões usando o compartilhamento de voz, vídeo e tela em tempo real. Com as APIs Graph Microsoft para chamadas e reuniões online, Teams aplicativos agora podem interagir com os usuários usando voz e vídeo para aprimorar a experiência. Essas APIs permitem adicionar os seguintes novos recursos:


    * Resposta interativa de voz (IVR)

    * Controle de chamada

    * Acesso a fluxos de áudio e vídeo em tempo real, incluindo o compartilhamento de aplicativos e área de trabalho


    Crie um bot e especifique algumas informações e permissões adicionais para usar essas GRAPH APIs em um Teams app.


    Este guia passo a passo ajuda você a criar um bot com a funcionalidade de chamada e reunião. No final deste tutorial, você pode obter a seguinte saída:


    ![Saída final](~/assets/images/calls-and-meetings/final-output.png)
- title: Pré-requisitos
  durationInMinutes: 1
  content: "Certifique-se de instalar as seguintes ferramentas e configurar seu ambiente de desenvolvimento:  \n\n* [Office 365 locatário](https://developer.microsoft.com/en-us/microsoft-365/dev-program)\n* [Solução de túnel ngrok](https://ngrok.com/) ou equivalente\n* [Visual Studio 2019](https://visualstudio.microsoft.com/downloads/)\n* [.NET Core SDK](https://dotnet.microsoft.com/en-us/download) versão 3.1\n* Microsoft Teams com uma conta (não uma conta de convidado)\n* Instalar [Windows PowerShell](https://docs.microsoft.com/en-us/microsoftteams/teams-powershell-install) executando todos os comandos\n"
- title: Setup Calling and Meeting Bot
  durationInMinutes: 5
  content: "Registre um aplicativo usando o registro de aplicativo no portal do Azure para que seu aplicativo se integre ao plataforma de identidade da Microsoft e chame o Microsoft Graph. Execute o seguinte:\n\n1. Use ngrok para criar um túnel para os pontos de extremidade do servidor Web.\n1. Crie o recurso bot do Azure para registrar bot com o Serviço bot do Azure.\n1. Crie o segredo do cliente que habilita a autenticação SSO do bot.\n1. Crie uma política para um usuário de locatário de demonstração para criar as reuniões online usando o PowerShell.\n1. Adicione permissões de API para chamadas downstream.\n1. Criar registro de canal bot na conta do Azure.\n1. Adicione Microsoft Teams canal para implantar o bot em um canal Teams.\n1. Adicione o ponto de extremidade de mensagens ao túnel de ngrok que você criou.\n\n**Criar túnel ngrok:**\n\nUse o ngrok para criar um túnel para os pontos de extremidade HTTPS disponíveis publicamente do servidor Web em execução local. Execute o seguinte comando em ngrok:\n\n```bash\nngrok http -host-header=rewrite 3978\n```\n\n**Registre um aplicativo no Azure:**\n\n1. Entre no [portal do Azure usando](https://portal.azure.com/) sua conta pessoal da Microsoft.\n1. Selecione o **Azure Active Directory** e selecione **Registros de aplicativo no** painel esquerdo e selecione **Novo registro**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/azure-active-directory.png\" alt-text=\"Azure active directory.\":::\n\n1. **Registre uma página de** aplicativo aberta. Insira as informações de registro do aplicativo.\n1. Insira um nome de aplicativo **significativo** que é exibido para os usuários do aplicativo.\n1. Em **Tipos de conta com suporte**, selecione as contas que você gostaria que seu aplicativo suportasse.\n1. No **campo Redirecionar URI** (opcional), selecione o tipo de aplicativo Web ou cliente público (área de trabalho móvel &) e insira o URI de **redirecionamento** para seu aplicativo.\n\n    > [!NOTE]\n    > Para aplicativos Web, forneça o URI base como `http://localhost:31544`. Para aplicativos públicos de cliente, forneça o URI usado pelo Azure AD para retornar respostas de token como `myapp://auth`.\n\n1. Selecione **Registrar**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/reg-app.png\" alt-text=\"Registre um aplicativo.\":::\n\n**Para criar o segredo do cliente:**\n\n1. Na **página Visão** geral do bot, selecione **Essentials** e salve a **ID** do cliente de aplicativo (ID do aplicativo microsoft) para referência futura.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/microsoft-app-id-new.png\" alt-text=\"ID do Aplicativo microsoft.\":::\n\n1. Em **Gerenciar**, selecione **Certificados & segredos** , selecione **Segredos do** cliente e selecione **Novo segredo do cliente**. A **janela Adicionar um segredo do** cliente é exibida.  \n\n1. Insira **Descrição** e selecione **Adicionar**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/add-client.png\" alt-text=\"Adicionar segredo do cliente.\":::\n\n1. Na coluna **Valor** , selecione **Copiar para área de transferência** e salve a ID do segredo do cliente para referência futura.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/client-secret.png\" alt-text=\"Valor.\":::\n\n**Execute o script do PowerShell para criar uma política:**\n\n1. Crie uma política para um usuário de locatário de demonstração para criar as reuniões online usando o seguinte script do PowerShell:\n\n    > [!NOTE]\n    > Execute Windows PowerShell PSI como administrador e execute o script.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/powershell-script.png\" alt-text=\"Script do PowerShell.\":::\n\n1. `azure-client-id` Substitua por sua **ID do Microsoft App** do seu bot `object-id` e pela **ID** de Locatário da sua conta usada para fazer logon no Teams (Copie o link conforme mostrado na imagem a seguir e você pode encontrar a ID de locatário da sua conta Teams no link obtido).\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/teams-link-new.png\" alt-text=\"Teams Link.\":::\n\n1. Adicione `PolicyName`, `azure-client-id`e `policy-description`no `object-id` script do PowerShell. Faça logon com sua Teams quando o PowerShell solicitar.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/powershell.png\" alt-text=\"PowerShell.\":::\n\n1. Execute o seguinte comando no PowerShell para verificar se a política foi criada com êxito ou não. Substitua o nome da política pelo nome da política definido.\n\n    ```powershell\n    Get-CsApplicationAccessPolicy -Identity “<<policy-identity/policy-name>>”\n    ```\n\n**Para adicionar permissões de API para chamadas downstream:**\n\n> [!NOTE]\n> Certifique-se de que sua conta possa conceder o consentimento do administrador para a Microsoft. Depois de adicionar permissões, selecione `Grant admin consent for Microsoft` para saber o status do consentimento.\n\n1. Em **Gerenciar** painel do bot, selecione **permissões de API**.\n1. Selecione **Adicionar uma permissão**. **A janela Solicitar permissões de API** é exibida.\n1. Selecione **APIs da Microsoft** e selecione **Microsoft Graph**.\n1. Selecione **Permissões de aplicativo e** selecione permissões.\n1. Adicione as Graph de aplicativos de API a seguir ao aplicativo do Azure e conceda o consentimento do administrador.\n    * `Calls.AccessMedia.All`\n    * `Calls.Initiate.All`\n    * `Calls.InitiateGroupCall.All`\n    * `Calls.JoinGroupCall.All`\n    * `Calls.JoinGroupCallAsGuest.All`\n    * `OnlineMeetings.ReadWrite.All`\n1. Selecione **Adicionar permissões**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/add-api-permissions.png\" alt-text=\"Adicionar permissões de API.\":::\n\n**Criar registro de canal bot na conta do Azure:**\n\n1. Abra [o portal do Azure](https://portal.azure.com/).\n1. Selecione **Criar um recurso**.\n1. **Pesquise o Bot do Azure** na caixa de pesquisa.\n1. Selecione **Bot do Azure**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/azure-bot-homepage.png\" alt-text=\"Cartão de bot do Azure.\":::\n\n1. Selecionar **Criar**.\n1. Insira o nome da alça do bot no **campo Manipular** Bot.\n1. Selecione sua **Assinatura** na lista de menus suspensos.\n1. Selecione seu **grupo De recursos** na lista de menus suspensos.\n\n    Para criar um novo grupo de recursos, selecione **Criar** novo, insira nome do recurso, selecione **OK** e selecione o local necessário  na lista lista suspenso Novo local do grupo de recursos.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/create-azure-bot.png\" alt-text=\"Criar o Bot do Azure.\":::\n\n1. Selecione **Tipo de Aplicativo** como **Multi Locatário** para **ID do Aplicativo Microsoft**.\n\n    > [!NOTE]\n    > Na `Creation type` seção ID do Microsoft App, já `Create new Microsoft App ID` está selecionado para criar um novo bot. Você também pode selecionar `Use existing app registration`, se já tiver registrado um bot. Insira a ID do Microsoft App no `Existing app id` campo e insira o valor no `Existing app password` campo.\n\n1. Selecione **Usar o registro de aplicativo existente e** insira a **ID do** aplicativo e o **segredo** do aplicativo do azure registrado no locatário de demonstração.\n1. Selecione **Examinar + criar**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/review-create.png\" alt-text=\"Vários locatários.\":::\n\n1. Se a validação for aprovada, selecione **Criar**.\n\n   Leva alguns instantes para que o serviço de bot seja provisionado.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/validation.png\" alt-text=\"Validação.\":::\n\n1. Selecione **Acessar recursos**. O bot e os recursos relacionados estão listados no grupo de recursos.\n\n    Agora seu bot do Azure foi criado.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/go-to-resource.png\" alt-text=\"Vá para o recurso.\":::\n\n**Para adicionar o canal Microsoft Teams:**\n\n1. Vá para **Home**.\n1. Abra seu bot, que está listado na **seção Recursos recentes** .\n1. Selecione **Canais** no painel esquerdo e selecione **Microsoft Teams** <img src=\"~/assets/images/bots/teamsicon.png\" alt=\"Teams icon\" width=\"20\"/> na lista de canais disponíveis.    \n    \n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/channels-teams.png\" alt-text=\"Canais Teams.\":::\n\n1. Selecione a caixa de seleção para aceitar os termos de serviço e selecione **Concordar**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/terms-of-service.png\" alt-text=\"Termos de serviço.\":::\n\n1. Selecione **Salvar**.\n1. Selecione **Microsoft Teams** e selecione **Guia Chamar** na Teams do canal.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/configure-teams.png\" alt-text=\"Configure Teams.\":::\n\n1. Selecione **Habilitar** chamada e atualize **Webhook** com sua URL de ngrok HTTPS (https://yourNgrok/api/callback) e adicione `/api/callback` no final.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/enable-calling.png\" alt-text=\"Habilitar a chamada.\":::\n\n1. Selecione **Salvar**.\n\n**Para adicionar ponto de extremidade de mensagens:**\n\n1. Vá para **a home** page do bot e selecione **Configuração** **em** Configurações no painel esquerdo.\n1. Vá para ngrok.\n1. Copie a URL HTTPS (https para io) conforme mostrado na imagem a seguir:\n    \n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/ngrok.png\" alt-text=\"Ngrok.\":::\n\n1. No **ponto de extremidade Mensagens**, adicione a URL HTTPS disponível no ngrok e, no final da URL, adicione **/api/messages**.\n    \n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/messaging-endpoint.png\" alt-text=\"Ponto de extremidade de mensagens.\":::\n\n1. Selecione **Aplicar**.\n\n    Você definiu com êxito um bot no Serviço de Bot do Azure e agora precisa configurar a conexão de serviço bot.\n"
- title: Atualizar e criar Teams pacote de aplicativos
  durationInMinutes: 1
  content: "Configure o exemplo de bot para entender como autenticar o bot de conversa no Microsoft Teams, criar o pacote de aplicativos Teams e carregar na organização.\n\n1. Atualize appsettings.json no Visual Studio.\n1. Atualize manifest.json no Visual Studio e compacta-o para o arquivo zip no Explorador de arquivos.\n\n**Atualizar appsettings para chamar Bot:**\n\n1. Vá para o repo https://github.com/OfficeDev/Microsoft-Teams-Samples.git.\n1. Selecione **Código** e selecione o menu suspenso.\n1. Selecione **Baixar ZIP**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/repo-download.png\" alt-text=\"Download de repo.\":::\n\n1. Certifique-se de observar o Caminho do repositório baixado.\n1. No Explorador **de Arquivos**, vá para **a pasta Microsoft-Teams-Samples-mainsamplesbot-calling-meetingcsharp** >  >  > .\n1. Abra o **arquivo appsettings.json** no Visual Studio e atualize a configuração do bot.\n\n    * Você pode obter a `MicrosoftAppId` partir da página de configuração do bot. The `MicrosoftAppPassword` is the Value for client secret ID that you saved previously.\n    * Você pode obter o `Tenant ID` ou `UserId` do link da conta usada para fazer logon no Teams. Siga o caminho na imagem para obter o link para `tenant id`.\n    \n        :::image type=\"content\" source=\"./assets/images/calls-and-meetings/teams-link-new.png\" alt-text=\"Teams Link.\":::\n    \n    * Você pode obter o `DisplayName` e do site do `UserId` [Microsoft Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer).\n        * Faça logon na página usando sua Teams e `Users` adicione no final da URl na caixa de pesquisa e selecione **Executar consulta**.\n        * Os nomes de exibição e as IDs de usuário vinculadas à sua conta são gerados.\n        * Escolha qualquer três contas e adicione-as ao `DisplayName` e `UserId` em appsettings.json.\n\n        :::image type=\"content\" source=\"./assets/images/calls-and-meetings/graph-explorer.png\" alt-text=\"Graph Explorer.\":::\n\n    > [!NOTE]\n    > `Tenant ID`ou `UserId` da Teams denota de onde você deseja iniciar a chamada e `DisplayName` `UserId` dos usuários indica para quem deseja redirecionar ou transferir a chamada.\n\n1. Substitua `MicrosoftAppId`, `ClientId`, `AppId` por **sua ID de Aplicativo (cliente)** e `MicrosoftAppPassword`, `ClientSecret`e por `AppSecret` seu **Valor**.\n1. Atualize `BotBaseUrl` com sua `ngrok` URL.\n1. Atualizar `Tenant ID` e `UserId`.\n1. Atualizar `DisplayName` e `UserId`.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/appsettings.png\" alt-text=\"Appsettings Json.\":::\n\n1. Selecione **Salvar**.\n\n**Para atualizar o manifesto:**\n\n1. No Explorador **de Arquivos**, vá para **a pasta Microsoft-Teams-Samples-mainsamplesbot-calling-meetingcsharpManifest** > . >  >  > \n1. Abra o **arquivo manifest.json** no Visual Studio.\n1. No arquivo **manifest.json** , encontre **{id}, {BotId}** e adicione sua ID do Microsoft App.\n1. Adicione sua url ngrok **em validDomains** excluindo https:// salvar.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/manifest.png\" alt-text=\"Manifesto.\":::\n\n1. Feche o conteúdo da pasta **Manifesto** **para criarmanifest.zip**.\n\n    > [!NOTE]\n    > O `manifest.zip` não deve conter pastas adicionais nele. Ele deve ter arquivo `manifest json` de origem, `color` ícone e `outline` ícone dentro da pasta zip.\n    > Upload seu manifesto em seu locatário de demonstração para organização ou sua conta Teams e execute sua solução em Visual Studio.\n\n1. Vá para Teams.\n1. Para carregar **manifest.zip**, selecione **Armazenar > Gerenciar** seus aplicativos > Upload um aplicativo personalizado e abramanifest.zipda pasta de repo no **** Explorador de arquivos.\n1. Selecione **Adicionar** para instalar o bot chamar no Teams.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/output.png\" alt-text=\"Adicionar Saída.\":::\n\n    Você pode interagir com esse bot após a depuração no Visual Studio.\n"
- title: Interação com o Bot de Chamada e Reunião
  durationInMinutes: 2
  content: >
    Bot permite que você acesse serviços e conteúdo em um espaço dedicado dentro de um canal ou em um chat.


    Siga as etapas para usar o bot:


    1. No painel esquerdo do Teams, selecione as releições *** e escolha seu aplicativo na lista.

    1. Bot enviará texto de boas-vindas com Cartão Adaptável, conforme mostrado abaixo.

        :::image type="content" source="./assets/images/calls-and-meetings/bot-with-adaptive-card.png" alt-text="Cartão adaptável no bot.":::

    1. Você pode pedir ao bot para Criar uma chamada.

        :::image type="content" source="./assets/images/calls-and-meetings/placed-call.png" alt-text="Chamada feita.":::

    1. Você pode solicitar que o bot transfira a chamada.

        :::image type="content" source="./assets/images/calls-and-meetings/transfer-call.png" alt-text="Transferir Chamada.":::

    1. Você pode solicitar que o bot agende uma reunião e convide os participantes.

        :::image type="content" source="./assets/images/calls-and-meetings/meeting.png" alt-text="Bot de reunião.":::
- title: Desafio completo
  durationInMinutes: 1
  content: >
    Você achou algo assim?


    ![Saída final](~/assets/images/calls-and-meetings/final-output.png)
- content: Você concluiu o tutorial para começar com a chamada de bot e o aplicativo de reunião para Microsoft Teams.
