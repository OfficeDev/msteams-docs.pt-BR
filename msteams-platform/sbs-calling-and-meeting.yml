### YamlMime:Tutorial
title: Teams bot de chamada e reunião
metadata:
  title: Teams bot com chamada e reunião
  description: Neste tutorial, você aprenderá a configurar chamadas e reuniões em um bot para Teams.
  audience: Developer
  level: Beginner
  ms.date: 02/08/2021
  ms.topic: interactive-tutorial
  nextTutorialHref: bots/calls-and-meetings/registering-calling-bot.md
  nextTutorialTitle: Registrar um bot de chamada
  ms.custom: mvc
  ms.localizationpriority: none
  ms.openlocfilehash: 1910a5472711528f48c073c4c4a1bbe20b892c6b
  ms.sourcegitcommit: 61003a14e8a179e1268bbdbd9cf5e904c5259566
  ms.translationtype: MT
  ms.contentlocale: pt-BR
  ms.lasthandoff: 04/09/2022
  ms.locfileid: "64736902"
items:
- durationInMinutes: 1
  content: >
    O bot de Chamada e Reunião fornece funcionalidades básicas, como criar uma chamada, ingressar em uma chamada, transferir ou redirecionar uma chamada, ingressar em uma reunião agendada e convidar os participantes integrando a API de comunicações na nuvem API do Graph.


    Os bots podem interagir com Teams e reuniões usando voz, vídeo e compartilhamento de tela em tempo real. Com as APIs do Microsoft Graph para chamadas e reuniões online, Teams aplicativos agora podem interagir com os usuários usando voz e vídeo para aprimorar a experiência. Essas APIs permitem que você adicione os seguintes novos recursos:


    * IVR (Resposta de Voz Interativa)

    * Controle de chamada

    * Acesso a fluxos de áudio e vídeo em tempo real, incluindo compartilhamento de aplicativos e área de trabalho


    Crie um bot e especifique algumas informações e permissões adicionais para usar essas APIs de Graph em um Teams aplicativo.


    Este guia passo a passo ajuda você a criar um bot com funcionalidade de chamada e reunião. Ao final deste tutorial, você poderá obter a seguinte saída:


    ![Saída final](~/assets/images/calls-and-meetings/final-output.png)
- title: Pré-requisitos
  durationInMinutes: 1
  content: "Instale as seguintes ferramentas e configure seu ambiente de desenvolvimento:  \n\n* [Office 365 locatário](https://developer.microsoft.com/microsoft-365/dev-program)\n* [Solução de túnel Ngrok](https://ngrok.com/) ou equivalente\n* [Visual Studio 2019](https://visualstudio.microsoft.com/downloads/)\n* [SDK do .NET Core](https://dotnet.microsoft.com/download) versão 3.1\n* Microsoft Teams com uma conta (não uma conta de convidado)\n* Instalar [Windows PowerShell](/microsoftteams/teams-powershell-install) executando todos os comandos\n"
- title: Configurar o Bot de Chamada e Reunião
  durationInMinutes: 5
  content: "Registre um aplicativo usando o registro de aplicativo no portal do Microsoft Azure para que seu aplicativo se integre ao plataforma de identidade da Microsoft e chame o Microsoft Graph. Execute o seguinte:\n\n1. Use o ngrok para criar um túnel para os pontos de extremidade do servidor Web.\n1. Crie um recurso de Bot do Azure para registrar o bot no Azure Serviço de Bot.\n1. Crie um segredo do cliente que habilite a autenticação de SSO do bot.\n1. Crie uma política para um usuário de locatário de demonstração para criar as reuniões online usando o PowerShell.\n1. Adicione permissões de API para chamadas downstream.\n1. Crie o registro de canal do Bot na conta do Azure.\n1. Adicione Microsoft Teams canal para implantar o bot em um Teams canal.\n1. Adicione o ponto de extremidade de mensagens ao túnel ngrok que você criou.\n\n**Crie um túnel ngrok:**\n\nUse o ngrok para criar um túnel para os pontos de extremidade HTTPS disponíveis publicamente do servidor Web em execução localmente. Execute o seguinte comando no ngrok:\n\n```bash\nngrok http -host-header=rewrite 3978\n```\n\n**Registrar um aplicativo no Azure:**\n\n1. Entre [no portal do Azure usando](https://portal.azure.com/) sua conta microsoft pessoal.\n1. Selecione o **Azure Active Directory** e selecione **Registros de aplicativo** no painel esquerdo e, em seguida, **selecione Novo registro**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/azure-active-directory.png\" alt-text=\"Azure Active Directory.\":::\n\n1. **A página Registrar um** aplicativo é aberta. Insira as informações de registro do aplicativo.\n1. Insira um nome **de aplicativo** significativo que é exibido para os usuários do aplicativo.\n1. Em **tipos de conta com suporte**, selecione as contas às quais você deseja que seu aplicativo seja compatível.\n1. No **campo URI** de Redirecionamento (opcional), selecione o tipo de cliente Web ou Público do aplicativo (área de trabalho móvel **&)** e insira o URI de redirecionamento para seu aplicativo.\n\n    > [!NOTE]\n    > Para aplicativos Web, forneça o URI base como `http://localhost:31544`. Para aplicativos cliente públicos, forneça o URI usado pelo Azure AD para retornar respostas de token como `myapp://auth`.\n\n1. Selecione **Registrar**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/reg-app.png\" alt-text=\"Registre um aplicativo.\":::\n\n**Para criar o segredo do cliente:**\n\n1. Na **página** Visão geral do bot, selecione **Essentials** e salve a **ID** do cliente do aplicativo (ID do aplicativo da Microsoft) para referência futura.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/microsoft-app-id-new.png\" alt-text=\"ID do Aplicativo da Microsoft.\":::\n\n1. Em **Gerenciar**, selecione **Certificados & segredos** , selecione **Segredos do** cliente e **selecione Novo segredo do cliente**. A **janela Adicionar um segredo do** cliente é exibida.  \n\n1. Insira **Descrição** e selecione **Adicionar**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/add-client.png\" alt-text=\"Adicionar segredo do cliente.\":::\n\n1. Na coluna **Valor** , selecione **Copiar para a área de transferência** e salve a ID do segredo do cliente para referência futura.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/client-secret.png\" alt-text=\"Valor.\":::\n\n**Execute o script do PowerShell para criar uma política:**\n\n1. Crie uma política para um usuário de locatário de demonstração para criar as reuniões online usando o seguinte script do PowerShell:\n\n    > [!NOTE]\n    > Execute Windows PowerShell PSI como administrador e execute o script.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/powershell-script.png\" alt-text=\"Script do PowerShell.\":::\n\n1. `azure-client-id` Substitua pela **ID do aplicativo Da Microsoft** do bot `object-id` e pela **ID** de Locatário da sua conta usada para fazer logon no Teams (copie o link conforme mostrado na imagem a seguir e você poderá encontrar a ID do locatário da sua conta do Teams no link obtido).\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/teams-link-new.png\" alt-text=\"Teams Link.\":::\n\n1. Adicione `PolicyName`, `azure-client-id`e `policy-description`no `object-id` script do PowerShell. Faça logon com sua Teams quando o PowerShell solicitar.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/powershell.png\" alt-text=\"Powershell.\":::\n\n1. Execute o comando a seguir no PowerShell para verificar se a política foi criada com êxito ou não. Substitua o nome da política pelo nome da política definida.\n\n    ```powershell\n    Get-CsApplicationAccessPolicy -Identity “<<policy-identity/policy-name>>”\n    ```\n\n**Para adicionar permissões de API para chamadas downstream:**\n\n> [!NOTE]\n> Certifique-se de que sua conta possa conceder consentimento do administrador para a Microsoft. Depois de adicionar permissões, selecione `Grant admin consent for Microsoft` para saber o status do consentimento.\n\n1. No **painel** Gerenciar do bot, selecione **permissões de API**.\n1. Selecione **Adicionar uma permissão**. **A janela Solicitar permissões de API** é exibida.\n1. Selecione **APIs da Microsoft** e selecione **Microsoft Graph**.\n1. Selecione **permissões de aplicativo e** , em seguida, selecione permissões.\n1. Adicione as permissões API do Graph aplicativos a seguir ao seu Azure App e conceda o consentimento do administrador.\n    * `Calls.AccessMedia.All`\n    * `Calls.Initiate.All`\n    * `Calls.InitiateGroupCall.All`\n    * `Calls.JoinGroupCall.All`\n    * `Calls.JoinGroupCallAsGuest.All`\n    * `OnlineMeetings.ReadWrite.All`\n1. Selecione **Adicionar permissões**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/add-api-permissions.png\" alt-text=\"Adicionar permissões de API.\":::\n\n**Crie o registro de canal do Bot na conta do Azure:**\n\n1. Abra [portal do Azure](https://portal.azure.com/).\n1. Selecione **Criar um recurso**.\n1. Pesquise **o Bot do Azure** na caixa de pesquisa.\n1. Selecione **o Bot do Azure**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/azure-bot-homepage.png\" alt-text=\"Cartão de bot do Azure.\":::\n\n1. Selecionar **Criar**.\n1. Insira o nome do identificador do **bot no campo identificador do** bot.\n1. Selecione sua **Assinatura** na lista suspensa.\n1. Selecione o **grupo de recursos** na lista suspensa.\n\n    Para criar um novo grupo de recursos, selecione **Criar, insira** o nome do recurso, selecione **OK** e selecione o local necessário  na lista suspensa Novo local do grupo de recursos.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/create-azure-bot.png\" alt-text=\"Criar Um Bot do Azure.\":::\n\n1. Selecione **o tipo de aplicativo** como **multilocatário** para **a ID do aplicativo da Microsoft**.\n\n    > [!NOTE]\n    > Na `Creation type` seção ID do Aplicativo da Microsoft, já `Create new Microsoft App ID` está selecionado para criar um bot. Você também pode selecionar `Use existing app registration`, se já tiver registrado um bot. Insira a ID do Aplicativo da `Existing app id` Microsoft no campo e insira o valor no `Existing app password` campo.\n\n1. Selecione **Usar o registro de aplicativo existente e** insira a **ID** do aplicativo e o segredo do aplicativo do Azure registrados no locatário de demonstração.\n1. Selecione **Examinar + criar**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/review-create.png\" alt-text=\"Multilocatário.\":::\n\n1. Se a validação for aprovada, selecione **Criar**.\n\n   Leva alguns instantes para que o serviço de bot seja provisionado.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/validation.png\" alt-text=\"Validação.\":::\n\n1. Selecione **Acessar recursos**. O bot e os recursos relacionados são listados no grupo de recursos.\n\n    Agora seu bot do Azure foi criado.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/go-to-resource.png\" alt-text=\"Ir para o recurso.\":::\n\n**Para adicionar o Microsoft Teams canal:**\n\n1. Vá para **Casa**.\n1. Abra o bot, que está listado na **seção Recursos** recentes.\n1. Selecione **Canais** no painel esquerdo e selecione **Microsoft Teams** <img src=\"~/assets/images/bots/teamsicon.png\" alt=\"Teams icon\" width=\"20\"/> na lista de canais disponíveis.    \n    \n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/channels-teams.png\" alt-text=\"Canais Teams.\":::\n\n1. Marque a caixa de seleção para aceitar os termos de serviço e selecione **Concordar**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/terms-of-service.png\" alt-text=\"Termos de serviço.\":::\n\n1. Selecione **Salvar**.\n1. Selecione **Microsoft Teams** e selecione **a guia Chamada** na Teams do canal.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/configure-teams.png\" alt-text=\"Configure Teams.\":::\n\n1. Selecione **Habilitar** chamada e, em seguida, atualize **o Webhook** com a URL do ngrok HTTPS (https://yourNgrok/api/callback) e adicione `/api/callback` no final.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/enable-calling.png\" alt-text=\"Habilitar chamada.\":::\n\n1. Selecione **Salvar**.\n\n**Para adicionar o ponto de extremidade de mensagens:**\n\n1. Vá para **a Home** page do bot e selecione **Configuração** **Configurações** no painel esquerdo.\n1. Vá para ngrok.\n1. Copie a URL HTTPS (https para io), conforme mostrado na imagem a seguir:\n    \n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/ngrok.png\" alt-text=\"O Ngrok.\":::\n\n1. No **ponto de extremidade mensagens**, adicione a URL HTTPS disponível no ngrok e, no final da URL, adicione **/api/messages**.\n    \n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/messaging-endpoint.png\" alt-text=\"Ponto de extremidade de mensagens.\":::\n\n1. Selecione **Aplicar**.\n\n    Você configurou com êxito um bot no Azure Serviço de Bot e agora precisa configurar a conexão de serviço de bot.\n"
- title: Atualizar e criar um pacote Teams aplicativo
  durationInMinutes: 1
  content: "Configure o exemplo de bot para entender como autenticar o bot de conversa no Microsoft Teams e criar o pacote de aplicativos do Teams e carregá-lo para a organização.\n\n1. Atualize appsettings.json no Visual Studio.\n1. Atualize manifest.json no Visual Studio e compacte-o no arquivo zip no Explorador de Arquivos.\n\n**Atualize appsettings para chamar o Bot:**\n\n1. Vá para o repositório https://github.com/OfficeDev/Microsoft-Teams-Samples.git.\n1. Selecione **Código** e selecione a lista suspensa.\n1. Selecione **Baixar ZIP**.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/repo-download.png\" alt-text=\"Download do repositório.\":::\n\n1. Observe o caminho do repositório baixado.\n1. No **Explorador de Arquivos,** vá para **a pasta Microsoft-Teams-Samples-mainsamplesbot-calling-meetingcsharp** > . >  > \n1. Abra o **arquivo appsettings.json** no Visual Studio atualize a configuração do bot.\n\n    * Você pode obter a partir `MicrosoftAppId` da página de configuração do bot. O `MicrosoftAppPassword` valor da ID de segredo do cliente que você salvou anteriormente.\n    * Você pode obter o `Tenant ID` ou `UserId` do link da conta usada para fazer logon no Teams. Siga o caminho na imagem para obter o link para `tenant id`.\n    \n        :::image type=\"content\" source=\"./assets/images/calls-and-meetings/teams-link-new.png\" alt-text=\"Teams Link.\":::\n    \n    * Você pode obter o `DisplayName` e do `UserId` [site do Microsoft Graph Explorer](https://developer.microsoft.com/graph/graph-explorer).\n        * Faça logon na página usando sua Teams e `Users` adicione ao final da URl na caixa de pesquisa e selecione **Executar consulta**.\n        * Nomes de exibição e IDs de usuário vinculados à sua conta são gerados.\n        * Escolha três contas e adicione-as ao `DisplayName` e `UserId` em appsettings.json.\n\n        :::image type=\"content\" source=\"./assets/images/calls-and-meetings/graph-explorer.png\" alt-text=\"Graph Explorer.\":::\n\n    > [!NOTE]\n    > `Tenant ID`ou `UserId` da Teams denota de onde você deseja iniciar a chamada e `DisplayName` `UserId` dos usuários indica para quem você deseja redirecionar ou transferir a chamada.\n\n1. Substitua`MicrosoftAppId`, `ClientId`pela `AppId` ID `MicrosoftAppPassword`**do aplicativo (cliente)** e pelo `ClientSecret``AppSecret` valor.\n1. Atualize `BotBaseUrl` com sua `ngrok` URL.\n1. Atualizar `Tenant ID` e `UserId`.\n1. Atualizar `DisplayName` e `UserId`.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/appsettings.png\" alt-text=\"Appsettings Json.\":::\n\n1. Selecione **Salvar**.\n\n**Para atualizar o manifesto:**\n\n1. No **Explorador de Arquivos,** vá para **a pasta Microsoft-Teams-Samples-mainsamplesbot-calling-meetingcsharpManifest** > . >  >  > \n1. Abra o arquivo `manifest.json` no Visual Studio.\n1. No arquivo `manifest.json` , **localize {id}, {BotId}** e adicione sua ID de Aplicativo da Microsoft.\n1. Adicione sua URL ngrok **em validDomains** excluindo https:// e salvar.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/manifest.png\" alt-text=\"Manifesto.\":::\n\n1. Compacte o conteúdo da pasta **Manifesto** a ser criada `manifest.zip`.\n\n    > [!NOTE]\n    > Ele `manifest.zip` não deve conter pastas adicionais. Ele deve ter o `manifest json` arquivo de origem, `color` o ícone e o `outline` ícone dentro da pasta zip.\n    > Upload manifesto em seu locatário de demonstração para a organização ou sua conta Teams e execute sua solução em Visual Studio.\n\n1. Vá para Teams.\n1. Para carregar`manifest.zip`, selecione **Armazenar > Gerenciar** seus aplicativos > Upload um `manifest.zip` aplicativo personalizado e abra na pasta do repositório no Explorador de Arquivos.\n1. Selecione **Adicionar** para instalar o bot de Chamada Teams.\n\n    :::image type=\"content\" source=\"./assets/images/calls-and-meetings/output.png\" alt-text=\"Adicionar Saída.\":::\n\n    Você pode interagir com esse bot após a depuração Visual Studio.\n"
- title: Interação com o Bot de Chamada e Reunião
  durationInMinutes: 2
  content: >
    O bot permite que você acesse serviços e conteúdo em um espaço dedicado dentro de um canal ou em um chat.


    Siga as etapas para usar o bot:


    1. No painel esquerdo do painel Teams, selecione as reticências  e escolha seu aplicativo na lista.

    1. O bot enviará texto de boas-vindas com Cartão Adaptável, conforme mostrado abaixo.

        :::image type="content" source="./assets/images/calls-and-meetings/bot-with-adaptive-card.png" alt-text="Cartão adaptável no bot.":::

    1. Você pode pedir ao bot para criar uma chamada.

        :::image type="content" source="./assets/images/calls-and-meetings/placed-call.png" alt-text="Chamada colocada.":::

    1. Você pode pedir ao bot para transferir a chamada.

        :::image type="content" source="./assets/images/calls-and-meetings/transfer-call.png" alt-text="Transferir Chamada.":::

    1. Você pode pedir ao bot para agendar uma reunião e convidar os participantes.

        :::image type="content" source="./assets/images/calls-and-meetings/meeting.png" alt-text="Bot de reunião.":::
- title: Desafio completo
  durationInMinutes: 1
  content: >
    Você conseguiu algo assim?


    ![Saída final](~/assets/images/calls-and-meetings/final-output.png)
- content: Você concluiu o tutorial para começar a usar a chamada de bot e o aplicativo de reunião para Microsoft Teams.
