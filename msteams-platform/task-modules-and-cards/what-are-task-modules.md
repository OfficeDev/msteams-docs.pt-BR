---
title: O que são os módulos de tarefas?
author: clearab
description: Adicionar experiências pop-up modais para coletar ou exibir informações aos usuários de seus Microsoft Teams aplicativos
localization_priority: Normal
ms.topic: overview
ms.author: anclear
ms.openlocfilehash: 7c047c02167e143cc8536c1dfcff3a335b18c46e
ms.sourcegitcommit: 20e623a82f9676dd036cf6a350dd480885e0ea2c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/10/2021
ms.locfileid: "52300560"
---
# <a name="what-are-task-modules"></a><span data-ttu-id="2e1da-103">O que são os módulos de tarefas?</span><span class="sxs-lookup"><span data-stu-id="2e1da-103">What are task modules?</span></span>

<span data-ttu-id="2e1da-104">Os módulos de tarefas permitem que você crie experiências pop-up modais em seu aplicativo Teams.</span><span class="sxs-lookup"><span data-stu-id="2e1da-104">Task modules allow you to create modal popup experiences in your Teams application.</span></span> <span data-ttu-id="2e1da-105">Dentro do pop-up, você pode executar seu próprio código HTML/JavaScript personalizado, mostrar um widget baseado como um vídeo do YouTube ou do Microsoft Stream ou exibir um `<iframe>` [cartão Adaptável](/adaptive-cards/).</span><span class="sxs-lookup"><span data-stu-id="2e1da-105">Inside the popup you can run your own custom HTML/JavaScript code, show an `<iframe>`-based widget such as a YouTube or Microsoft Stream video or display an [Adaptive card](/adaptive-cards/).</span></span> <span data-ttu-id="2e1da-106">Eles são especialmente úteis para iniciar e concluir tarefas ou exibir informações ricas, como vídeos ou Power BI painéis.</span><span class="sxs-lookup"><span data-stu-id="2e1da-106">They are especially useful for initiating and completing tasks or displaying rich information like videos or Power BI dashboards.</span></span> <span data-ttu-id="2e1da-107">Uma experiência pop-up geralmente é mais natural para usuários iniciando e concluindo tarefas em comparação com uma guia ou uma experiência de bot baseada em conversa.</span><span class="sxs-lookup"><span data-stu-id="2e1da-107">A popup experience is often more natural for users initiating and completing tasks compared to a tab or a conversation-based bot experience.</span></span>

<span data-ttu-id="2e1da-108">Os módulos de tarefas são construídos com base nas Microsoft Teams guias; eles são essencialmente uma guia dentro de uma janela pop-up.</span><span class="sxs-lookup"><span data-stu-id="2e1da-108">Task modules build on the foundation of Microsoft Teams tabs; they are essentially a tab inside a popup window.</span></span> <span data-ttu-id="2e1da-109">Eles usam o mesmo SDK, portanto, se você criou uma guia, já é 90% do caminho para poder criar um módulo de tarefa.</span><span class="sxs-lookup"><span data-stu-id="2e1da-109">They use the same SDK, so if you've built a tab you are already 90% of the way to being able to create a task module.</span></span>

<span data-ttu-id="2e1da-110">Módulos de tarefa podem ser invocados de três maneiras:</span><span class="sxs-lookup"><span data-stu-id="2e1da-110">Task modules can be invoked in three ways:</span></span>

* <span data-ttu-id="2e1da-111">**Guias de canal ou pessoal.**</span><span class="sxs-lookup"><span data-stu-id="2e1da-111">**Channel or personal tabs.**</span></span> <span data-ttu-id="2e1da-112">Usando o Microsoft Teams tabs SDK, você pode invocar módulos de tarefas de botões, links ou menus em sua guia. Isso é abordado [em detalhes aqui.](~/task-modules-and-cards/task-modules/task-modules-tabs.md)</span><span class="sxs-lookup"><span data-stu-id="2e1da-112">Using the Microsoft Teams Tabs SDK you can invoke task modules from buttons, links or menus on your tab. [This is covered in detail here.](~/task-modules-and-cards/task-modules/task-modules-tabs.md)</span></span>
* <span data-ttu-id="2e1da-113">**Bots.**</span><span class="sxs-lookup"><span data-stu-id="2e1da-113">**Bots.**</span></span> <span data-ttu-id="2e1da-114">Botões nos [cartões enviados](~/task-modules-and-cards/cards/cards-reference.md) do bot.</span><span class="sxs-lookup"><span data-stu-id="2e1da-114">Buttons on [cards](~/task-modules-and-cards/cards/cards-reference.md) sent from your bot.</span></span> <span data-ttu-id="2e1da-115">Isso é particularmente útil quando você não precisa de todos em um canal para ver o que está fazendo com um bot.</span><span class="sxs-lookup"><span data-stu-id="2e1da-115">This is particularly useful when you don't need everyone in a channel to see what you are doing with a bot.</span></span> <span data-ttu-id="2e1da-116">Por exemplo, ao fazer com que os usuários respondam a uma votação em um canal, não é útil ver um registro da votação que está sendo criada.</span><span class="sxs-lookup"><span data-stu-id="2e1da-116">For example, when having users respond to a poll in a channel it's not terribly useful to see a record of that poll being created.</span></span> [<span data-ttu-id="2e1da-117">Isso é abordado em detalhes aqui.</span><span class="sxs-lookup"><span data-stu-id="2e1da-117">This is covered in detail here.</span></span>](~/task-modules-and-cards/task-modules/task-modules-bots.md)
* <span data-ttu-id="2e1da-118">**Fora do Teams de um link profundo.**</span><span class="sxs-lookup"><span data-stu-id="2e1da-118">**Outside of Teams from a deep link.**</span></span> <span data-ttu-id="2e1da-119">Você também pode criar URLs para invocar um módulo de tarefa de qualquer lugar.</span><span class="sxs-lookup"><span data-stu-id="2e1da-119">You can also create URLs to invoke a task module from anywhere.</span></span> [<span data-ttu-id="2e1da-120">Isso é abordado em detalhes aqui.</span><span class="sxs-lookup"><span data-stu-id="2e1da-120">This is covered in detail here.</span></span>](#task-module-deep-link-syntax)

## <a name="what-a-task-module-looks-like"></a><span data-ttu-id="2e1da-121">Com a aparência de um módulo de tarefa</span><span class="sxs-lookup"><span data-stu-id="2e1da-121">What a task module looks like</span></span>

<span data-ttu-id="2e1da-122">Veja a aparência de um módulo de tarefa quando invocado de um bot (sem retângulos coloridos e círculos numerados, claro):</span><span class="sxs-lookup"><span data-stu-id="2e1da-122">Here's what a task module looks like when invoked from a bot (without the colored rectangles and numbered circles, of course):</span></span>

![Exemplo do Módulo de Tarefa](~/assets/images/task-module/task-module-example.png)

<span data-ttu-id="2e1da-124">Vamos passar por isso:</span><span class="sxs-lookup"><span data-stu-id="2e1da-124">Let's walk through it:</span></span>

1. <span data-ttu-id="2e1da-125">O ícone do seu [ `color` aplicativo](~/resources/schema/manifest-schema.md#icons).</span><span class="sxs-lookup"><span data-stu-id="2e1da-125">Your app's [`color` icon](~/resources/schema/manifest-schema.md#icons).</span></span>
2. <span data-ttu-id="2e1da-126">O nome do seu [ `short` aplicativo](~/resources/schema/manifest-schema.md#name).</span><span class="sxs-lookup"><span data-stu-id="2e1da-126">Your app's [`short` name](~/resources/schema/manifest-schema.md#name).</span></span>
3. <span data-ttu-id="2e1da-127">O título do módulo de tarefa especificado na `title` propriedade do [objeto TaskInfo](#the-taskinfo-object).</span><span class="sxs-lookup"><span data-stu-id="2e1da-127">The task module's title specified in the `title` property of the [TaskInfo object](#the-taskinfo-object).</span></span>
4. <span data-ttu-id="2e1da-128">O botão fechar/cancelar do módulo de tarefas.</span><span class="sxs-lookup"><span data-stu-id="2e1da-128">The task module's close/cancel button.</span></span> <span data-ttu-id="2e1da-129">Se o usuário pressionar isso, seu aplicativo receberá um `err` evento conforme descrito [aqui](~/task-modules-and-cards/task-modules/task-modules-tabs.md#example-submitting-the-result-of-a-task-module).</span><span class="sxs-lookup"><span data-stu-id="2e1da-129">If the user presses this, your app will receive an `err` event as described [here](~/task-modules-and-cards/task-modules/task-modules-tabs.md#example-submitting-the-result-of-a-task-module).</span></span> <span data-ttu-id="2e1da-130">(**Observação:** atualmente não é possível detectar esse evento quando um módulo de tarefa é invocado de um bot.)</span><span class="sxs-lookup"><span data-stu-id="2e1da-130">(**Note:** It is currently not possible to detect this event when a task module is invoked from a bot.)</span></span>
5. <span data-ttu-id="2e1da-131">O retângulo azul será o local em que sua página da Web será exibida se você estiver carregando sua própria página da Web usando a propriedade `url` [do objeto TaskInfo](#the-taskinfo-object).</span><span class="sxs-lookup"><span data-stu-id="2e1da-131">The blue rectangle is the where your web page appears if you are loading your own web page using the `url` property of the [TaskInfo object](#the-taskinfo-object).</span></span> <span data-ttu-id="2e1da-132">Mais detalhes estão na seção [de redação do módulo](#task-module-sizing) de tarefas abaixo.</span><span class="sxs-lookup"><span data-stu-id="2e1da-132">More detail is in the [task module sizing](#task-module-sizing) section below.</span></span>
6. <span data-ttu-id="2e1da-133">Se você estiver exibindo um cartão Adaptável por meio da propriedade do objeto TaskInfo, o preenchimento será adicionado para você, caso contrário, você precisará lidar `card` com isso por conta [própria](#task-module-css-for-htmljavascript-task-modules). [](#the-taskinfo-object)</span><span class="sxs-lookup"><span data-stu-id="2e1da-133">If you are displaying an Adaptive card via the `card` property of the [TaskInfo object](#the-taskinfo-object) the padding is added for you, otherwise you'll need to [handle this yourself](#task-module-css-for-htmljavascript-task-modules).</span></span>
7. <span data-ttu-id="2e1da-134">Os botões de cartão adaptáveis serão renderizar aqui.</span><span class="sxs-lookup"><span data-stu-id="2e1da-134">Adaptive card buttons will render here.</span></span> <span data-ttu-id="2e1da-135">Se você estiver usando sua própria página, deverá criar seus próprios botões.</span><span class="sxs-lookup"><span data-stu-id="2e1da-135">If you're using your own page you must create your own buttons.</span></span>

## <a name="overview-of-invoking-and-dismissing-task-modules"></a><span data-ttu-id="2e1da-136">Visão geral de invocar e descartar módulos de tarefa</span><span class="sxs-lookup"><span data-stu-id="2e1da-136">Overview of invoking and dismissing task modules</span></span>

<span data-ttu-id="2e1da-137">Os módulos de tarefa podem ser invocados de guias, bots ou links profundos e o que aparece em um pode ser HTML ou um cartão Adaptável, portanto, há muita flexibilidade em termos de como eles são invocados e como lidar com o resultado da interação de um usuário.</span><span class="sxs-lookup"><span data-stu-id="2e1da-137">Task modules can be invoked from tabs, bots or deep links and what appears in one can be either HTML or an Adaptive card, so there's a lot of flexibility in terms of how they are invoked and how to deal with the result of a user's interaction.</span></span> <span data-ttu-id="2e1da-138">A tabela abaixo resume como isso funciona:</span><span class="sxs-lookup"><span data-stu-id="2e1da-138">The table below summarizes how this works:</span></span>

| <span data-ttu-id="2e1da-139">**Invocado por meio de...**</span><span class="sxs-lookup"><span data-stu-id="2e1da-139">**Invoked via...**</span></span> | <span data-ttu-id="2e1da-140">**O módulo de tarefa é HTML/JavaScript**</span><span class="sxs-lookup"><span data-stu-id="2e1da-140">**Task module is HTML/JavaScript**</span></span> | <span data-ttu-id="2e1da-141">**Módulo de tarefa é cartão adaptável**</span><span class="sxs-lookup"><span data-stu-id="2e1da-141">**Task module is Adaptive card**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="2e1da-142">**JavaScript em uma guia**</span><span class="sxs-lookup"><span data-stu-id="2e1da-142">**JavaScript in a tab**</span></span> | <span data-ttu-id="2e1da-143">1. Use a função SDK Teams cliente com `tasks.startTask()` uma função de retorno de chamada `submitHandler(err, result)` opcional</span><span class="sxs-lookup"><span data-stu-id="2e1da-143">1. Use the Teams client SDK function `tasks.startTask()` with an optional `submitHandler(err, result)` callback function</span></span> <br/><br/> <span data-ttu-id="2e1da-144">2. No código do módulo de tarefas, quando o usuário terminar, chame a função Teams SDK com um `tasks.submitTask()` `result` objeto como parâmetro.</span><span class="sxs-lookup"><span data-stu-id="2e1da-144">2. In the task module code, when the user is finished, call the Teams SDK function `tasks.submitTask()` with a `result` object as a parameter.</span></span> <span data-ttu-id="2e1da-145">Se um `submitHandler` retorno de chamada foi especificado em , Teams chama como um `tasks.startTask()` `result` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="2e1da-145">If a `submitHandler` callback was specified in `tasks.startTask()`, Teams calls it with `result` as a parameter.</span></span><br/><br/> <span data-ttu-id="2e1da-146">3. Se houve um erro ao invocar , a `tasks.startTask()` função é chamada com uma cadeia de `submitHandler` `err` caracteres.</span><span class="sxs-lookup"><span data-stu-id="2e1da-146">3. If there was an error when invoking `tasks.startTask()`, the `submitHandler` function is called with an `err` string instead.</span></span> <br/><br/> <span data-ttu-id="2e1da-147">4. Você também pode especificar um ao chamar - nesse `completionBotId` caso é enviado para o `teams.startTask()` `result` bot.</span><span class="sxs-lookup"><span data-stu-id="2e1da-147">4. You can also specify a `completionBotId` when calling `teams.startTask()` - in that case `result` is sent to the bot instead.</span></span> | <span data-ttu-id="2e1da-148">1. Chame a função SDK do cliente Teams com um objeto TaskInfo e contenha o JSON para o cartão adaptável a ser mostrar no `tasks.startTask()` [](#the-taskinfo-object) `TaskInfo.card` pop-up do módulo de tarefas.</span><span class="sxs-lookup"><span data-stu-id="2e1da-148">1. Call the Teams client SDK function `tasks.startTask()` with a [TaskInfo object](#the-taskinfo-object) and `TaskInfo.card` containing the JSON for the Adaptive card to show in the task module popup.</span></span> <br/><br/> <span data-ttu-id="2e1da-149">2. Se um retorno de chamada foi especificado em , Teams chama-o com uma cadeia de caracteres se houver um erro ao invocar ou se o usuário fechar o `submitHandler` pop-up do módulo de tarefa usando o X na parte superior `tasks.startTask()` `err` `tasks.startTask()` direita.</span><span class="sxs-lookup"><span data-stu-id="2e1da-149">2. If a `submitHandler` callback was specified in `tasks.startTask()`, Teams calls it with an `err` string if there was an error when invoking `tasks.startTask()` or if the user closes the task module popup using the X at the upper right.</span></span> <br/><br/> <span data-ttu-id="2e1da-150">3. Se o usuário pressionar um botão Action.Submit, seu `data` objeto será retornado como o valor de `result` .</span><span class="sxs-lookup"><span data-stu-id="2e1da-150">3. If the user presses an Action.Submit button then its `data` object is returned as the value of `result`.</span></span> |
| <span data-ttu-id="2e1da-151">**Botão de cartão bot**</span><span class="sxs-lookup"><span data-stu-id="2e1da-151">**Bot card button**</span></span> | <span data-ttu-id="2e1da-152">1. Botões de cartão bot, dependendo do tipo de botão, podem invocar módulos de tarefa de duas maneiras: uma URL de link profundo ou enviando uma `task/fetch` mensagem.</span><span class="sxs-lookup"><span data-stu-id="2e1da-152">1. Bot card buttons, depending on the type of button, can invoke task modules in two ways: a deep link URL or by sending a `task/fetch` message.</span></span> <span data-ttu-id="2e1da-153">Confira abaixo como funcionam as URLs de link profundo.</span><span class="sxs-lookup"><span data-stu-id="2e1da-153">See below for how deep link URLs work.</span></span> <br/><br/> <span data-ttu-id="2e1da-154">2. Se a ação do botão for ( tipo de botão para cartões adaptáveis), um evento (um HTTP POST sob as cobertas) será enviado para o bot e o bot responderá ao POST com `type` `task/fetch` HTTP `Action.Submit` `task/fetch invoke` 200 e ao corpo da resposta contendo um wrapper ao redor do [objeto TaskInfo.](#the-taskinfo-object)</span><span class="sxs-lookup"><span data-stu-id="2e1da-154">2. If the button's action `type` is `task/fetch` (`Action.Submit` button type for Adaptive cards), a `task/fetch invoke` event (an HTTP POST under the covers) is sent to the bot, and the bot responds to the POST with HTTP 200 and the response body containing a wrapper around the [TaskInfo object](#the-taskinfo-object).</span></span> <span data-ttu-id="2e1da-155">Isso é explicado em detalhes ao [invocar um módulo de tarefa por meio de tarefa/busca.](~/task-modules-and-cards/task-modules/task-modules-bots.md#invoking-a-task-module-via-taskfetch)</span><span class="sxs-lookup"><span data-stu-id="2e1da-155">This is explained in detail in [invoking a task module via task/fetch](~/task-modules-and-cards/task-modules/task-modules-bots.md#invoking-a-task-module-via-taskfetch).</span></span><br/><br/> <span data-ttu-id="2e1da-156">3. Teams exibe o módulo de tarefa; quando o usuário for concluído, chame a função Teams SDK `tasks.submitTask()` com um objeto como `result` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="2e1da-156">3. Teams displays the task module; when the user is finished, call the Teams SDK function `tasks.submitTask()` with a `result` object as a parameter.</span></span> <br/><br/> <span data-ttu-id="2e1da-157">4. O bot recebe uma `task/submit invoke` mensagem que contém o `result` objeto.</span><span class="sxs-lookup"><span data-stu-id="2e1da-157">4. The bot receives a `task/submit invoke` message that contains the `result` object.</span></span> <span data-ttu-id="2e1da-158">Você tem três maneiras diferentes de responder à mensagem: fazendo nada (a tarefa concluída com êxito), exibindo uma mensagem para o usuário em uma janela pop-up ou invocando outra janela de módulo de tarefa (ou seja, criando uma experiência como `task/submit` assistente).</span><span class="sxs-lookup"><span data-stu-id="2e1da-158">You have three different ways to respond to the `task/submit` message: by doing nothing (the task completed successfully), by displaying a message to the user in a popup window, or by invoking another task module window (i.e. creating a wizard-like experience).</span></span> <span data-ttu-id="2e1da-159">Essas três opções são mais discutidas [na discussão detalhada sobre tarefa/envio.](~/task-modules-and-cards/task-modules/task-modules-bots.md#the-flexibility-of-tasksubmit)</span><span class="sxs-lookup"><span data-stu-id="2e1da-159">These three options are discussed more [in the detailed discussion on task/submit](~/task-modules-and-cards/task-modules/task-modules-bots.md#the-flexibility-of-tasksubmit).</span></span> | <span data-ttu-id="2e1da-160">1. Como botões em cartões da Estrutura de Bot, os botões em cartões adaptáveis suportam duas maneiras de invocar módulos de tarefa: URLs de link profundo com botões e usando `Action.openUrl` `task/fetch` `Action.Submit` botões.</span><span class="sxs-lookup"><span data-stu-id="2e1da-160">1. Like buttons on Bot Framework cards, buttons on Adaptive cards support two ways of invoking task modules: deep link URLs with `Action.openUrl` buttons, and via `task/fetch` using `Action.Submit` buttons.</span></span> <br/><br/> <span data-ttu-id="2e1da-161">2. Os módulos de tarefa com cartões adaptáveis funcionam de forma muito semelhante à ocorrência HTML/JavaScript (consulte à esquerda).</span><span class="sxs-lookup"><span data-stu-id="2e1da-161">2. Task modules with Adaptive cards work very similarly to the HTML/JavaScript case (see left).</span></span> <span data-ttu-id="2e1da-162">A principal diferença é que, como não há JavaScript quando você está usando cartões Adaptáveis, não há como chamar `tasks.submitTask()` .</span><span class="sxs-lookup"><span data-stu-id="2e1da-162">The major difference is that since there's no JavaScript when you're using Adaptive cards, there's no way to call `tasks.submitTask()`.</span></span> <span data-ttu-id="2e1da-163">Em vez disso, Teams o objeto de e retorna-o como a carga do `data` `Action.Submit` `task/submit` evento, conforme descrito [aqui](~/task-modules-and-cards/task-modules/task-modules-bots.md#the-flexibility-of-tasksubmit).</span><span class="sxs-lookup"><span data-stu-id="2e1da-163">Instead, Teams takes the `data` object from `Action.Submit` and returns it as the payload of in the `task/submit` event, as described [here](~/task-modules-and-cards/task-modules/task-modules-bots.md#the-flexibility-of-tasksubmit).</span></span> |
| <span data-ttu-id="2e1da-164">**URL de link profundo**</span><span class="sxs-lookup"><span data-stu-id="2e1da-164">**Deep link URL**</span></span> <br/>[<span data-ttu-id="2e1da-165">Sintaxe de URL</span><span class="sxs-lookup"><span data-stu-id="2e1da-165">URL syntax</span></span>](#task-module-deep-link-syntax) | <span data-ttu-id="2e1da-166">1. Teams invoca o módulo de tarefa; a URL que aparece dentro `<iframe>` do especificado no parâmetro do link `url` profundo.</span><span class="sxs-lookup"><span data-stu-id="2e1da-166">1. Teams invokes the task module; the URL that appears inside the `<iframe>` specified in the `url` parameter of the deep link.</span></span> <span data-ttu-id="2e1da-167">Não há `submitHandler` retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="2e1da-167">There is no `submitHandler` callback.</span></span> <br/><br/> <span data-ttu-id="2e1da-168">2. Dentro do JavaScript da página no módulo de tarefas, chame para fechar com um objeto como um parâmetro, o mesmo que ao invocá-lo de uma guia ou um botão de cartão `tasks.submitTask()` `result` de bot.</span><span class="sxs-lookup"><span data-stu-id="2e1da-168">2. Within the JavaScript of the page in the task module, call `tasks.submitTask()` to close it with a `result` object as a parameter, the same as when invoking it from a tab or a bot card button.</span></span> <span data-ttu-id="2e1da-169">No entanto, a lógica de conclusão é ligeiramente diferente.</span><span class="sxs-lookup"><span data-stu-id="2e1da-169">Completion logic is slightly different, however.</span></span> <span data-ttu-id="2e1da-170">Se sua lógica de conclusão reside no cliente (ou seja, se não houver bot), não há retorno de chamada, portanto, qualquer lógica de conclusão deve estar no código anterior à chamada `submitHandler` para `tasks.submitTask()` .</span><span class="sxs-lookup"><span data-stu-id="2e1da-170">If your completion logic resides on the client (i.e. if there is no bot) there is no `submitHandler` callback, so any completion logic must be in the code preceding the call to `tasks.submitTask()`.</span></span> <span data-ttu-id="2e1da-171">Os erros de invocação são relatados apenas por meio do console.</span><span class="sxs-lookup"><span data-stu-id="2e1da-171">Invocation errors are only reported via the console.</span></span> <span data-ttu-id="2e1da-172">Se você tiver um bot, poderá especificar um parâmetro no `completionBotId` link profundo para enviar o objeto por meio de um `result` `task/submit` evento.</span><span class="sxs-lookup"><span data-stu-id="2e1da-172">If you have a bot, then you can specify a `completionBotId` parameter in the deep link to send the `result` object via a `task/submit` event.</span></span> | <span data-ttu-id="2e1da-173">1. Teams invoca o módulo de tarefa; o corpo do cartão JSON do cartão Adaptável é especificado como um valor codificado por URL do parâmetro `card` do link profundo.</span><span class="sxs-lookup"><span data-stu-id="2e1da-173">1. Teams invokes the task module; the JSON card body of the Adaptive card is specified as a URL-encoded value of the `card` parameter of the deep link.</span></span> <br/><br/> <span data-ttu-id="2e1da-174">2. O usuário fecha o módulo de tarefa clicando no X no canto superior direito do módulo de tarefa ou pressionando `Action.Submit` um botão no cartão.</span><span class="sxs-lookup"><span data-stu-id="2e1da-174">2. The user closes the task module by clicking on the X at the upper right of the task module or by pressing an `Action.Submit` button on the card.</span></span> <span data-ttu-id="2e1da-175">Como não há para chamar, você deve ter um bot para enviar o valor dos campos `submitHandler` de cartão adaptáveis para.</span><span class="sxs-lookup"><span data-stu-id="2e1da-175">Since there is no `submitHandler` to call, you must have a bot to send the value of the Adaptive card fields to.</span></span> <span data-ttu-id="2e1da-176">Você usa o parâmetro no link profundo para especificar o bot para o qual `completionBotId` enviar os dados por meio de um `task/submit invoke` evento.</span><span class="sxs-lookup"><span data-stu-id="2e1da-176">You use the `completionBotId` parameter in the deep link to specify the bot to send the data to via a `task/submit invoke` event.</span></span> |

## <a name="the-taskinfo-object"></a><span data-ttu-id="2e1da-177">O objeto TaskInfo</span><span class="sxs-lookup"><span data-stu-id="2e1da-177">The TaskInfo object</span></span>

<span data-ttu-id="2e1da-178">O `TaskInfo` objeto contém os metadados de um módulo de tarefa.</span><span class="sxs-lookup"><span data-stu-id="2e1da-178">The `TaskInfo` object contains the metadata for a task module.</span></span> <span data-ttu-id="2e1da-179">A definição do objeto está abaixo.</span><span class="sxs-lookup"><span data-stu-id="2e1da-179">The object definition is below.</span></span> <span data-ttu-id="2e1da-180">Você **deve** definir `url` (para um iFrame incorporado) `card` ou (para um Cartão Adaptável).</span><span class="sxs-lookup"><span data-stu-id="2e1da-180">You **must** define either `url` (for an embedded iFrame) or `card` (for an Adaptive Card).</span></span>

| <span data-ttu-id="2e1da-181">Atributo</span><span class="sxs-lookup"><span data-stu-id="2e1da-181">Attribute</span></span> | <span data-ttu-id="2e1da-182">Tipo</span><span class="sxs-lookup"><span data-stu-id="2e1da-182">Type</span></span> | <span data-ttu-id="2e1da-183">Descrição</span><span class="sxs-lookup"><span data-stu-id="2e1da-183">Description</span></span> |
| --- | --- | --- |
| `title` | <span data-ttu-id="2e1da-184">string</span><span class="sxs-lookup"><span data-stu-id="2e1da-184">string</span></span> | <span data-ttu-id="2e1da-185">Aparece abaixo do nome do aplicativo e à direita do ícone do aplicativo</span><span class="sxs-lookup"><span data-stu-id="2e1da-185">Appears below the app name and to the right of the app icon</span></span> |
| `height` | <span data-ttu-id="2e1da-186">número ou cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="2e1da-186">number or string</span></span> | <span data-ttu-id="2e1da-187">Pode ser um número que representa a altura do módulo de tarefas em pixels `small` ou `medium` , ou `large` .</span><span class="sxs-lookup"><span data-stu-id="2e1da-187">This can be a number representing the task module's height in pixels, or `small`, `medium`, or `large`.</span></span> <span data-ttu-id="2e1da-188">[Confira abaixo como a altura e a largura são manipuladas.](#task-module-sizing)</span><span class="sxs-lookup"><span data-stu-id="2e1da-188">[See below for how height and width are handled](#task-module-sizing).</span></span> |
| `width` | <span data-ttu-id="2e1da-189">número ou cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="2e1da-189">number or string</span></span> | <span data-ttu-id="2e1da-190">Pode ser um número que representa a largura do módulo de tarefa em pixels `small` ou `medium` , ou `large` .</span><span class="sxs-lookup"><span data-stu-id="2e1da-190">This can be a number representing the task module's width in pixels, or `small`, `medium`, or `large`.</span></span> <span data-ttu-id="2e1da-191">[Confira abaixo como a altura e a largura são manipuladas.](#task-module-sizing)</span><span class="sxs-lookup"><span data-stu-id="2e1da-191">[See below for how height and width are handled](#task-module-sizing).</span></span> |
| `url` | <span data-ttu-id="2e1da-192">cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="2e1da-192">string</span></span> | <span data-ttu-id="2e1da-193">A URL da página carregada como um `<iframe>` dentro do módulo de tarefa.</span><span class="sxs-lookup"><span data-stu-id="2e1da-193">The URL of the page loaded as an `<iframe>` inside the task module.</span></span> <span data-ttu-id="2e1da-194">O domínio da URL deve estar na matriz [validDomains](~/resources/schema/manifest-schema.md#validdomains) do aplicativo no manifesto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="2e1da-194">The URL's domain must be in the app's [validDomains array](~/resources/schema/manifest-schema.md#validdomains) in your app's manifest.</span></span> |
| `card` | <span data-ttu-id="2e1da-195">Cartão adaptável ou um anexo de cartão de bot de cartão adaptável</span><span class="sxs-lookup"><span data-stu-id="2e1da-195">Adaptive card or an Adaptive card bot card attachment</span></span> | <span data-ttu-id="2e1da-196">O JSON do cartão Adaptável a ser exibido no módulo de tarefa.</span><span class="sxs-lookup"><span data-stu-id="2e1da-196">The JSON for the Adaptive card to appear in the task module.</span></span> <span data-ttu-id="2e1da-197">Se você estiver invocando de um bot, precisará usar o JSON de cartão adaptável em um objeto Bot `attachment` Framework.</span><span class="sxs-lookup"><span data-stu-id="2e1da-197">If you're invoking from a bot, you'll need to use the Adaptive card JSON in a Bot Framework `attachment` object.</span></span> <span data-ttu-id="2e1da-198">Em uma guia, você usará apenas um Cartão Adaptável.</span><span class="sxs-lookup"><span data-stu-id="2e1da-198">From a tab you'll use just an Adaptive Card.</span></span> [<span data-ttu-id="2e1da-199">Veja um exemplo.</span><span class="sxs-lookup"><span data-stu-id="2e1da-199">Here's an example.</span></span>](#adaptive-card-or-adaptive-card-bot-card-attachment) |
| `fallbackUrl` | <span data-ttu-id="2e1da-200">cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="2e1da-200">string</span></span> | <span data-ttu-id="2e1da-201">Se um cliente não suportar o recurso de módulo de tarefa, essa URL será aberta em uma guia do navegador.</span><span class="sxs-lookup"><span data-stu-id="2e1da-201">If a client does not support the task module feature, this URL is opened in a browser tab.</span></span> |
| `completionBotId` | <span data-ttu-id="2e1da-202">cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="2e1da-202">string</span></span> | <span data-ttu-id="2e1da-203">Especifica uma ID de aplicativo bot para enviar o resultado da interação do usuário com o módulo de tarefa para.</span><span class="sxs-lookup"><span data-stu-id="2e1da-203">Specifies a bot App ID to send the result of the user's interaction with the task module to.</span></span> <span data-ttu-id="2e1da-204">Se especificado, o bot receberá um `task/submit invoke` evento com um objeto JSON na carga de eventos.</span><span class="sxs-lookup"><span data-stu-id="2e1da-204">If specified, the bot will receive a `task/submit invoke` event with a JSON object in the event payload.</span></span> |

> [!NOTE]
> <span data-ttu-id="2e1da-205">O recurso de módulo de tarefa exige que os domínios de todas as URLs que você deseja carregar sejam incluídos na matriz no manifesto `validDomains` do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="2e1da-205">The task module feature requires that the domains of any URLs you want to load are included in the `validDomains` array in your app's manifest.</span></span>

## <a name="task-module-sizing"></a><span data-ttu-id="2e1da-206">Ressarção do módulo de tarefas</span><span class="sxs-lookup"><span data-stu-id="2e1da-206">Task module sizing</span></span>

<span data-ttu-id="2e1da-207">Usar inteiros para `TaskInfo.width` e `TaskInfo.height` definirá a altura e a largura em pixels.</span><span class="sxs-lookup"><span data-stu-id="2e1da-207">Using integers for `TaskInfo.width` and `TaskInfo.height` will set the height and width in pixels.</span></span> <span data-ttu-id="2e1da-208">No entanto, dependendo do tamanho da janela e da resolução da tela da equipe, eles serão reduzidos proporcionalmente, mantendo a taxa de proporção (largura/altura).</span><span class="sxs-lookup"><span data-stu-id="2e1da-208">However, depending on the size of the Team's window and screen resolution they will be reduced proportionally while maintaining the aspect ratio (width/height).</span></span>

<span data-ttu-id="2e1da-209">Se e são , ou o tamanho do retângulo vermelho na imagem acima é uma proporção do espaço `TaskInfo.width` `TaskInfo.height` `"small"` `"medium"` `"large"` disponível: 20%, 50%, 60% para e `width` 20%, 50%, 66% para `height` .</span><span class="sxs-lookup"><span data-stu-id="2e1da-209">If `TaskInfo.width` and `TaskInfo.height` are `"small"`, `"medium"` or `"large"` the size of the red rectangle in the picture above is a proportion of the available space: 20%, 50%, 60% for `width` and 20%, 50%, 66% for `height`.</span></span>

<span data-ttu-id="2e1da-210">Os módulos de tarefa invocados de uma guia podem ser resized dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="2e1da-210">Task modules invoked from a tab can be dynamically resized.</span></span> <span data-ttu-id="2e1da-211">Depois de chamar, você pode chamar onde as propriedades de altura e largura no objeto newSize estão em conformidade com `tasks.startTask()` `tasks.updateTask(newSize)` a especificação TaskInfo (ex.</span><span class="sxs-lookup"><span data-stu-id="2e1da-211">After calling `tasks.startTask()` you can call `tasks.updateTask(newSize)` where height and width properties on the newSize object conform to the TaskInfo spec (ex.</span></span> <span data-ttu-id="2e1da-212">`{ height: 'medium', width: 'medium' }`).</span><span class="sxs-lookup"><span data-stu-id="2e1da-212">`{ height: 'medium', width: 'medium' }`).</span></span>

## <a name="task-module-css-for-htmljavascript-task-modules"></a><span data-ttu-id="2e1da-213">Módulo de tarefas CSS para módulos de tarefa HTML/JavaScript</span><span class="sxs-lookup"><span data-stu-id="2e1da-213">Task module CSS for HTML/JavaScript task modules</span></span>

<span data-ttu-id="2e1da-214">Os módulos de tarefa baseados em HTML/JavaScript têm acesso a toda a área do módulo de tarefa abaixo do header.</span><span class="sxs-lookup"><span data-stu-id="2e1da-214">HTML/JavaScript-based task modules have access to the entire area of the task module below the header.</span></span> <span data-ttu-id="2e1da-215">Embora isso ofereça uma grande flexibilidade, se você quiser que o preenchimento em torno das bordas se alinhe com os elementos do header e evite barras de rolagem desnecessárias, você precisará fornecer o CSS correto.</span><span class="sxs-lookup"><span data-stu-id="2e1da-215">While that offers a great deal of flexibility, if you want padding around the edges to align with the header elements and avoid unnecessary scrollbars you'll need to provide the right CSS.</span></span> <span data-ttu-id="2e1da-216">Aqui estão alguns exemplos para alguns casos de uso.</span><span class="sxs-lookup"><span data-stu-id="2e1da-216">Here are some examples for a few use cases.</span></span>

### <a name="example-1---youtube-video"></a><span data-ttu-id="2e1da-217">Exemplo 1 - vídeo do YouTube</span><span class="sxs-lookup"><span data-stu-id="2e1da-217">Example 1 - YouTube video</span></span>

<span data-ttu-id="2e1da-218">O YouTube oferece a capacidade de inserir vídeos em páginas da Web.</span><span class="sxs-lookup"><span data-stu-id="2e1da-218">YouTube offers the ability to embed videos on web pages.</span></span> <span data-ttu-id="2e1da-219">Usando uma página da Web de stub simples, é fácil mostrar isso em um módulo de tarefa:</span><span class="sxs-lookup"><span data-stu-id="2e1da-219">Using a simple stub web page it's easy to show this in a task module:</span></span>

![Vídeo do YouTube](~/assets/images/task-module/youtube-example.png)

<span data-ttu-id="2e1da-221">Aqui está o HTML para esta página, sem o CSS:</span><span class="sxs-lookup"><span data-stu-id="2e1da-221">Here's the HTML for this page, without the CSS:</span></span>

```html
<!DOCTYPE html>
<html lang="en">
<head>
  ⋮
</head>
<body>
  <div id="embed-container">
    <iframe width="1000" height="700" src="https://www.youtube.com/embed/rd0Rd8w3FZ0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen=""></iframe>
  </div>
</body>
</html>
```

<span data-ttu-id="2e1da-222">O CSS tem esta aparência:</span><span class="sxs-lookup"><span data-stu-id="2e1da-222">The CSS looks like this:</span></span>

```css
#embed-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 95%;
    height: 95%;
    padding-left: 20px;
    padding-right: 20px;
    padding-top: 10px;
    padding-bottom: 10px;
    border-style: none;
}
```

### <a name="example-2---powerapp"></a><span data-ttu-id="2e1da-223">Exemplo 2 - PowerApp</span><span class="sxs-lookup"><span data-stu-id="2e1da-223">Example 2 - PowerApp</span></span>

<span data-ttu-id="2e1da-224">Você também pode usar a mesma abordagem para inserir um PowerApp.</span><span class="sxs-lookup"><span data-stu-id="2e1da-224">You can use the same approach to embed a PowerApp as well.</span></span> <span data-ttu-id="2e1da-225">Como a altura/largura de qualquer PowerApp individual é personalizável, talvez seja necessário ajustar a altura e a largura para alcançar a apresentação desejada.</span><span class="sxs-lookup"><span data-stu-id="2e1da-225">As the height/width of any individual PowerApp is customizable, you may need to adjust the height and width to achieve your desired presentation.</span></span>

![PowerApp de Gerenciamento de Ativos](~/assets/images/task-module/powerapp-example.png)

```html
<iframe width="720" height="520" src="https://web.powerapps.com/webplayer/iframeapp?source=iframe&screenColor=rgba(104,101,171,1)&appId=/providers/Microsoft.PowerApps/apps/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"></iframe>
```

<span data-ttu-id="2e1da-227">E o CSS é:</span><span class="sxs-lookup"><span data-stu-id="2e1da-227">And the CSS is:</span></span>

```css
#embed-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 94%;
    height: 95%;
    padding-left: 20px;
    padding-right: 20px;
    padding-top: 10px;
    padding-bottom: 10px;
    border-style: none;
}
```

## <a name="adaptive-card-or-adaptive-card-bot-card-attachment"></a><span data-ttu-id="2e1da-228">Cartão adaptável ou anexo de cartão bot adaptável</span><span class="sxs-lookup"><span data-stu-id="2e1da-228">Adaptive card or Adaptive card bot card attachment</span></span>

<span data-ttu-id="2e1da-229">Conforme mencionado acima, dependendo de como você está invocando seu, você precisará usar um cartão Adaptável ou um anexo de cartão de bot de cartão adaptável (que é apenas um cartão adaptável envolvido em um objeto `card` attachment).</span><span class="sxs-lookup"><span data-stu-id="2e1da-229">As we noted above, depending on how you're invoking your `card` you'll need to use either an Adaptive card, or an Adaptive card bot card attachment (which is just an Adaptive card wrapped in an attachment object).</span></span>

<span data-ttu-id="2e1da-230">Ao invocar de uma guia, você precisará usar um cartão adaptável.</span><span class="sxs-lookup"><span data-stu-id="2e1da-230">When you're invoking from a tab, you'll need to use an adaptive card.</span></span> <span data-ttu-id="2e1da-231">Veja um exemplo muito simples:</span><span class="sxs-lookup"><span data-stu-id="2e1da-231">Here's a very simple example:</span></span>

```json
{
    "type": "AdaptiveCard",
    "body": [
        {
            "type": "TextBlock",
            "text": "Here is a ninja cat:"
        },
        {
            "type": "Image",
            "url": "http://adaptivecards.io/content/cats/1.png",
            "size": "Medium"
        }
    ],
    "version": "1.0"
}
```

<span data-ttu-id="2e1da-232">Ao invocar de um bot, você precisará usar um anexo de cartão de bot de cartão adaptável, como no exemplo abaixo:</span><span class="sxs-lookup"><span data-stu-id="2e1da-232">When you're invoking from a bot you'll need to use an Adaptive card bot card attachment as in the example below:</span></span>

```json
{
    "contentType": "application/vnd.microsoft.card.adaptive",
    "content": {
        "type": "AdaptiveCard",
        "body": [
            {
                "type": "TextBlock",
                "text": "Here is a ninja cat:"
            },
            {
                "type": "Image",
                "url": "http://adaptivecards.io/content/cats/1.png",
                "size": "Medium"
            }
        ],
        "version": "1.0"
    }
}
```

<span data-ttu-id="2e1da-233">Você precisará lembrar se está invocando um módulo de tarefa contendo um cartão Adaptável de um bot ou de uma guia.</span><span class="sxs-lookup"><span data-stu-id="2e1da-233">You'll need to remember whether you are invoking a task module containing an Adaptive card from a bot or a tab.</span></span>

## <a name="task-module-deep-link-syntax"></a><span data-ttu-id="2e1da-234">Sintaxe de link profundo do módulo de tarefas</span><span class="sxs-lookup"><span data-stu-id="2e1da-234">Task module deep link syntax</span></span>

<span data-ttu-id="2e1da-235">Um link profundo do módulo de tarefas é apenas uma serialização do objeto [TaskInfo](#the-taskinfo-object) com duas outras informações e, opcionalmente, `APP_ID` o `BOT_APP_ID` :</span><span class="sxs-lookup"><span data-stu-id="2e1da-235">A task module deep link is just a serialization of the [TaskInfo object](#the-taskinfo-object) with two other pieces of information, `APP_ID` and optionally the `BOT_APP_ID`:</span></span>

`https://teams.microsoft.com/l/task/APP_ID?url=<TaskInfo.url>&height=<TaskInfo.height>&width=<TaskInfo.width>&title=<TaskInfo.title>&completionBotId=BOT_APP_ID`

`https://teams.microsoft.com/l/task/APP_ID?card=<TaskInfo.card>&height=<TaskInfo.height>&width=<TaskInfo.width>&title=<TaskInfo.title>&completionBotId=BOT_APP_ID`

<span data-ttu-id="2e1da-236">Consulte [o objeto TaskInfo](#the-taskinfo-object) para os tipos de dados e valores para `<TaskInfo.url>` , , , e `<TaskInfo.card>` `<TaskInfo.height>` `<TaskInfo.width>` `<TaskInfo.title>` .</span><span class="sxs-lookup"><span data-stu-id="2e1da-236">See [TaskInfo object](#the-taskinfo-object) for the data types and allowable values for `<TaskInfo.url>`, `<TaskInfo.card>`, `<TaskInfo.height>`, `<TaskInfo.width>`, and `<TaskInfo.title>`.</span></span>

> [!TIP]
> <span data-ttu-id="2e1da-237">Certifique-se de codificar a URL do link profundo, especialmente ao usar o `card` parâmetro (por [ `encodeURI()` ](https://www.w3schools.com/jsref/jsref_encodeURI.asp)exemplo, a função de JavaScript ).</span><span class="sxs-lookup"><span data-stu-id="2e1da-237">Be sure to URL encode the deep link, especially when using the `card` parameter (for example, JavaScript's [`encodeURI()` function](https://www.w3schools.com/jsref/jsref_encodeURI.asp)).</span></span>

<span data-ttu-id="2e1da-238">Aqui estão as informações sobre `APP_ID` `BOT_APP_ID` e:</span><span class="sxs-lookup"><span data-stu-id="2e1da-238">Here's the information on `APP_ID` and `BOT_APP_ID`:</span></span>

| <span data-ttu-id="2e1da-239">Valor</span><span class="sxs-lookup"><span data-stu-id="2e1da-239">Value</span></span> | <span data-ttu-id="2e1da-240">Tipo</span><span class="sxs-lookup"><span data-stu-id="2e1da-240">Type</span></span> | <span data-ttu-id="2e1da-241">Obrigatório?</span><span class="sxs-lookup"><span data-stu-id="2e1da-241">Required?</span></span> | <span data-ttu-id="2e1da-242">Descrição</span><span class="sxs-lookup"><span data-stu-id="2e1da-242">Description</span></span> |
| --- | --- | --- | --- |
| `APP_ID` | <span data-ttu-id="2e1da-243">string</span><span class="sxs-lookup"><span data-stu-id="2e1da-243">string</span></span> | <span data-ttu-id="2e1da-244">Sim</span><span class="sxs-lookup"><span data-stu-id="2e1da-244">Yes</span></span> | <span data-ttu-id="2e1da-245">A [id](~/resources/schema/manifest-schema.md#id) do aplicativo invocando o módulo de tarefa.</span><span class="sxs-lookup"><span data-stu-id="2e1da-245">The [id](~/resources/schema/manifest-schema.md#id) of the app invoking the task module.</span></span> <span data-ttu-id="2e1da-246">A [matriz validDomains](~/resources/schema/manifest-schema.md#validdomains) no manifesto deve `APP_ID` conter o domínio para se estiver na `url` `url` URL.</span><span class="sxs-lookup"><span data-stu-id="2e1da-246">The [validDomains array](~/resources/schema/manifest-schema.md#validdomains) in the manifest for `APP_ID` must contain the domain for `url` if `url` is in the URL.</span></span> <span data-ttu-id="2e1da-247">(A ID do aplicativo já é conhecida quando um módulo de tarefa é invocado de uma guia ou um bot, por isso ele não está incluído em `TaskInfo` .)</span><span class="sxs-lookup"><span data-stu-id="2e1da-247">(The app ID is already known when a task module is invoked from a tab or a bot, which is why it's not included in `TaskInfo`.)</span></span> |
| `BOT_APP_ID` | <span data-ttu-id="2e1da-248">string</span><span class="sxs-lookup"><span data-stu-id="2e1da-248">string</span></span> | <span data-ttu-id="2e1da-249">Não</span><span class="sxs-lookup"><span data-stu-id="2e1da-249">No</span></span> | <span data-ttu-id="2e1da-250">Se um valor for especificado, o objeto será enviado por meio de uma `completionBotId` mensagem para o bot `result` `task/submit invoke` especificado.</span><span class="sxs-lookup"><span data-stu-id="2e1da-250">If a value for `completionBotId` is specified, the `result` object is sent via a a `task/submit invoke` message to the specified bot.</span></span> <span data-ttu-id="2e1da-251">`BOT_APP_ID` deve ser especificado como um bot no manifesto do aplicativo, ou seja, você não pode simplesmente enviá-lo para qualquer bot.</span><span class="sxs-lookup"><span data-stu-id="2e1da-251">`BOT_APP_ID` must be specified as a bot in the app's manifest, i.e. you can't just send it to any bot.</span></span> |

<span data-ttu-id="2e1da-252">Observe que ele é válido para e para ser o mesmo e, em muitos casos, será se um aplicativo tiver um bot, pois é recomendável usá-lo como ID de um aplicativo se houver `APP_ID` `BOT_APP_ID` um.</span><span class="sxs-lookup"><span data-stu-id="2e1da-252">Note that it's valid for `APP_ID` and `BOT_APP_ID` to be the same, and in many cases will be if an app has a bot since it's recommended to use that as an app's ID if there is one.</span></span>

## <a name="keyboard-and-accessibility-guidelines"></a><span data-ttu-id="2e1da-253">Diretrizes de teclado e acessibilidade</span><span class="sxs-lookup"><span data-stu-id="2e1da-253">Keyboard and accessibility guidelines</span></span>

<span data-ttu-id="2e1da-254">Com módulos de tarefa baseados em HTML/JavaScript, é sua responsabilidade garantir que o módulo de tarefas do aplicativo possa ser usado com um teclado.</span><span class="sxs-lookup"><span data-stu-id="2e1da-254">With HTML/JavaScript-based task modules it is your responsibility to ensure your app's task module can be used with a keyboard.</span></span> <span data-ttu-id="2e1da-255">Os programas de leitor de tela também dependem da capacidade de navegar usando o teclado.</span><span class="sxs-lookup"><span data-stu-id="2e1da-255">Screen reader programs also depend on the ability to navigate using the keyboard.</span></span> <span data-ttu-id="2e1da-256">Por uma questão prática, isso significa duas coisas:</span><span class="sxs-lookup"><span data-stu-id="2e1da-256">As a practical matter this means two things:</span></span>

1. <span data-ttu-id="2e1da-257">Usando o [atributo tabindex](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex) em suas marcas HTML para controlar quais elementos podem ser focalizados e se/onde ele participa da navegação sequencial do teclado (geralmente com as teclas <kbd>Tab</kbd> e <kbd>Shift-Tab).</kbd></span><span class="sxs-lookup"><span data-stu-id="2e1da-257">Using the [tabindex attribute](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex) in your HTML tags to control which elements can be focused and if/where it participates in sequential keyboard navigation (usually with the <kbd>Tab</kbd> and <kbd>Shift-Tab</kbd> keys).</span></span>
2. <span data-ttu-id="2e1da-258">Manipulando <kbd>a chave Esc</kbd> no JavaScript para o módulo de tarefas.</span><span class="sxs-lookup"><span data-stu-id="2e1da-258">Handling the <kbd>Esc</kbd> key in the JavaScript for your task module.</span></span> <span data-ttu-id="2e1da-259">Aqui está um exemplo de código mostrando como fazer isso:</span><span class="sxs-lookup"><span data-stu-id="2e1da-259">Here's a code sample showing how to do this:</span></span>

  ```javascript
  // Handle the Esc key
  document.onkeyup = function(event) {
  if ((event.key === 27) || (event.key === "Escape")) {
    microsoftTeams.submitTask(null); // this will return an err object to the completionHandler()
    }
  }
  ```

<span data-ttu-id="2e1da-260">Microsoft Teams garantirá que a navegação do teclado funcione corretamente do header do módulo de tarefas para o HTML e vice-versa.</span><span class="sxs-lookup"><span data-stu-id="2e1da-260">Microsoft Teams will ensure that keyboard navigation works properly from the task module header into your HTML and vice-versa.</span></span>

## <a name="code-sample"></a><span data-ttu-id="2e1da-261">Exemplo de código</span><span class="sxs-lookup"><span data-stu-id="2e1da-261">Code sample</span></span>
|<span data-ttu-id="2e1da-262">**Exemplo de nome**</span><span class="sxs-lookup"><span data-stu-id="2e1da-262">**Sample name**</span></span> | <span data-ttu-id="2e1da-263">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="2e1da-263">**Description**</span></span> | <span data-ttu-id="2e1da-264">**.NET**</span><span class="sxs-lookup"><span data-stu-id="2e1da-264">**.NET**</span></span> | <span data-ttu-id="2e1da-265">**Node.js**</span><span class="sxs-lookup"><span data-stu-id="2e1da-265">**Node.js**</span></span>|
|----------------|-----------------|--------------|----------------|
|<span data-ttu-id="2e1da-266">Exemplo de módulo de tarefa (Bots-V4)</span><span class="sxs-lookup"><span data-stu-id="2e1da-266">Task module sample (Bots-V4)</span></span> | <span data-ttu-id="2e1da-267">Exemplos para a criação de módulos de tarefa.</span><span class="sxs-lookup"><span data-stu-id="2e1da-267">Samples for creating task modules.</span></span> |[<span data-ttu-id="2e1da-268">View</span><span class="sxs-lookup"><span data-stu-id="2e1da-268">View</span></span>](https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/app-task-module/csharp)|[<span data-ttu-id="2e1da-269">View</span><span class="sxs-lookup"><span data-stu-id="2e1da-269">View</span></span>](https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/app-task-module/nodejs)| 
|<span data-ttu-id="2e1da-270">Exemplo de módulo de tarefa (Guias + Bots-V3)</span><span class="sxs-lookup"><span data-stu-id="2e1da-270">Task module sample (Tabs + Bots-V3)</span></span> | <span data-ttu-id="2e1da-271">Exemplos para a criação de módulos de tarefa.</span><span class="sxs-lookup"><span data-stu-id="2e1da-271">Samples for creating task modules.</span></span> |[<span data-ttu-id="2e1da-272">View</span><span class="sxs-lookup"><span data-stu-id="2e1da-272">View</span></span>](https://github.com/microsoft/BotBuilder-Samples/tree/main/samples/csharp_dotnetcore/54.teams-task-module)|[<span data-ttu-id="2e1da-273">View</span><span class="sxs-lookup"><span data-stu-id="2e1da-273">View</span></span>](https://github.com/microsoft/BotBuilder-Samples/tree/main/samples/javascript_nodejs/54.teams-task-module)|



> [!div class="nextstepaction"]
> [<span data-ttu-id="2e1da-274">Saiba mais: Solicitar permissões de dispositivo</span><span class="sxs-lookup"><span data-stu-id="2e1da-274">Learn  more: Request device permissions</span></span>](../concepts/device-capabilities/native-device-permissions.md)

> [!div class="nextstepaction"]
> [<span data-ttu-id="2e1da-275">Saiba mais: Integrar recursos de mídia</span><span class="sxs-lookup"><span data-stu-id="2e1da-275">Learn more: Integrate media capabilities</span></span>](../concepts/device-capabilities/mobile-camera-image-permissions.md)

> [!div class="nextstepaction"]
> [<span data-ttu-id="2e1da-276">Saiba mais: Integrar a QR ou o recurso de scanner de código de barras Teams</span><span class="sxs-lookup"><span data-stu-id="2e1da-276">Learn more: Integrate QR or barcode scanner capability in Teams</span></span>](../concepts/device-capabilities/qr-barcode-scanner-capability.md)

> [!div class="nextstepaction"]
> [<span data-ttu-id="2e1da-277">Saiba mais: Integrar recursos de localização Teams</span><span class="sxs-lookup"><span data-stu-id="2e1da-277">Learn more: Integrate location capabilities in Teams</span></span>](../concepts/device-capabilities/location-capability.md)
