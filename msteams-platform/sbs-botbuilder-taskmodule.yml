### YamlMime:Tutorial
title: Invocar módulos de tarefa do Microsoft Teams
metadata:
  title: Invocar módulos de tarefa do Microsoft Teams
  description: Com este módulo de aprendizado, saiba como configurar o módulo de tarefas do Teams usando Cartões Adaptáveis ou cartões do Bot Framework.
  audience: Developer
  level: Beginner
  ms.date: 23/02/2022
  ms.topic: interactive-tutorial
  nextTutorialHref: task-modules-and-cards/task-modules/task-modules-bots.md
  nextTutorialTitle: Leia mais sobre módulos de tarefas de bots
  ms.custom: mvc
  ms.localizationpriority: High
  ms.openlocfilehash: 784e4efdfa0754d58a34d4bbef807efd6e5af590
  ms.sourcegitcommit: ac59d469b823b80e65ee6f7be11ec5c365977a1c
  ms.translationtype: MT
  ms.contentlocale: pt-BR
  ms.lasthandoff: 10/06/2022
  ms.locfileid: "68491578"
items:
- durationInMinutes: 1
  content: >
    Você pode invocar módulos de tarefas de bots do Teams usando Cartões Adaptáveis ou cartões do Bot Framework.


    **Principais recursos dos módulos de tarefa:**


    * Aprimora a experiência do usuário evitando várias etapas.

    * Ajude os usuários a controlar o estado do bot.

    * Recupere a entrada do usuário e exiba o conteúdo da página da Web personalizado.


    Este guia passo a passo ajuda você a criar um bot do Azure de exemplo para invocar o módulo de tarefa do Teams. Você verá a seguinte saída:

     ![Módulo de tarefa](~/assets/images/Teams-task-module/final_image.png)
- title: Pré-requisitos
  durationInMinutes: 1
  content: "Instale as seguintes ferramentas e configure seu ambiente de desenvolvimento: \n\n | &nbsp; | Instalar | Para usar... |\n | --- | --- | --- |\n | **Required** | &nbsp; | &nbsp; |\n | &nbsp; | [Microsoft Teams](https://www.microsoft.com/microsoft-teams/download-app) | Microsoft Teams para colaborar com todas as pessoas com quem você trabalha por meio de aplicativos para chat, reuniões, chamadas e tudo em um só lugar.|\n | &nbsp; | [Visual Studio 2022 versão 17.3](https://visualstudio.microsoft.com)<br> Instale uma das duas cargas de trabalho a seguir:<br> • **ASP.NET desenvolvimento para a Web** <br> • **Desenvolvimento multiplataforma do .NET Core** | Você pode instalar a versão corporativa no Visual Studio 2022 e instalar as cargas de trabalho. |\n | &nbsp; | [SDK do .NET Core versão 3.1](https://dotnet.microsoft.com/en-us/download) | Associações personalizadas para depuração local e implantações Azure Functions aplicativo. Se você não tiver instalado o SDK do .NET 3.1 (ou posterior) globalmente, a versão portátil poderá ser instalada. |\n | &nbsp; | [ngrok](https://ngrok.com/download) | Os recursos do aplicativo Teams (bots de conversa, extensões de mensagem e webhooks de entrada) exigem conexões de entrada. Um túnel conecta seu sistema de desenvolvimento ao Teams. Ele não é necessário para aplicativos que incluem apenas guias. Esse pacote é instalado no diretório do projeto (usando npm `devDependencies`). |\n\n  > [!NOTE]\n  > Depois de baixar o ngrok, inscreva-se e instale [o authtoken](https://ngrok.com/download).\n"
- title: Configurar o ambiente local
  durationInMinutes: 1
  content: "Clone `BotBuilder-Samples` o repositório para o GitHub local:  \n\n 1. Abra [exemplos do BotBuilder](https://github.com/microsoft/BotBuilder-Samples).\n 1. Selecione **Código**.\n 1. Selecione **Abrir com o GitHub Desktop** no menu suspenso.\n\n    :::image type=\"content\" source=\"~/assets/images/Teams-task-module/clonerepository_1.png\" alt-text=\"Clonar repositório\":::\n\n 1. Selecione **Clonar**. \n"
- title: Criar e registrar seu bot no Azure AD portal
  durationInMinutes: 5
  content: "Para criar e registrar seu bot no Microsoft Azure Active Directory (Azure AD), execute as seguintes etapas:\n\n* Crie um recurso de Bot do Azure para registrar o bot no Azure Serviço de Bot.\n* Crie a ID do segredo do cliente e os detalhes do valor para habilitar a autenticação de SSO do bot.\n* Adicione o canal do Teams para implantar o bot em um canal do Teams.\n* Use o ngrok para criar um túnel para os pontos de extremidade do servidor Web.\n* Adicione o ponto de extremidade de mensagens ao túnel ngrok que você criou.\n\n**Para criar um recurso de Bot do Azure**\n\n1. Vá para o [Microsoft portal do Azure](https://portal.azure.com/).\n1. Selecione **Criar um recurso**.\n1. Na caixa de pesquisa, insira o **Bot do Azure**.\n1. Selecione **Enter**.\n1. Selecione **o Bot do Azure**.\n\n     :::image type=\"content\" source=\"./assets/images/Teams-task-module/azure-bot_1.png\" alt-text=\"Bot do Azure.\":::\n\n1. Selecionar **Criar**.\n1. Insira o nome do identificador do bot necessário no **identificador do Bot**.\n1. Selecione sua **assinatura e** **grupo de recursos** na lista suspensa.\n    \n    :::image type=\"content\" source=\"~/assets/images/Teams-task-module/review-plus-create_2.png\" alt-text=\"Selecionar o recurso do bot do Azure\"::: \n\n   Para criar um novo grupo de recursos, selecione **Criar >** insira o nome do recurso > selecione **OK**. Selecione o local necessário na lista **suspensa Novo local do** grupo de recursos.\n   \n    ![Novo local do grupo de recursos](~/assets/images/bots/newresource.png)\n\n1. Selecione **MultiLocatário em** Tipo de Bot.\n\n1. Na seção **ID do Aplicativo da Microsoft** , por padrão **, a opção Criar nova ID de Aplicativo da Microsoft** está selecionada. \n\n   Você também pode selecionar **Usar o registro de** aplicativo existente e inserir **a ID** do aplicativo, a **ID** do locatário do aplicativo e a **ID do recurso MSI**.\n\n   > [!NOTE]\n   > Não é possível criar mais de um bot com a mesma **ID do Aplicativo da Microsoft**.\n\n1. Selecione **Rever + criar**.\n\n    ![ID de Aplicativo da Microsoft](~/assets/images/Teams-task-module/multi-tenant-option.png)\n\n1. Depois que a validação for aprovada, selecione **Criar**. \n\n    Levará alguns minutos para o serviço de bot ser provisionado. \n\n1. Selecione **Vá para o recurso**. \n\n    ![Implantar aplicativo](~/assets/images/Teams-task-module/bot-deployment_1.png)\n\n    Seu bot do Azure é criado.\n\n    ![Recurso de bot do Azure criado](~/assets/images/Teams-task-module/bot-page_1.png)\n\n**Para criar o segredo do cliente**\n\n  Execute as seguintes etapas, se você tiver criado uma nova **ID de Aplicativo da Microsoft**:\n\n1. No painel esquerdo, selecione **Configuração**. \n\n   > [!TIP]\n   > Salve a **ID do Aplicativo da Microsoft** ou **a ID do Cliente** para referência futura.\n\n    ![ID da Microsoft criada](~/assets/images/Teams-task-module/manage.png)\n\n1. Ao lado da **ID do Aplicativo da Microsoft**, selecione **Gerenciar**.\n\n1. Na seção **Segredos do cliente** , selecione **Novo segredo do cliente**. \n\n    :::image type=\"content\" source=\"~/assets/images/meetings-side-panel/newclientsecret_1.png\" alt-text=\"Novo segredo do cliente\":::\n\n   A **janela Adicionar um segredo do** cliente é exibida.  \n\n1. Insira **Descrição**.\n\n1. Selecione **Adicionar**.\n\n    :::image type=\"content\" source=\"~/assets/images/Teams-task-module/clientsecret_1.png\" alt-text=\"Adicionar segredo do cliente ao aplicativo\":::\n\n1. Na coluna **Valor** , selecione copiar para o ícone da área de transferência para copiar detalhes do valor.\n\n     :::image type=\"content\" source=\"~/assets/images/Teams-task-module/clientvalue_1.png\" alt-text=\"Valor do segredo do cliente\":::\n   \n   > [!TIP]\n   > Salve o **valor de segredos do** cliente ou a senha do aplicativo para referência futura.\n\n**Para adicionar o canal do Teams**\n\n1. Selecione **Início**.\n\n    ![Página inicial](~/assets/images/Teams-task-module/gotohome_1.png)\n\n1. Selecione seu bot de **recursos recentes**.\n\n1. Selecione **Canais** no painel esquerdo e selecione **Microsoft Teams** <img src=\"~/assets/images/bots/teamsicon.png\" alt=\"Teams icon\" width=\"20\"/>.\n\n     :::image type=\"content\" source=\"~/assets/images/adaptive-cards/channel-teams.png\" alt-text=\"Selecionar o Teams em canais\":::\n     \n1. Marque a caixa de seleção para aceitar os **Termos de Serviço**.\n\n1. Selecione **Concordar**.\n\n      ![Termos de serviço](~/assets/images/Teams-task-module/terms_1.png)\n\n1. Selecione **Salvar**.\n\n      ![Selecione Teams](~/assets/images/Teams-task-module/configteams_1.png)  \n\n**Para criar um túnel para o servidor Web local**\n\nUse o ngrok para criar um túnel para os pontos de extremidade HTTPS disponíveis publicamente do servidor Web em execução localmente. Execute o seguinte comando no ngrok:\n\n ```bash\n ngrok http --host-header=rewrite 3978\n ```\n\n> [!TIP]\n> Se você encontrar **ERR_NGROK_4018**, siga as etapas fornecidas no prompt de comando para inscrever-se e autenticar o ngrok. Em seguida, execute o `ngrok http --host-header=localhost 3978` comando.\n\n**Para adicionar o ponto de extremidade de mensagens**\n\n1. No ngrok, copie a URL HTTPS.\n\n   :::image type=\"content\" source=\"../msteams-platform/assets/images/ngrok-url.png\" alt-text=\"URL HTTPS do ngrok\":::\n\n    > [!NOTE]\n    > A URL HTTPS em seu ngrok é seu nome de domínio totalmente qualificado.\n    > É `WebAppDomain` um nome de domínio totalmente qualificado que não inclui `https://` nele.\n\n1. Em **Configurações** do bot do Azure que você criou, selecione **Configuração**.\n\n1. No **ponto de extremidade de Mensagens**, use a URL HTTPS disponível no ngrok e, no final da URL, adicione **/api/messages**.\n\n    ![Ponto de extremidade de mensagens](~/assets/images/Teams-task-module/messaging-endpoint_1.png)\n\n1. Selecione **Aplicar**.\n\n    Você configurou com êxito um bot no Azure Serviço de Bot.\n"
- title: Atualizar o registro Azure AD aplicativo
  durationInMinutes: 1
  content: "1. Acesse o [Portal do Azure](https://portal.azure.com/).\n\n1. Selecione **Azure Active Directory**.\n\n1. No painel esquerdo, selecione Registros **de Aplicativo**.\n\n1. Selecione seu bot.\n\n   ![Registro do aplicativo](~/assets/images/Teams-task-module/appregister_1.png)\n\n1. Selecione **Expor uma API**.\n\n1. Selecione **Definir**.\n\n   ![Expor uma API](~/assets/images/Teams-task-module/exposeanapi_1.png)\n\n1. Defina **o URI da ID do** Aplicativo na forma de `api://your ngrok/{AppID}`.\n\n   ![Definir link](~/assets/images/Teams-task-module/setlink_1.png)\n\n    > [!NOTE]\n    > Se você estiver usando um serviço de túnel, como o ngrok, atualize o valor sempre que o subdomínio ngrok for alterado.\n    > `For example: api://f631****.ngrok.io/92c11075-c629-4a1e-ab58-02b4fd4204c2`, onde está `f631****.ngrok.io` o novo nome do subdomínio ngrok.\n\n1. Selecione **Adicionar um escopo**. \n\n   :::image type=\"content\" source=\"~/assets/images/meetings-side-panel/selectscope_1.png\" alt-text=\"Selecionar escopo\":::\n\n   A **janela Adicionar um escopo** é exibida.\n\n1. Insira os seguintes detalhes para configurar o escopo:\n\n    1. Insira `access_as_user` como o **nome do escopo**.\n\n    1. Definir **Quem pode consentir?** para `Admins and users`.\n\n1. Para configurar os prompts de consentimento do administrador e do usuário com os valores apropriados para `access_as_user` o escopo, forneça as seguintes informações nos campos:</br>\n\n     * Insira `Teams can access the user’s profile` como Administração **de exibição de consentimento**.\n\n     * Insira `Allows Teams to call the app’s web APIs as the current user` como Administração **de consentimento**.\n\n     * Insira como `Teams can access the user profile and make requests on the user’s behalf` nome **de exibição de consentimento do usuário**.\n\n     * Insira como `Enable Teams to call this app’s APIs with the same rights as the user` **descrição de consentimento do usuário**.\n\n1. Verifique se o **Estado** está definido como **Habilitado**.\n\n1. Selecione **Adicionar escopo** para salvar.\n\n    :::image type=\"content\" source=\"~/assets/images/Teams-task-module/addascope_1.png\" alt-text=\"Adicionar um escopo\":::\n\n    > [!NOTE]\n    > O **nome do escopo** deve corresponder ao URI **da ID do** Aplicativo `/access_as_user` com acrescentado no final.</br>\n       `api://d4b8****.ngrok.io/00000000-0000-0000-0000-000000000000/access_as_user`\n\n    ![Scopes](~/assets/images/Teams-task-module/scopes_2.png) \n\n1. Na seção **Aplicativos cliente autorizados,** identifique os aplicativos que você deseja autorizar para o aplicativo Web do seu aplicativo. \n\n1. Selecione **Adicionar um aplicativo cliente**. \n\n    :::image type=\"content\" source=\"~/assets/images/meetings-side-panel/selectclientapp_1.png\" alt-text=\"Selecionar aplicativo cliente\"::: \n\n1. Insira **a ID do cliente**: para `1fec8e78-bce4-4aaf-ab1b-5451cc387264` o aplicativo móvel ou da área de trabalho do Teams. \n\n    ![Adicionar aplicativo cliente 1](~/assets/images/meetings-side-panel/addclientapplication1.png) \n\n   Insira **a ID do cliente**: `5e3ce6c0-2b1f-4285-8d4b-75ee78787346` para o aplicativo Web do Teams.\n\n    ![Adicionar aplicativo cliente 2](~/assets/images/meetings-side-panel/addclientapplication2.png) \n\n1. Selecione **Escopos autorizados**.\n\n    ![Adicionar aplicativo cliente 2](~/assets/images/Teams-task-module/authorizedscope.png) \n\n   A imagem a seguir exibe as IDs do cliente:\n\n    ![Aplicativos do cliente](~/assets/images/meetings-side-panel/clientapps.png) \n\n1. No painel esquerdo, selecione Permissões **de API**. \n\n   > [!NOTE]\n   > Os usuários precisam consentir com as permissões de API somente se o Azure AD aplicativo estiver registrado em um locatário diferente.\n\n1. Selecione **Adicionar uma permissão**.\n\n    ![Adicionar permissão](~/assets/images/meetings-side-panel/add-permission_1.png)\n\n1. Selecione **Microsoft Graph**.\n\n1. Selecione **Permissões delegadas**.\n\n1. Selecione as seguintes permissões:</br>\n     * **email**\n     * **offline_access**\n     * **Openid**\n     * **profile**\n      * **User.Read**\n\n1. Selecione **Adicionar permissões**.\n\n     ![Outras permissões](~/assets/images/meetings-side-panel/other-permissions_1.png)\n\n1. No painel esquerdo, selecione **Autenticação para** definir um URI de redirecionamento. \n\n   > [!NOTE]\n   > Se um aplicativo não receber consentimento do administrador de TI, os usuários deverão fornecer consentimento na primeira vez que usarem um aplicativo.\n           \n     1. Selecione **Adicionar uma plataforma** > **da Web**.\n\n        ![Web](~/assets/images/Teams-task-module/webauth_1.png)\n\n     1. Insira o URI de redirecionamento para seu aplicativo acrescentando-se `auth-end` ao nome de domínio totalmente qualificado:</br> \n       `https://d4b8****.ngrok.io/auth-end`. </br>\n\n     1. **Habilite a concessão implícita e os fluxos** híbridos selecionando as seguintes caixas de seleção:\n         * **Tokens de ID**\n         * **Tokens de acesso**\n\n     1. Selecione **Configurar**.\n\n        ![Auth-end](~/assets/images/Teams-task-module/authend_1.png)\n"
- title: Configurar configurações de aplicativo e arquivos de manifesto
  durationInMinutes: 1
  content: "1. Vá para **appsettings.json** no repositório clonado.\n\n    ![Local das configurações do aplicativo](~/assets/images/Teams-task-module/appsettingslocation_1.png)\n\n1. Abra **appsettings.json na** versão mais recente do Visual Studio e atualize as seguintes informações:  \n\n     * Defina `\"MicrosoftAppType\"` como **MultiTenant**.\n     * Defina `\"MicrosoftAppId\"` como a **ID do aplicativo Microsoft do bot**.\n     * Defina `\"MicrosoftAppPassword\"` como **Valor** do **Segredo do Cliente**.\n     * Defina `\"MicrosoftAppTenantId\"` como a ID de locatário do locatário em que o aplicativo é usado.\n     * Defina `\"BaseUrl\"` como o nome de domínio totalmente qualificado (https to io).\n\n    ![Configurações do aplicativo](~/assets/images/Teams-task-module/appsettings_1.png)\n\n1. Vá para 'manifest.json'' no repositório clonado.\n\n    :::image type=\"content\" source=\"~/assets/images/Teams-task-module/manifestlocation_1.png\" alt-text=\"Local do arquivo de manifesto\":::\n\n1. Abra 'manifest.json'' na versão mais recente do Visual Studio e faça as seguintes alterações:\n\n     * Substitua todas as ocorrências de `YourDeployedBotUrl.com` pelo `WebAppDomain` nome.\n     * Substitua todas as ocorrências pela `<<YOUR-MICROSOFT-APP-ID>>` **ID do Aplicativo Microsoft do bot**.\n\n    ![Imagem2 do manifesto](~/assets/images/Teams-task-module/manifest_1.png)\n"
- title: Compilar e executar o serviço
  durationInMinutes: 1
  content: "**Para compilar e executar o serviço usando a versão mais recente do Visual Studio ou linha de comando**\n\n# <a name=\"latest-version-of-visual-studio\"></a>[Versão mais recente do Visual Studio](#tab/latestversionofvisualstudio)\n\n   1. Inicie a versão mais recente do Visual Studio.\n   1. Vá para **Arquivo** > **Aberto projeto** > **/solução**.\n\n      ![Abrir arquivo](~/assets/images/Teams-task-module/VSopenfile.png)\n\n   1. Selecione **o arquivo TeamsTaskModule.csproj** na **pasta 54.teams-task-module** .\n\n      :::image type=\"content\" source=\"~/assets/images/Teams-task-module/csprojfileopen_1.png\" alt-text=\"Arquivo CS proj\":::\n\n   1. Abra **Gerenciador de Soluções** **exibição**.\n\n      ![Gerenciador de Soluções](~/assets/images/Teams-task-module/solutionexplorer_1.png)\n\n   1. Clique com o botão direito do mouse **para selecionar TeamsTaskModule**.\n\n   1. Selecione **Definir como Projeto de Inicialização**.\n\n      ![Gerenciador de Soluções](~/assets/images/Teams-task-module/startup_1.png)\n\n   1. Pressione **F5** para executar o projeto.\n\n   1. Selecione **Sim** se a caixa de diálogo a seguir for exibida:\n\n      :::image type=\"content\" source=\"~/assets/images/Teams-task-module/certificate_1.png\" alt-text=\"Certificado de Confiança\":::\n\n      Uma página da Web é aberta com uma mensagem **. Seu bot está pronto!**.\n\n      ![Aplicativo pronto](~/assets/images/Teams-task-module/appisready.png) \n\n    \n# <a name=\"command-line\"></a>[Linha de comando](#tab/cli)\n\nVá para **BotBuilder-Samples > exemplos > csharp_dotnetcore > 54.teams-task-module** na janela prompt de comando e insira o seguinte comando:\n\n```bash\ndotnet run\n```\n\n![Dotnet](~/assets/images/Teams-task-module/dotnetruncmd.png)\n"
- title: Carregar aplicativo módulo de tarefa
  durationInMinutes: 1
  content: "1. No repositório clonado, acesse **csharp_dotnetcore > 54.teams-task-module > TeamsAppManifest**.\n\n1. Crie um .zip com os seguintes arquivos que estão presentes na pasta **TeamsAppManifest** : \n   * manifest.json\n   * icon-outline.png\n   * icon-color.png\n\n   ![Arquivo zip](~/assets/images/Teams-task-module/zip-file_1.png) \n\n1. Vá para **o Microsoft Teams**.\n\n1. Selecione **Aplicativos**.\n\n   ![Arquivo zip](~/assets/images/Teams-task-module/AppStore_1.png)\n\n1. Selecione **Gerenciar seus aplicativos**.\n\n   ![Gerenciar aplicativos](~/assets/images/Teams-task-module/manage-apps_1.png)\n\n1. Selecione **Fazer o upload de um aplicativo personalizado**. \n\n   ![Carregar aplicativo personalizado](~/assets/images/Teams-task-module/upload-app_1.png)\n\n1. Selecione **Abrir** para carregar o .zip que você criou na pasta **TeamsAppManifest** .\n\n   ![Selecionar arquivo zip](~/assets/images/Teams-task-module/select-zip_1.png)\n\n1. Selecione **Adicionar**.\n\n   :::image type=\"content\" source=\"~/assets/images/Teams-task-module/add-app_1.png\" alt-text=\"Adicionar o aplicativo\":::\n\n   O aplicativo é aberto em um chat.\n\n1. Insira qualquer texto e selecione Enter. \n\n   ![Chat](~/assets/images/Teams-task-module/chat_ready.png)\n\n   O aplicativo exibe a **Invocação do Módulo de Tarefa do Cartão Hero** e a Invocação do Módulo de Tarefa **do Cartão Adaptável**.         \n"
- title: Interagir com o aplicativo no Teams
  durationInMinutes: 1
  content: >
    1. Selecione **Cartão Adaptável na** **Invocação do Módulo de Tarefa no Cartão Hero** ou **na Invocação do Módulo de Tarefa do Cartão Adaptável**.

       ![Cartão adaptável](~/assets/images/Teams-task-module/adaptive-card_1.png)

    1. Insira qualquer texto.


    1. Selecione **Enviar**.

       ![Texto do cartão adaptável](~/assets/images/Teams-task-module/adaptive-card-text.png)

       **O Cartão Adaptável** envia uma mensagem de confirmação.

       ![Envio de cartão adaptável](~/assets/images/Teams-task-module/adaptive-card-submit.png)

    1. Selecione **Formulário Personalizado na** **Invocação do Módulo de Tarefa no Cartão Hero** ou **na Invocação do Módulo de Tarefa do Cartão Adaptável**.

       ![Formulário personalizado](~/assets/images/Teams-task-module/custom-form_1.png)

    1. Insira as informações necessárias:

       * **Nome**
       * **Email**
       * **Livro favorito**
       * **Password**
       * **Confirmar Senha**

    1. Selecione **Inscrever-se**.

       ![Texto do Formulário Personalizado](~/assets/images/Teams-task-module/custom-text.png)

       **O Formulário Personalizado** envia uma mensagem de confirmação.

       ![Inscreva-se](~/assets/images/Teams-task-module/custom-on-sign-up.png)

       As seguintes informações aparecem no chat:

       ![Chat](~/assets/images/Teams-task-module/adaptive-custom-chat.png)

    1. Selecione **o YouTube** na **invocação do módulo de tarefa do Cartão Hero** ou **da invocação do módulo de tarefa do Cartão Adaptável**.

       ![YouTube](~/assets/images/Teams-task-module/youtube_1.png)

    1. Selecione **Reproduzir**.

       ![Seleção do YouTube](~/assets/images/Teams-task-module/youtube-select_1.png)

       O vídeo é reproduzido.
- title: Desafio completo
  durationInMinutes: 1
  content: >
    Você conseguiu algo assim?

       ![Módulo de tarefa](~/assets/images/Teams-task-module/final_image.png)
- content: Você concluiu o tutorial para começar a usar o aplicativo de módulo de tarefas do Teams!
