---
title: Requisitos e considerações para bots de mídia hospedados pelo aplicativo
description: Entenda os requisitos e as considerações importantes relacionados à criação de bots de mídia hospedados pelo aplicativo para o Microsoft Teams.
ms.topic: conceptual
keywords: vm do Azure server do Windows Media hospedado pelo aplicativo
ms.date: 11/16/2018
ms.openlocfilehash: bf75b7f689713f16cb3ff9ff4313ab829b5cc2d6
ms.sourcegitcommit: 976e870cc925f61b76c3830ec04ba6e4bdfde32f
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/27/2021
ms.locfileid: "50014485"
---
# <a name="requirements-and-considerations-for-application-hosted-media-bots"></a><span data-ttu-id="2ce42-104">Requisitos e considerações para bots de mídia hospedados pelo aplicativo</span><span class="sxs-lookup"><span data-stu-id="2ce42-104">Requirements and considerations for application-hosted media bots</span></span>

<span data-ttu-id="2ce42-105">Nem todas as diretrizes para o desenvolvimento de mensagens e bots IVR (Resposta interativa de voz) se aplica igualmente à criação de bots de mídia hospedados pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="2ce42-105">Not all guidance for developing messaging and Interactive Voice Response (IVR) bots applies equally to building application-hosted media bots.</span></span> <span data-ttu-id="2ce42-106">Este artigo descreve alguns dos requisitos e considerações importantes para desenvolver e executar um bot de mídia hospedado pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="2ce42-106">This article describes some of the important requirements and considerations for developing and running an application-hosted media bot.</span></span>

> [!NOTE]
> <span data-ttu-id="2ce42-107">Como a Plataforma de Mídia em Tempo Real da Microsoft para Bots está na visualização do desenvolvedor, as orientações neste artigo estão sujeitas a alterações.</span><span class="sxs-lookup"><span data-stu-id="2ce42-107">Because the Microsoft Real-time Media Platform for Bots is in developer preview, the guidance in this article is subject to change.</span></span>

## <a name="application-hosted-media-bot-development-requires-cnet-and-windows-server"></a><span data-ttu-id="2ce42-108">O desenvolvimento de bots de mídia hospedados pelo aplicativo requer C#/.NET e Windows Server</span><span class="sxs-lookup"><span data-stu-id="2ce42-108">Application-hosted media bot development requires C#/.NET and Windows Server</span></span>

- <span data-ttu-id="2ce42-109">Um bot de mídia hospedado pelo aplicativo requer a biblioteca .NET (disponível aqui para acessar os fluxos de mídia de áudio e vídeo, e o bot deve ser implantado em uma máquina do Windows Server (ou o sistema operacional convidado do Windows Server no `Microsoft.Graph.Communications.Calls.Media` Azure).[](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/)</span><span class="sxs-lookup"><span data-stu-id="2ce42-109">An application-hosted media bot requires the `Microsoft.Graph.Communications.Calls.Media` .NET library ([available here](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/) to access the audio and video media streams, and the bot must be deployed on a Windows Server machine (or Windows Server guest OS in Azure).</span></span> <span data-ttu-id="2ce42-110">Portanto, o bot deve ser desenvolvido em C# e o .NET Framework padrão e implantado no Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="2ce42-110">Therefore, the bot must be developed in C# and the standard .NET Framework and deployed in Microsoft Azure.</span></span> <span data-ttu-id="2ce42-111">Não é possível usar APIs do tipo C++ ou Node.js para acessar mídia em tempo real e o .NET Core não é suportado para um bot de mídia hospedado pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="2ce42-111">You can't use C++ or Node.js APIs to access real-time media and .NET Core is not supported for an application-hosted media bot.</span></span>

- <span data-ttu-id="2ce42-112">Um bot de mídia hospedado pelo aplicativo pode ser hospedado em um dos seguintes ambientes de serviço do Azure:</span><span class="sxs-lookup"><span data-stu-id="2ce42-112">An application-hosted media bot can be hosted within one of the following Azure service environments:</span></span>
  - <span data-ttu-id="2ce42-113">Serviço de Nuvem.</span><span class="sxs-lookup"><span data-stu-id="2ce42-113">Cloud Service.</span></span>
  - <span data-ttu-id="2ce42-114">Service Fabric com VMSS (Conjuntos de Escala de Máquina Virtual).</span><span class="sxs-lookup"><span data-stu-id="2ce42-114">Service Fabric with Virtual Machine Scale Sets (VMSS).</span></span>
  - <span data-ttu-id="2ce42-115">Máquina Virtual (VM) Infraestrutura como Serviço (IaaS).</span><span class="sxs-lookup"><span data-stu-id="2ce42-115">Infrastructure as a Service (IaaS) Virtual Machine (VM).</span></span>  
  
- <span data-ttu-id="2ce42-116">Um bot de mídia hospedado pelo aplicativo não pode ser implantado como um Azure Web App.</span><span class="sxs-lookup"><span data-stu-id="2ce42-116">An application-hosted media bot can't be deployed as an Azure Web App.</span></span>

- <span data-ttu-id="2ce42-117">Um bot de mídia hospedado pelo aplicativo deve estar em execução em uma versão recente da `Microsoft.Graph.Communications.Calls.Media` biblioteca .NET.</span><span class="sxs-lookup"><span data-stu-id="2ce42-117">An application-hosted media bot must be running on a recent version of the `Microsoft.Graph.Communications.Calls.Media` .NET library.</span></span> <span data-ttu-id="2ce42-118">O bot deve usar a versão mais recente disponível do pacote [NuGet](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/)ou uma versão que não tem mais de três meses.</span><span class="sxs-lookup"><span data-stu-id="2ce42-118">The bot should use either the newest available version of the [NuGet package](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/), or a version that is not more than three months old.</span></span> <span data-ttu-id="2ce42-119">As versões mais antigas da biblioteca serão preterida e podem não funcionar após alguns meses.</span><span class="sxs-lookup"><span data-stu-id="2ce42-119">Older versions of the library will be deprecated and may not work after a few months.</span></span> <span data-ttu-id="2ce42-120">Manter `Microsoft.Graph.Communications.Calls.Media` a biblioteca atualizada garantirá a melhor interoperabilidade entre o bot e o Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="2ce42-120">Keeping the `Microsoft.Graph.Communications.Calls.Media` library up-to-date will ensure the best interoperability between the bot and Microsoft Teams.</span></span>

## <a name="real-time-media-calls-stay-on-the-machine-where-they-were-created"></a><span data-ttu-id="2ce42-121">As chamadas de mídia em tempo real permanecem no computador onde foram criadas</span><span class="sxs-lookup"><span data-stu-id="2ce42-121">Real-time media calls stay on the machine where they were created</span></span>

- <span data-ttu-id="2ce42-122">Uma chamada de mídia em tempo real é fixada à instância da máquina virtual (VM) que aceitou ou iniciou a chamada.</span><span class="sxs-lookup"><span data-stu-id="2ce42-122">A real-time media call is pinned to the virtual machine (VM) instance that accepted or started the call.</span></span> <span data-ttu-id="2ce42-123">A mídia de uma chamada ou reunião do Microsoft Teams fluirá para essa instância da VM, e a mídia que o bot envia de volta para o Microsoft Teams também deve se originar dessa VM.</span><span class="sxs-lookup"><span data-stu-id="2ce42-123">Media from a Microsoft Teams call or meeting will flow to that VM instance, and media the bot sends back to Microsoft Teams must also originate from that VM.</span></span>
- <span data-ttu-id="2ce42-124">Se houver chamadas de mídia em tempo real em andamento quando a VM for interrompida, essas chamadas serão encerradas abruptamente.</span><span class="sxs-lookup"><span data-stu-id="2ce42-124">If there are any real-time media calls in progress when the VM is stopped, those calls will be abruptly terminated.</span></span> <span data-ttu-id="2ce42-125">Se o bot tiver conhecimento prévio do desligamento pendente da VM, ele poderá tentar encerrar as chamadas "normalmente".</span><span class="sxs-lookup"><span data-stu-id="2ce42-125">If the bot has prior knowledge of the pending VM shutdown, it can try to "gracefully" end the calls.</span></span>

## <a name="application-hosted-media-bots-must-be-directly-accessible-on-the-internet"></a><span data-ttu-id="2ce42-126">Os bots de mídia hospedados pelo aplicativo devem estar diretamente acessíveis na Internet</span><span class="sxs-lookup"><span data-stu-id="2ce42-126">Application-hosted media bots must be directly accessible on the internet</span></span>

- <span data-ttu-id="2ce42-127">Cada instância de VM que hospeda um bot de mídia hospedado pelo aplicativo no Azure deve estar diretamente acessível pela Internet usando um ILPIP (endereço IP público de nível de instância).</span><span class="sxs-lookup"><span data-stu-id="2ce42-127">Each VM instance hosting an application-hosted media bot in Azure must be directly accessible from the internet using an instance-level public IP address (ILPIP).</span></span>
  - <span data-ttu-id="2ce42-128">Para obter e configurar um ILPIP para um Serviço de Nuvem do Azure, consulte a visão geral do IP público de nível de [instância (clássico).](/azure/virtual-network/virtual-networks-instance-level-public-ip)</span><span class="sxs-lookup"><span data-stu-id="2ce42-128">For obtaining and configuring an ILPIP for an Azure Cloud Service, see [Instance level public IP (Classic) overview](/azure/virtual-network/virtual-networks-instance-level-public-ip).</span></span>
  - <span data-ttu-id="2ce42-129">Para configurar um ILPIP para um conjunto de escala de VM, consulte [IPv4 público por máquina virtual.](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-networking#public-ipv4-per-virtual-machine)</span><span class="sxs-lookup"><span data-stu-id="2ce42-129">For configuring an ILPIP for a VM Scale Set, see [Public IPv4 per virtual machine](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-networking#public-ipv4-per-virtual-machine).</span></span>
- <span data-ttu-id="2ce42-130">O serviço que hospeda um bot de mídia hospedado pelo aplicativo também deve configurar cada instância de VM com uma porta voltada para o público que mapeia para a instância específica.</span><span class="sxs-lookup"><span data-stu-id="2ce42-130">The service hosting an application-hosted media bot must also configure each VM instance with a public-facing port which maps to the specific instance.</span></span>
  - <span data-ttu-id="2ce42-131">Para um Serviço de Nuvem do Azure, isso requer um ponto de extremidade de entrada de instância; Confira [Habilitar comunicação para instâncias de função no Azure.](/azure/cloud-services/cloud-services-enable-communication-role-instances)</span><span class="sxs-lookup"><span data-stu-id="2ce42-131">For an Azure Cloud Service, this requires an instance input endpoint; see [Enable communication for role instances in Azure](/azure/cloud-services/cloud-services-enable-communication-role-instances).</span></span>
  - <span data-ttu-id="2ce42-132">Para um Conjunto de Escala de VM, uma regra NAT no balanceador de carga deve ser configurada; confira [Redes virtuais e máquinas virtuais no Azure.](/azure/virtual-machines/windows/network-overview)</span><span class="sxs-lookup"><span data-stu-id="2ce42-132">For a VM Scale Set, a NAT rule on the load balancer must be configured; see [Virtual networks and virtual machines in Azure](/azure/virtual-machines/windows/network-overview).</span></span>
- <span data-ttu-id="2ce42-133">Os bots de mídia hospedados pelo aplicativo não são suportados pelo Emulador da Estrutura de Bot.</span><span class="sxs-lookup"><span data-stu-id="2ce42-133">Application-hosted media bots aren't supported by the Bot Framework Emulator.</span></span>

## <a name="scalability-and-performance-considerations"></a><span data-ttu-id="2ce42-134">Considerações sobre escalabilidade e desempenho</span><span class="sxs-lookup"><span data-stu-id="2ce42-134">Scalability and performance considerations</span></span>

- <span data-ttu-id="2ce42-135">Os bots de mídia hospedados pelo aplicativo exigem mais capacidade de computação e rede (largura de banda) do que os bots de mensagens e podem incorrer em custos operacionais significativamente maiores.</span><span class="sxs-lookup"><span data-stu-id="2ce42-135">Application-hosted media bots require more compute and network (bandwidth) capacity than messaging bots and may incur significantly higher operational costs.</span></span> <span data-ttu-id="2ce42-136">Um desenvolvedor de bot de mídia em tempo real deve medir cuidadosamente a escalabilidade do bot e garantir que o bot não aceite mais chamadas simultâneas do que pode gerenciar.</span><span class="sxs-lookup"><span data-stu-id="2ce42-136">A real-time media bot developer must carefully measure the bot's scalability, and ensure the bot doesn't accept more simultaneous calls than it can manage.</span></span> <span data-ttu-id="2ce42-137">Um bot habilitado para vídeo pode sustentar apenas uma ou duas sessões de mídia simultâneas por núcleo da CPU (se estiver usando os formatos de vídeo RGB24 ou NV12 "brutos").</span><span class="sxs-lookup"><span data-stu-id="2ce42-137">A video-enabled bot may be able to sustain only one or two concurrent media sessions per CPU core (if using the "raw" RGB24 or NV12 video formats).</span></span>
- <span data-ttu-id="2ce42-138">No momento, a Plataforma de Mídia em Tempo Real não aproveita as Unidades de Processamento gráfico (GPU) disponíveis na VM para decodificar/decodificar vídeo H.264.</span><span class="sxs-lookup"><span data-stu-id="2ce42-138">The Real-time Media Platform doesn't currently take advantage of any Graphics Processing Units (GPU) available on the VM to off-load H.264 video encoding/decoding.</span></span> <span data-ttu-id="2ce42-139">Em vez disso, a codificação e a decodificada de vídeo são feitas no software da CPU.</span><span class="sxs-lookup"><span data-stu-id="2ce42-139">Instead, video encode and decode are done in software on the CPU.</span></span> <span data-ttu-id="2ce42-140">Se uma GPU estiver disponível, o bot poderá tirar proveito dela para sua própria renderização de elementos gráficos (por exemplo, se o bot estiver usando um mecanismo gráfico 3D).</span><span class="sxs-lookup"><span data-stu-id="2ce42-140">If a GPU is available, the bot may take advantage of it for its own graphics rendering (e.g. if the bot is using a 3D graphics engine).</span></span>
- <span data-ttu-id="2ce42-141">A instância da VM que hospeda o bot de mídia em tempo real deve ter pelo menos 2 núcleos de CPU.</span><span class="sxs-lookup"><span data-stu-id="2ce42-141">The VM instance hosting the real-time media bot must have at least 2 CPU cores.</span></span> <span data-ttu-id="2ce42-142">Para o Azure, é recomendável uma máquina virtual de série Dv2.</span><span class="sxs-lookup"><span data-stu-id="2ce42-142">For Azure, a Dv2-series virtual machine is recommended.</span></span> <span data-ttu-id="2ce42-143">Para outros tipos de VM do Azure, um sistema com 4 CPUs virtuais (vCPU) é o tamanho mínimo necessário.</span><span class="sxs-lookup"><span data-stu-id="2ce42-143">For other Azure VM types, a system with 4 virtual CPUs (vCPU) is the minimum size required.</span></span> <span data-ttu-id="2ce42-144">Informações detalhadas sobre tipos de VM do Azure estão disponíveis na [documentação do Azure.](/azure/virtual-machines/windows/sizes-general)</span><span class="sxs-lookup"><span data-stu-id="2ce42-144">Detailed information about Azure VM types is available in the [Azure documentation](/azure/virtual-machines/windows/sizes-general).</span></span>

## <a name="samples-and-additional-resources"></a><span data-ttu-id="2ce42-145">Exemplos e recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="2ce42-145">Samples and Additional Resources</span></span>

- [<span data-ttu-id="2ce42-146">Aplicativos de exemplo</span><span class="sxs-lookup"><span data-stu-id="2ce42-146">Sample applications</span></span>](https://github.com/microsoftgraph/microsoft-graph-comms-samples/tree/master/Samples/V1.0Samples/LocalMediaSamples)
- [<span data-ttu-id="2ce42-147">Documentação do SDK de Chamada do Graph</span><span class="sxs-lookup"><span data-stu-id="2ce42-147">Graph Calling SDK Documentation</span></span>](https://microsoftgraph.github.io/microsoft-graph-comms-samples/docs/)
