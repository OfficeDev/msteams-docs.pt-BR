---
title: Requisitos e considerações para bots de mídia hospedados pelo aplicativo
description: Entenda os requisitos e considerações importantes relacionados à criação de bots de mídia hospedados pelo aplicativo para o Microsoft Teams.
ms.topic: conceptual
keywords: vm do windows server do windows server hospedado pelo aplicativo
ms.date: 11/16/2018
ms.openlocfilehash: dfd0b3a2ba9020622a2926c4fc395c060599afb6
ms.sourcegitcommit: 79e6bccfb513d4c16a58ffc03521edcf134fa518
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/13/2021
ms.locfileid: "51697078"
---
# <a name="requirements-and-considerations-for-application-hosted-media-bots"></a><span data-ttu-id="0f5f9-104">Requisitos e considerações para bots de mídia hospedados pelo aplicativo</span><span class="sxs-lookup"><span data-stu-id="0f5f9-104">Requirements and considerations for application-hosted media bots</span></span>

<span data-ttu-id="0f5f9-105">Um bot de mídia hospedado por aplicativo requer a [ `Microsoft.Graph.Communications.Calls.Media` biblioteca .NET](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/) para acessar os fluxos de mídia de áudio e vídeo.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-105">An application-hosted media bot requires the [`Microsoft.Graph.Communications.Calls.Media` .NET library](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/) to access the audio and video media streams.</span></span> <span data-ttu-id="0f5f9-106">O bot deve ser implantado em uma máquina do Windows Server ou sistema operacional convidado do Windows Server no Azure.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-106">The bot must be deployed on a Windows Server machine or Windows Server guest Operating System (OS) in Azure.</span></span>

> [!NOTE]
> * <span data-ttu-id="0f5f9-107">As diretrizes para o desenvolvimento de mensagens e ivr (resposta interativa de voz) não se aplicam completamente à criação de bots de mídia hospedados pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-107">The guidance for developing messaging and Interactive Voice Response (IVR) bots does not completely apply to building application-hosted media bots.</span></span>
> * <span data-ttu-id="0f5f9-108">Como a Plataforma de Mídia em Tempo Real da Microsoft para bots está na visualização do desenvolvedor, as diretrizes neste documento estão sujeitas a alterações.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-108">As the Microsoft Real-time Media Platform for bots is in developer preview, the guidance in this document is subject to change.</span></span>

## <a name="c-or-net-and-windows-server-for-development"></a><span data-ttu-id="0f5f9-109">C# ou .NET e Windows Server para desenvolvimento</span><span class="sxs-lookup"><span data-stu-id="0f5f9-109">C# or .NET and Windows Server for development</span></span>

<span data-ttu-id="0f5f9-110">Um bot de mídia hospedado por aplicativo requer o seguinte:</span><span class="sxs-lookup"><span data-stu-id="0f5f9-110">An application-hosted media bot requires the following:</span></span>

- <span data-ttu-id="0f5f9-111">O bot deve ser desenvolvido no C# e no padrão .NET Framework e implantado no Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-111">The bot must be developed in C# and the standard .NET Framework and deployed in Microsoft Azure.</span></span> <span data-ttu-id="0f5f9-112">Não é possível usar APIs C++ ou Node.js para acessar mídia em tempo real e o .NET Core não tem suporte para um bot de mídia hospedado pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-112">You cannot use C++ or Node.js APIs to access real-time media and .NET Core is not supported for an application-hosted media bot.</span></span>

- <span data-ttu-id="0f5f9-113">O bot pode ser hospedado em um dos seguintes ambientes de serviço do Azure:</span><span class="sxs-lookup"><span data-stu-id="0f5f9-113">The bot can be hosted within one of the following Azure service environments:</span></span>
    - <span data-ttu-id="0f5f9-114">Serviço de Nuvem.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-114">Cloud Service.</span></span>
    - <span data-ttu-id="0f5f9-115">Service Fabric with Virtual Machine Scale Sets (VMSS).</span><span class="sxs-lookup"><span data-stu-id="0f5f9-115">Service Fabric with Virtual Machine Scale Sets (VMSS).</span></span>
    - <span data-ttu-id="0f5f9-116">Infraestrutura como uma máquina virtual (IaaS) (VM).</span><span class="sxs-lookup"><span data-stu-id="0f5f9-116">Infrastructure as a Service (IaaS) Virtual Machine (VM).</span></span>  
  
- <span data-ttu-id="0f5f9-117">O bot não pode ser implantado como um aplicativo Web do Azure.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-117">The bot cannot be deployed as an Azure web app.</span></span>

- <span data-ttu-id="0f5f9-118">O bot deve estar em execução em uma versão recente da `Microsoft.Graph.Communications.Calls.Media` biblioteca .NET.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-118">The bot must be running on a recent version of the `Microsoft.Graph.Communications.Calls.Media` .NET library.</span></span> <span data-ttu-id="0f5f9-119">O bot deve usar a versão mais recente disponível do pacote [NuGet](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/)ou uma versão que não tem mais de três meses.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-119">The bot must use either the newest available version of the [NuGet package](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/), or a version that is not more than three months old.</span></span> <span data-ttu-id="0f5f9-120">As versões mais antigas da biblioteca são preterida e não funcionam após alguns meses.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-120">Older versions of the library are deprecated and do not work after a few months.</span></span> <span data-ttu-id="0f5f9-121">Manter a biblioteca atualizada garante a melhor `Microsoft.Graph.Communications.Calls.Media` interoperabilidade entre o bot e o Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-121">Keeping the `Microsoft.Graph.Communications.Calls.Media` library up-to-date ensures the best interoperability between the bot and Microsoft Teams.</span></span>

<span data-ttu-id="0f5f9-122">A próxima seção fornece detalhes sobre onde as chamadas de mídia em tempo real estão localizadas.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-122">The next section provides details on where real-time media calls are located.</span></span>

## <a name="real-time-media-calls-stay-where-they-are-created"></a><span data-ttu-id="0f5f9-123">As chamadas de mídia em tempo real permanecem onde são criadas</span><span class="sxs-lookup"><span data-stu-id="0f5f9-123">Real-time media calls stay where they are created</span></span>

<span data-ttu-id="0f5f9-124">As chamadas de mídia em tempo real permanecem no computador onde foram criadas.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-124">Real-time media calls stay on the computer where they were created.</span></span> <span data-ttu-id="0f5f9-125">Uma chamada de mídia em tempo real é fixada à instância da máquina virtual (VM) que aceitou ou iniciou a chamada.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-125">A real-time media call is pinned to the virtual machine (VM) instance that accepted or started the call.</span></span> <span data-ttu-id="0f5f9-126">A mídia de uma chamada ou reunião do Microsoft Teams flui para essa instância da VM, e a mídia que o bot envia de volta para o Microsoft Teams também deve se originar dessa VM.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-126">Media from a Microsoft Teams call or meeting flows to that VM instance, and media the bot sends back to Microsoft Teams must also originate from that VM.</span></span> <span data-ttu-id="0f5f9-127">Se houver chamadas de mídia em tempo real em andamento quando a VM for interrompida, essas chamadas serão interrompidas abruptamente.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-127">If there are any real-time media calls in progress when the VM is stopped, those calls are abruptly terminated.</span></span> <span data-ttu-id="0f5f9-128">Se o bot tiver conhecimento prévio do desligamento da VM pendente, ele poderá encerrar as chamadas.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-128">If the bot has prior knowledge of the pending VM shutdown, it can end the calls.</span></span>

<span data-ttu-id="0f5f9-129">A próxima seção fornece detalhes sobre acessibilidade de bots de mídia hospedados pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-129">The next section provides details on accessibility of application-hosted media bots.</span></span>

## <a name="application-hosted-media-bots-accessible-on-the-internet"></a><span data-ttu-id="0f5f9-130">Bots de mídia hospedados por aplicativos acessíveis na Internet</span><span class="sxs-lookup"><span data-stu-id="0f5f9-130">Application-hosted media bots accessible on the internet</span></span>

<span data-ttu-id="0f5f9-131">Os bots de mídia hospedados por aplicativos devem estar diretamente acessíveis na Internet.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-131">Application-hosted media bots must be directly accessible on the internet.</span></span> <span data-ttu-id="0f5f9-132">Esses bots devem incluir os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="0f5f9-132">These bots must include the following features:</span></span>

- <span data-ttu-id="0f5f9-133">Cada instância de VM que hospeda um bot de mídia hospedado por aplicativo no Azure deve estar diretamente acessível da Internet usando um endereço IP público de nível de instância (ILPIP).</span><span class="sxs-lookup"><span data-stu-id="0f5f9-133">Each VM instance hosting an application-hosted media bot in Azure must be directly accessible from the internet using an instance-level public IP address (ILPIP).</span></span>
    - <span data-ttu-id="0f5f9-134">Para obter e configurar um ILPIP para um Serviço de Nuvem do Azure, consulte [instance level public IP classic overview](/azure/virtual-network/virtual-networks-instance-level-public-ip).</span><span class="sxs-lookup"><span data-stu-id="0f5f9-134">For obtaining and configuring an ILPIP for an Azure Cloud Service, see [instance level public IP classic overview](/azure/virtual-network/virtual-networks-instance-level-public-ip).</span></span>
    - <span data-ttu-id="0f5f9-135">Para configurar um ILPIP para um conjunto de escala de VM, consulte [IPv4 público por máquina virtual](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-networking#public-ipv4-per-virtual-machine).</span><span class="sxs-lookup"><span data-stu-id="0f5f9-135">For configuring an ILPIP for a VM Scale Set, see [public IPv4 per virtual machine](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-networking#public-ipv4-per-virtual-machine).</span></span>
- <span data-ttu-id="0f5f9-136">O serviço que hospeda um bot de mídia hospedado por aplicativo também deve configurar cada instância da VM com uma porta pública que mapeia para a instância específica.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-136">The service hosting an application-hosted media bot must also configure each VM instance with a public-facing port which maps to the specific instance.</span></span>
    - <span data-ttu-id="0f5f9-137">Para um Serviço de Nuvem do Azure, isso requer um ponto de extremidade de entrada de instância.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-137">For an Azure Cloud Service, this requires an instance input endpoint.</span></span> <span data-ttu-id="0f5f9-138">Para obter mais informações, [consulte enable communication for role instances in Azure](/azure/cloud-services/cloud-services-enable-communication-role-instances).</span><span class="sxs-lookup"><span data-stu-id="0f5f9-138">For more information, see [enable communication for role instances in Azure](/azure/cloud-services/cloud-services-enable-communication-role-instances).</span></span>
    - <span data-ttu-id="0f5f9-139">Para um Conjunto de Escala de VM, uma regra NAT no balanceador de carga deve ser configurada.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-139">For a VM Scale Set, a NAT rule on the load balancer must be configured.</span></span> <span data-ttu-id="0f5f9-140">Para obter mais informações, consulte [redes virtuais e máquinas virtuais no Azure](/azure/virtual-machines/windows/network-overview).</span><span class="sxs-lookup"><span data-stu-id="0f5f9-140">For more information, see [virtual networks and virtual machines in Azure](/azure/virtual-machines/windows/network-overview).</span></span>
- <span data-ttu-id="0f5f9-141">Os bots de mídia hospedados pelo aplicativo não são suportados pelo Emulador da Estrutura de Bot.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-141">Application-hosted media bots are not supported by the Bot Framework Emulator.</span></span>

<span data-ttu-id="0f5f9-142">A próxima seção fornece detalhes sobre escalabilidade e considerações de desempenho dos bots de mídia hospedados pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-142">The next section provides details on scalability and performance considerations of application-hosted media bots.</span></span>

## <a name="scalability-and-performance-considerations"></a><span data-ttu-id="0f5f9-143">Considerações sobre escalabilidade e desempenho</span><span class="sxs-lookup"><span data-stu-id="0f5f9-143">Scalability and performance considerations</span></span>

<span data-ttu-id="0f5f9-144">Os bots de mídia hospedados por aplicativo exigem as seguintes considerações de escalabilidade e desempenho:</span><span class="sxs-lookup"><span data-stu-id="0f5f9-144">Application-hosted media bots require the following scalability and performance considerations:</span></span>

- <span data-ttu-id="0f5f9-145">Os bots exigem mais capacidade de computação e largura de banda de rede do que bots de mensagens e incorrem em custos operacionais significativamente maiores.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-145">The bots require more compute and network bandwidth capacity than messaging bots and incur significantly higher operational costs.</span></span> <span data-ttu-id="0f5f9-146">Um desenvolvedor de bot de mídia em tempo real deve medir cuidadosamente a escalabilidade do bot e garantir que o bot não aceite mais chamadas simultâneas do que pode gerenciar.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-146">A real-time media bot developer must carefully measure the bot's scalability, and ensure the bot does not accept more simultaneous calls than it can manage.</span></span> <span data-ttu-id="0f5f9-147">Um bot habilitado para vídeo pode sustentar apenas uma ou duas sessões de mídia simultâneas por núcleo de CPU se usar os formatos de vídeo RGB24 ou NV12 brutos.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-147">A video-enabled bot can sustain only one or two concurrent media sessions per CPU core if using the raw RGB24 or NV12 video formats.</span></span>
- <span data-ttu-id="0f5f9-148">No momento, a Plataforma de Mídia em Tempo Real não tira proveito de nenhuma GPU (Unidades de Processamento de Gráficos) disponíveis na VM para codificação de vídeo H.264 descarramento ou decodificação.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-148">The Real-time Media Platform does not currently take advantage of any Graphics Processing Units (GPU) available on the VM to off-load H.264 video encoding or decoding.</span></span> <span data-ttu-id="0f5f9-149">Em vez disso, a codificação de vídeo e a decodificar são feitas em software na CPU.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-149">Instead, video encode and decode are done in software on the CPU.</span></span> <span data-ttu-id="0f5f9-150">Se uma GPU estiver disponível, o bot tirará proveito dela para sua própria renderização gráfica, por exemplo, se o bot estiver usando um mecanismo gráfico 3D.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-150">If a GPU is available, the bot takes advantage of it for its own graphics rendering, for example, if the bot is using a 3D graphics engine.</span></span>
- <span data-ttu-id="0f5f9-151">A instância da VM que hospeda o bot de mídia em tempo real deve ter pelo menos 2 núcleos de CPU.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-151">The VM instance hosting the real-time media bot must have at least 2 CPU cores.</span></span> <span data-ttu-id="0f5f9-152">Para o Azure, uma máquina virtual da série Dv2 é recomendada.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-152">For Azure, a Dv2-series virtual machine is recommended.</span></span> <span data-ttu-id="0f5f9-153">Para outros tipos de VM do Azure, um sistema com 4 CPUs virtuais (vCPU) é o tamanho mínimo necessário.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-153">For other Azure VM types, a system with 4 virtual CPUs (vCPU) is the minimum size required.</span></span> <span data-ttu-id="0f5f9-154">Para obter mais informações sobre tipos de VM do Azure, consulte [Documentação do Azure](/azure/virtual-machines/windows/sizes-general).</span><span class="sxs-lookup"><span data-stu-id="0f5f9-154">For more information about Azure VM types, see [Azure documentation](/azure/virtual-machines/windows/sizes-general).</span></span>

<span data-ttu-id="0f5f9-155">A próxima seção fornece exemplos que ilustram diferentes cenários de mídia local.</span><span class="sxs-lookup"><span data-stu-id="0f5f9-155">The next section provides samples that illustrate different local media scenarios.</span></span>

## <a name="samples-and-additional-resources"></a><span data-ttu-id="0f5f9-156">Exemplos e recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="0f5f9-156">Samples and additional resources</span></span>

- [<span data-ttu-id="0f5f9-157">Exemplo de aplicativos</span><span class="sxs-lookup"><span data-stu-id="0f5f9-157">Sample applications</span></span>](https://github.com/microsoftgraph/microsoft-graph-comms-samples/tree/master/Samples/V1.0Samples/LocalMediaSamples)
- [<span data-ttu-id="0f5f9-158">Documentação do SDK de chamada gráfica</span><span class="sxs-lookup"><span data-stu-id="0f5f9-158">Graph calling SDK documentation</span></span>](https://microsoftgraph.github.io/microsoft-graph-comms-samples/docs/)

## <a name="next-step"></a><span data-ttu-id="0f5f9-159">Próxima etapa</span><span class="sxs-lookup"><span data-stu-id="0f5f9-159">Next step</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="0f5f9-160">Formatos de mídia suportados</span><span class="sxs-lookup"><span data-stu-id="0f5f9-160">Supported media formats</span></span>](~/resources/media-formats.md)
