---
title: Chamadas de mídia em tempo real e reuniões online com o Microsoft Teams
description: Compreender os principais conceitos de criação de bot que podem conduzir chamadas de áudio e vídeo em tempo real e reuniões online.
keywords: áudio fluxo vídeo fluxo de áudio/vídeo chamada da reunião chamadas de mídia em tempo real do serviço de mídia hospedado por aplicativo de mídia hospedado
ms.openlocfilehash: 0ec99d1caa8810d292170c7c70a1518de7301873
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/01/2020
ms.locfileid: "41672615"
---
# <a name="real-time-media-calls-and-meetings-with-microsoft-teams"></a><span data-ttu-id="4ee7b-104">Chamadas de mídia em tempo real e reuniões com o Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="4ee7b-104">Real-time media calls and meetings with Microsoft Teams</span></span>

<span data-ttu-id="4ee7b-105">A plataforma de mídia em tempo real permite que os bots interajam com chamadas e reuniões do Microsoft Teams usando voz, vídeo e compartilhamento de tela em tempo real.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-105">The Real-time Media Platform enables bots to interact with Microsoft Teams calls and meetings using real-time voice, video, and screen sharing.</span></span> <span data-ttu-id="4ee7b-106">Essa é uma capacidade avançada que permite ao bot enviar e receber quadro de conteúdo de voz e vídeo *por quadro*.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-106">This is an advanced capability which allows the bot to send and receive voice and video content *frame by frame*.</span></span> <span data-ttu-id="4ee7b-107">O bot tem acesso "bruto" aos fluxos de mídia de voz, vídeo e compartilhamento de tela.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-107">The bot has "raw" access to the voice, video, and screen sharing media streams.</span></span> <span data-ttu-id="4ee7b-108">(Os bots que processam mídias são chamados de bots de _mídia hospedados por aplicativos_ , em oposição aos bots de _mídia hospedados pelo serviço_ mais simples que dependem da plataforma de mídia em tempo real para todo o processamento de mídia.)</span><span class="sxs-lookup"><span data-stu-id="4ee7b-108">(Bots which process media themselves are called _application-hosted media_ bots, as opposed to simpler _service-hosted media_ bots that rely on the Real-time Media platform for all media processing.)</span></span>

<span data-ttu-id="4ee7b-109">Por exemplo, em uma chamada 1:1 com um bot, conforme o usuário fala, o bot receberá 50 quadros de áudio por segundo, com cada quadro contendo 20 milissegundos (MS) de áudio.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-109">For example, in a 1:1 call with a bot, as the user speaks, the bot will receive 50 audio frames per second, with each frame containing 20 milliseconds (ms) of audio.</span></span> <span data-ttu-id="4ee7b-110">Um bot de mídia hospedado por aplicativo pode executar o reconhecimento de fala em tempo real à medida que os quadros de áudio são recebidos, em vez de esperar por uma gravação depois que o usuário parou de falar.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-110">An application-hosted media bot can perform real-time speech recognition as the audio frames are received, rather than having to wait for a recording after the user has stopped speaking.</span></span> <span data-ttu-id="4ee7b-111">O bot também pode enviar e receber vídeo de resolução de alta definição, incluindo o conteúdo de compartilhamento de tela baseado em vídeo.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-111">The bot can also send and receive high-definition-resolution video, including video-based screen sharing content.</span></span>

<span data-ttu-id="4ee7b-112">A plataforma fornece uma API simples, semelhante a Soquete, para o bot enviar e receber mídias e manipula a codificação em tempo real e decodificação de pacotes de áudio/vídeo usando codecs como SILK e G. 722 para áudio e H. 264 para vídeo.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-112">The platform provides a simple socket-like API for the bot to send and receive media, and handles the real-time encoding and decoding of audio/video packets using codecs such as SILK and G.722 for audio and H.264 for video.</span></span> <span data-ttu-id="4ee7b-113">A plataforma também lida com toda a criptografia de pacotes de mídia/descriptografia e transmissão de rede de pacotes automaticamente, de modo que o bot só precisa se preocupar com o conteúdo de áudio/vídeo real.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-113">The platform also handles all media packet encryption/decryption and packet network transmission automatically, so the bot just needs to concern itself with the actual audio/video content.</span></span> <span data-ttu-id="4ee7b-114">Um bot de mídia em tempo real pode participar de chamadas 1:1, bem como reuniões com vários participantes.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-114">A real-time media bot may participate in 1:1 calls as well as meetings with multiple participants.</span></span>

<span data-ttu-id="4ee7b-115">Este artigo apresenta os principais conceitos relacionados à criação de um bot que pode realizar chamadas de áudio/vídeo em tempo real com o Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-115">This article introduces key concepts related to building a bot that can conduct real-time audio/video calls with Microsoft Teams.</span></span>

## <a name="media-session"></a><span data-ttu-id="4ee7b-116">Sessão de mídia</span><span class="sxs-lookup"><span data-stu-id="4ee7b-116">Media session</span></span>

<span data-ttu-id="4ee7b-117">Quando um bot de mídia em tempo real responde a uma chamada de entrada ou participa de uma reunião do Microsoft Teams, ele deve declarar quais modalidades ela pretende suportar.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-117">When a real-time media bot answers an incoming call or joins a Microsoft Teams meeting, it must declare what modalities it intends to support.</span></span> <span data-ttu-id="4ee7b-118">Para cada modalidade suportada, o bot declara se pode enviar e receber mídia, somente receber ou somente enviar.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-118">For each supported modality, the bot declares whether it can send and receive media, receive only, or send only.</span></span> <span data-ttu-id="4ee7b-119">Por exemplo, um bot projetado para lidar com as chamadas do Team 1:1 pode querer enviar e receber áudio, mas apenas *Enviar* vídeo (já que ele não precisa receber o vídeo do chamador).</span><span class="sxs-lookup"><span data-stu-id="4ee7b-119">For example, a bot designed to handle 1:1 Teams calls may wish to both send and receive audio, but only *send* video (as it does not need to receive the video of the caller).</span></span> <span data-ttu-id="4ee7b-120">O conjunto de modalidades de áudio e vídeo estabelecidos entre o bot e o chamador ou a reunião do teams é chamado de **sessão de mídia**.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-120">The set of audio and video modalities established between the bot and the Teams caller or meeting is called the **media session**.</span></span>

<span data-ttu-id="4ee7b-121">Dois tipos de modalidades de vídeo têm suporte: **vídeo principal** e **compartilhamento de tela baseado em vídeo**.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-121">Two types of video modalities are supported: **main video** and **video-based screen sharing**.</span></span> <span data-ttu-id="4ee7b-122">O vídeo principal é usado para transportar o vídeo da webcam de um usuário.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-122">Main video is used to transport the video from a user's webcam.</span></span> <span data-ttu-id="4ee7b-123">O compartilhamento de tela baseado em vídeo permite que um usuário Compartilhe sua tela como um fluxo de vídeo.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-123">Video-based screen sharing allows a user to share his or her screen as a video stream.</span></span> <span data-ttu-id="4ee7b-124">A plataforma permite que um bot envie e/ou receba *ambos os* tipos de vídeo.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-124">The platform allows a bot to send and/or receive *both* video types.</span></span>

<span data-ttu-id="4ee7b-125">Quando ingressou em uma reunião do Teams, um bot pode receber vários fluxos de vídeo principais simultaneamente, até 10 por sessão de mídia.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-125">When joined to a Teams meeting, a bot can receive multiple main video streams simultaneously — up to 10 per media session.</span></span> <span data-ttu-id="4ee7b-126">Isso permite que o bot "Veja" mais de um participante da reunião.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-126">This allows the bot to "see" more than one participant in the meeting.</span></span>

## <a name="frames-and-frame-rate"></a><span data-ttu-id="4ee7b-127">Quadros e taxa de quadros</span><span class="sxs-lookup"><span data-stu-id="4ee7b-127">Frames and frame rate</span></span>

<span data-ttu-id="4ee7b-128">Um bot de mídia em tempo real interage diretamente com as modalidades de áudio e vídeo de uma sessão de mídia.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-128">A real-time media bot interacts directly with the audio and video modalities of a media session.</span></span> <span data-ttu-id="4ee7b-129">Isso significa que o bot está enviando e/ou recebendo mídia como uma sequência de **quadros**, onde cada quadro representa uma unidade de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-129">This means the bot is sending and/or receiving media as a sequence of **frames**, where each frame represents a unit of content.</span></span> <span data-ttu-id="4ee7b-130">Um segundo de áudio pode ser transmitido como uma sequência de 50 quadros, com cada quadro contendo 20 milissegundos (MS), 1/50 º de um segundo – conteúdo de fala.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-130">One second of audio may be transmitted as a sequence of 50 frames, with each frame containing 20 milliseconds (ms) —1/50th of a second — of speech content.</span></span> <span data-ttu-id="4ee7b-131">Um segundo de vídeo pode ser dividido em fatias como uma sequência de 30 imagens estáticas, cada uma delas se destina a ser vista apenas 33.3 ms, 1/30 de um segundo, antes da exibição do próximo quadro de vídeo.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-131">One second worth of video may be sliced as a sequence of 30 still images, each intended to be viewed for just 33.3ms — 1/30th of a second — before the next video frame is displayed.</span></span> <span data-ttu-id="4ee7b-132">O número de quadros transmitidos ou renderizados por segundo é chamado de **taxa de quadros**.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-132">The number of frames transmitted or rendered per second is called the **frame rate**.</span></span> <span data-ttu-id="4ee7b-133">"30fps" indica 30 quadros por segundo.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-133">"30fps" indicates 30 frames per second.</span></span>

## <a name="audio-format"></a><span data-ttu-id="4ee7b-134">Formato de áudio</span><span class="sxs-lookup"><span data-stu-id="4ee7b-134">Audio format</span></span>

<span data-ttu-id="4ee7b-135">Cada segundo de áudio é representado como **amostras**16.000, com cada amostra contendo 16 bits de dados.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-135">Each second of audio is represented as 16,000 **samples**, with each sample containing 16-bits of data.</span></span> <span data-ttu-id="4ee7b-136">Um quadro de áudio do 20 ms contém 320 amostras (640 bytes de dados).</span><span class="sxs-lookup"><span data-stu-id="4ee7b-136">A 20ms audio frame contains 320 samples (640 bytes of data).</span></span>

## <a name="video-format"></a><span data-ttu-id="4ee7b-137">Formato de vídeo</span><span class="sxs-lookup"><span data-stu-id="4ee7b-137">Video format</span></span>

<span data-ttu-id="4ee7b-138">Há vários formatos com suporte para o vídeo.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-138">There are several formats supported for video.</span></span> <span data-ttu-id="4ee7b-139">Duas propriedades de chave de um formato de vídeo são seu **tamanho de quadro** e **formato de cor**.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-139">Two key properties of a video format are its **frame size** and **color format**.</span></span> <span data-ttu-id="4ee7b-140">Os tamanhos de quadro suportados incluem 640x360 ("360p"), 1280 x 720 ("720p") e 1920 x 1080 ("1080p").</span><span class="sxs-lookup"><span data-stu-id="4ee7b-140">Supported frame sizes include 640x360 ("360p"), 1280x720 ("720p"), and 1920x1080 ("1080p").</span></span> <span data-ttu-id="4ee7b-141">Os formatos de cores suportados incluem NV12 (12 bits por pixel) e RGB24 (24 bits por pixel).</span><span class="sxs-lookup"><span data-stu-id="4ee7b-141">Supported color formats include NV12 (12 bits per pixel) and RGB24 (24 bits per pixel).</span></span>

<span data-ttu-id="4ee7b-142">Um quadro de vídeo "720p" contém 921.600 pixels (1280 vezes 720).</span><span class="sxs-lookup"><span data-stu-id="4ee7b-142">A "720p" video frame contains 921,600 pixels (1280 times 720).</span></span> <span data-ttu-id="4ee7b-143">No formato de cor RGB24, cada pixel é representado como 3 bytes (24 bits) composto por um byte cada um dos componentes de cor vermelho, verde e azul.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-143">In the RGB24 color format, each pixel is represented as 3 bytes (24-bits) comprised of one byte each of red, green, and blue color components.</span></span> <span data-ttu-id="4ee7b-144">Portanto, um único quadro de vídeo 720p RGB24 requer 2.764.800 bytes de dados (921.600 pixels vezes de 3 bytes/pixel).</span><span class="sxs-lookup"><span data-stu-id="4ee7b-144">Therefore, a single 720p RGB24 video frame requires 2,764,800 bytes of data (921,600 pixels times 3 bytes/pixel).</span></span> <span data-ttu-id="4ee7b-145">Em uma taxa de quadros de 30fps, o envio de quadros de vídeo 720p RGB24 significa processamento de aproximadamente 80 MB/s de conteúdo (que é amplamente compactado pelo codec de vídeo H. 264 antes da transmissão de rede).</span><span class="sxs-lookup"><span data-stu-id="4ee7b-145">At a frame rate of 30fps, sending 720p RGB24 video frames means processing approximately 80 MB/s of content (which is substantially compressed by the H.264 video codec before network transmission).</span></span>

<span data-ttu-id="4ee7b-146">Uma capacidade avançada da plataforma permite que um bot envie/receba vídeo como quadros **codificados** H. 264.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-146">An advanced capability of the platform allows a bot to send/receive video as **encoded** H.264 frames.</span></span> <span data-ttu-id="4ee7b-147">Isso oferece suporte a bots que oferecem seu próprio codificador/decodificador H. 264 ou não precisam do fluxo de vídeo decodificado em bitmaps RGB24 ou NV12 brutos.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-147">This supports bots which provide their own H.264 encoder/decoder, or do not need the video stream decoded into raw RGB24 or NV12 bitmaps.</span></span>

## <a name="active-and-dominant-speakers"></a><span data-ttu-id="4ee7b-148">Alto-falantes ativos e dominantes</span><span class="sxs-lookup"><span data-stu-id="4ee7b-148">Active and dominant speakers</span></span>

<span data-ttu-id="4ee7b-149">Quando fizer parte de uma reunião do teams que consiste em vários participantes, um bot poderá identificar quais participantes da reunião estão falando no momento.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-149">When joined to a Teams meeting consisting of multiple participants, a bot can identify which meeting participants are currently speaking.</span></span> <span data-ttu-id="4ee7b-150">Os **oradores ativos** identificam quais participantes estão sendo ouvidos em cada quadro de áudio recebido.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-150">**Active speakers** identify which participants are being heard in each received audio frame.</span></span> <span data-ttu-id="4ee7b-151">Os **alto-falantes dominantes** identificam quais participantes estão atualmente mais ativos (ou "dominantemente") na conversa de grupo, mesmo que sua voz não seja ouvida em todos os quadros de áudio.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-151">**Dominant speakers** identify which participants are currently most active (or "dominant") in the group conversation, even though their voice may not be heard in every audio frame.</span></span> <span data-ttu-id="4ee7b-152">O conjunto de alto-falantes dominantes pode mudar à medida que os diferentes participantes se acendem.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-152">The set of dominant speakers can change as different participants take turns speaking.</span></span>

## <a name="video-subscription"></a><span data-ttu-id="4ee7b-153">Assinatura de vídeo</span><span class="sxs-lookup"><span data-stu-id="4ee7b-153">Video subscription</span></span>

<span data-ttu-id="4ee7b-154">Em uma chamada 1:1, o bot receberá automaticamente o vídeo do chamador se o bot estiver habilitado para receber vídeo.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-154">In a 1:1 call, the bot will automatically receive the video of the caller if the bot is enabled to receive video.</span></span> <span data-ttu-id="4ee7b-155">Em uma reunião do Teams, o bot deve indicar à plataforma quais participantes ele deseja ver.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-155">In a Teams meeting, the bot must indicate to the platform which participants it wants to see.</span></span> <span data-ttu-id="4ee7b-156">Uma **assinatura de vídeo** é uma solicitação pelo bot para receber o vídeo principal de um participante ou o conteúdo de compartilhamento de tela.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-156">A **video subscription** is a request by the bot to receive a participant’s main video or screen-sharing content.</span></span> <span data-ttu-id="4ee7b-157">À medida que os participantes da reunião realizam a conversa, o bot pode modificar as assinaturas de vídeo desejadas com base nas atualizações do conjunto de alto-falantes dominante ou nas notificações que indicam qual participante está compartilhando tela no momento.</span><span class="sxs-lookup"><span data-stu-id="4ee7b-157">As the participants in the meeting conduct their conversation, the bot may modify its desired video subscriptions based on updates of the dominant speaker set or notifications indicating which participant is currently screen sharing.</span></span>

## <a name="developer-resources"></a><span data-ttu-id="4ee7b-158">Recursos de desenvolvedor</span><span class="sxs-lookup"><span data-stu-id="4ee7b-158">Developer resources</span></span>

<span data-ttu-id="4ee7b-159">Para desenvolver um bot de mídia hospedado por aplicativo, você deve instalar o pacote NuGet a seguir em seu projeto do Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="4ee7b-159">To develop an application-hosted media bot, you must install the following NuGet package within your Visual Studio project:</span></span>

- [<span data-ttu-id="4ee7b-160">Biblioteca Microsoft. Graph. calls. Media .NET</span><span class="sxs-lookup"><span data-stu-id="4ee7b-160">Microsoft.Graph.Calls.Media .NET library</span></span>](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/)

<span data-ttu-id="4ee7b-161">Os bots de mídia hospedados por aplicativos exigem o .NET/C# e o Windows Server, conforme descrito em detalhes em [requisitos e considerações para bots de mídia hospedados por aplicativos](requirements-considerations-application-hosted-media-bots.md#application-hosted-media-bot-development-requires-cnet-and-windows-server).</span><span class="sxs-lookup"><span data-stu-id="4ee7b-161">Application-hosted media bots require .NET/C# and Windows Server, as described in detail in [Requirements and considerations for application-hosted media bots](requirements-considerations-application-hosted-media-bots.md#application-hosted-media-bot-development-requires-cnet-and-windows-server).</span></span>
