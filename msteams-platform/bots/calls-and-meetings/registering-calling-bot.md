---
title: Registrando um bot de chamada e reunião para o Microsoft Teams
description: Saiba como registrar um novo bot de chamada de áudio/vídeo para o Microsoft Teams
keywords: áudio do bot de chamada mídia de vídeo de áudio/vídeo
ms.openlocfilehash: 9b932e6a330b495aef97e65c7bb1f297fdfc1336
ms.sourcegitcommit: 3ba5a5a7d9d9d906abc3ee1df9c2177de0cfd767
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/11/2020
ms.locfileid: "45103002"
---
# <a name="registering-a-calling-bot-for-microsoft-teams"></a><span data-ttu-id="f68d2-104">Registrando um bot de chamada para o Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="f68d2-104">Registering a calling bot for Microsoft Teams</span></span>

<span data-ttu-id="f68d2-105">Um bot que participa de chamadas de áudio/vídeo e reuniões online é um simples bot do Microsoft Teams com alguns recursos adicionais:</span><span class="sxs-lookup"><span data-stu-id="f68d2-105">A bot that participates in audio/video calls and online meetings is an ordinary Microsoft Teams bot with a few extra features:</span></span>

* <span data-ttu-id="f68d2-106">Há uma nova versão do manifesto de aplicativo do teams com duas configurações adicionais `supportsCalling` e `supportsVideo` .</span><span class="sxs-lookup"><span data-stu-id="f68d2-106">There's a new version of the Teams app manifest with two additional settings, `supportsCalling` and `supportsVideo`.</span></span> <span data-ttu-id="f68d2-107">Essas configurações estão incluídas na versão de [visualização do desenvolvedor](../../resources/dev-preview/developer-preview-intro.md) do manifesto do aplicativo Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="f68d2-107">These settings are included in the [Developer Preview](../../resources/dev-preview/developer-preview-intro.md) version of the Microsoft Teams app manifest.</span></span>
* <span data-ttu-id="f68d2-108">[As permissões do Microsoft Graph](./registering-calling-bot.md#add-microsoft-graph-permissions) devem ser configuradas para a ID do aplicativo da Microsoft de seu bot.</span><span class="sxs-lookup"><span data-stu-id="f68d2-108">[Microsoft Graph permissions](./registering-calling-bot.md#add-microsoft-graph-permissions) must be configured for your bot's Microsoft App ID.</span></span>
* <span data-ttu-id="f68d2-109">As chamadas do Microsoft Graph e as permissões de APIs de reuniões online exigem o consentimento do administrador do locatário.</span><span class="sxs-lookup"><span data-stu-id="f68d2-109">The Microsoft Graph calls and online meetings APIs permissions require tenant admin consent.</span></span>

<span data-ttu-id="f68d2-110">Vamos discutir o acima mais detalhadamente.</span><span class="sxs-lookup"><span data-stu-id="f68d2-110">Let's discuss the above in more detail.</span></span>

## <a name="new-manifest-settings"></a><span data-ttu-id="f68d2-111">Novas configurações de manifesto</span><span class="sxs-lookup"><span data-stu-id="f68d2-111">New manifest settings</span></span>

<span data-ttu-id="f68d2-112">Os bots de chamadas e de reuniões online têm duas configurações adicionais no manifest.jsque permitem áudio/vídeo para o bot no Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="f68d2-112">Calling and online meetings bots have two additional settings in the manifest.json that enable audio/video for your bot in Teams.</span></span>

* <span data-ttu-id="f68d2-113">`bots[0].supportsCalling`.</span><span class="sxs-lookup"><span data-stu-id="f68d2-113">`bots[0].supportsCalling`.</span></span> <span data-ttu-id="f68d2-114">Se presente e definido como `true` , o Microsoft Teams permitirá que o bot participe de chamadas e reuniões online.</span><span class="sxs-lookup"><span data-stu-id="f68d2-114">If present and set to `true`, Teams will allow your bot to participate in calls and online meetings.</span></span>
* <span data-ttu-id="f68d2-115">`bots[0].supportsVideo`.</span><span class="sxs-lookup"><span data-stu-id="f68d2-115">`bots[0].supportsVideo`.</span></span> <span data-ttu-id="f68d2-116">Se presente e definido como `true` , o Teams sabe que seu bot oferece suporte a vídeo.</span><span class="sxs-lookup"><span data-stu-id="f68d2-116">If present and set to `true`, Teams knows that your bot supports video.</span></span>

<span data-ttu-id="f68d2-117">Se quiser que o IDE valide corretamente o manifest.jsno esquema para o seu bot de chamada e de reunião para estes valores, você pode alterar o `$schema` atributo da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="f68d2-117">If you want your IDE to properly validate the manifest.json schema for your calling and meeting bot for these values, you can change the `$schema` attribute as follows:</span></span>

```json
"$schema": "https://raw.githubusercontent.com/OfficeDev/microsoft-teams-app-schema/preview/DevPreview/MicrosoftTeams.schema.json",
```

## <a name="creating-a-new-bot-or-adding-calling-capabilities-to-an-existing-bot"></a><span data-ttu-id="f68d2-118">Criando um novo bot ou adicionando recursos de chamada a um bot existente</span><span class="sxs-lookup"><span data-stu-id="f68d2-118">Creating a new bot or adding calling capabilities to an existing bot</span></span>

<span data-ttu-id="f68d2-119">A criação de um novo bot é abordada em mais detalhes no tópico [criar um bot para o Microsoft Teams](../how-to/create-a-bot-for-teams.md) , mas repetiremos alguns deles:</span><span class="sxs-lookup"><span data-stu-id="f68d2-119">Creating a new bot is covered in more detail in the [Create a bot for Microsoft Teams](../how-to/create-a-bot-for-teams.md) topic, but we'll repeat some of it here:</span></span>

1. <span data-ttu-id="f68d2-120">Use este link para criar um novo bot: `https://dev.botframework.com/bots/new` .</span><span class="sxs-lookup"><span data-stu-id="f68d2-120">Use this link to create a new bot: `https://dev.botframework.com/bots/new`.</span></span> <span data-ttu-id="f68d2-121">Se, em vez disso, você selecionar o botão *criar um bot* no portal da estrutura do bot, você criará seu bot no Microsoft Azure, para o qual você precisará de uma conta do Azure.</span><span class="sxs-lookup"><span data-stu-id="f68d2-121">If, instead,  you select the *Create a bot* button in the Bot Framework portal, you will create your bot in Microsoft Azure, for which you'll need an Azure account.</span></span>
1. <span data-ttu-id="f68d2-122">Adicione o canal do Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="f68d2-122">Add the Microsoft Teams channel.</span></span> <span data-ttu-id="f68d2-123">Clique na guia "chamada" na página Microsoft Teams Channel e selecione **habilitar chamadas**e, em seguida, atualizar **webhook (para chamadas)** com a URL https onde você receberá notificações de entrada, por exemplo `https://contoso.com/teamsapp/api/calling` ,.</span><span class="sxs-lookup"><span data-stu-id="f68d2-123">Click on the "Calling" tab on the Microsoft Teams channel page and select **Enable calling**, and then update **Webhook (for calling)** with your HTTPS URL where you will receive incoming notifications, e.g.`https://contoso.com/teamsapp/api/calling`.</span></span> <span data-ttu-id="f68d2-124">Consulte [Configurando canais](/bot-framework/portal-configure-channels) para obter mais informações sobre como configurar canais.</span><span class="sxs-lookup"><span data-stu-id="f68d2-124">Refer to [Configuring Channels](/bot-framework/portal-configure-channels) for more information on how to configure channels.</span></span>
  <span data-ttu-id="f68d2-125">![Configurar informações de canal do Microsoft Teams](~/assets/images/calls-and-meetings/configure-msteams-channel.png)</span><span class="sxs-lookup"><span data-stu-id="f68d2-125">![Configure Microsoft Teams channel information](~/assets/images/calls-and-meetings/configure-msteams-channel.png)</span></span>

## <a name="add-microsoft-graph-permissions"></a><span data-ttu-id="f68d2-126">Adicionar permissões do Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="f68d2-126">Add Microsoft Graph permissions</span></span>

<span data-ttu-id="f68d2-127">O Microsoft Graph expõe permissões granulares que controlam o acesso que os aplicativos têm aos recursos.</span><span class="sxs-lookup"><span data-stu-id="f68d2-127">Microsoft Graph exposes granular permissions controlling the access that apps have to resources.</span></span> <span data-ttu-id="f68d2-128">Como desenvolvedor, você decide quais permissões para o Microsoft Graph seu aplicativo deverá solicitar.</span><span class="sxs-lookup"><span data-stu-id="f68d2-128">As a developer, you decide which permissions for Microsoft Graph your app requests.</span></span>  <span data-ttu-id="f68d2-129">As APIs de chamada do Microsoft Graph dão suporte a _permissões de aplicativo_, que são usadas por aplicativos executados sem um usuário conectado presente.</span><span class="sxs-lookup"><span data-stu-id="f68d2-129">The Microsoft Graph Calling APIs support _Application permissions_, which are used by apps that run without a signed-in user present.</span></span>  <span data-ttu-id="f68d2-130">Um administrador de locatários deve conceder consentimento às permissões do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f68d2-130">A tenant administrator must grant consent to application permissions.</span></span> <span data-ttu-id="f68d2-131">Veja a seguir uma lista dessas permissões:</span><span class="sxs-lookup"><span data-stu-id="f68d2-131">Below is a list of those permissions:</span></span>

### <a name="application-permissions-calls"></a><span data-ttu-id="f68d2-132">Permissões de aplicativo: chamadas</span><span class="sxs-lookup"><span data-stu-id="f68d2-132">Application permissions: calls</span></span>

|<span data-ttu-id="f68d2-133">Permissão</span><span class="sxs-lookup"><span data-stu-id="f68d2-133">Permission</span></span>    |<span data-ttu-id="f68d2-134">Exibir Cadeia de Caracteres</span><span class="sxs-lookup"><span data-stu-id="f68d2-134">Display String</span></span>   |<span data-ttu-id="f68d2-135">Descrição</span><span class="sxs-lookup"><span data-stu-id="f68d2-135">Description</span></span> |<span data-ttu-id="f68d2-136">Consentimento Obrigatório do Administrador</span><span class="sxs-lookup"><span data-stu-id="f68d2-136">Admin Consent Required</span></span> |
|:-----------------------------|:-----------------------------------------|:-----------------|:-----------------|
|<span data-ttu-id="f68d2-137">_Calls.Initiate.All_</span><span class="sxs-lookup"><span data-stu-id="f68d2-137">_Calls.Initiate.All_</span></span>|<span data-ttu-id="f68d2-138">Iniciar chamadas de saída 1:1 do aplicativo (visualização)</span><span class="sxs-lookup"><span data-stu-id="f68d2-138">Initiate outgoing 1:1 calls from the app (preview)</span></span>|<span data-ttu-id="f68d2-139">Permite que o aplicativo faça chamadas de saída para um único usuário e transfira chamadas para usuários no diretório da sua organização, sem um usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="f68d2-139">Allows the app to place outbound calls to a single user and transfer calls to users in your organization’s directory, without a signed-in user.</span></span>|<span data-ttu-id="f68d2-140">Sim</span><span class="sxs-lookup"><span data-stu-id="f68d2-140">Yes</span></span>|
|<span data-ttu-id="f68d2-141">_Calls.InitiateGroupCall.All_</span><span class="sxs-lookup"><span data-stu-id="f68d2-141">_Calls.InitiateGroupCall.All_</span></span>|<span data-ttu-id="f68d2-142">Iniciar a saída de chamadas de grupo do aplicativo (visualização)</span><span class="sxs-lookup"><span data-stu-id="f68d2-142">Initiate outgoing group calls from the app (preview)</span></span>|<span data-ttu-id="f68d2-143">Permite que o aplicativo faça chamadas para vários usuários e adicione participantes a reuniões em sua organização, sem um usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="f68d2-143">Allows the app to place outbound calls to multiple users and add participants to meetings in your organization, without a signed-in user.</span></span>|<span data-ttu-id="f68d2-144">Sim</span><span class="sxs-lookup"><span data-stu-id="f68d2-144">Yes</span></span>|
|<span data-ttu-id="f68d2-145">_Calls.JoinGroupCall.All_</span><span class="sxs-lookup"><span data-stu-id="f68d2-145">_Calls.JoinGroupCall.All_</span></span>|<span data-ttu-id="f68d2-146">Ingresse em reuniões e chamadas de grupo como um aplicativo (visualização)</span><span class="sxs-lookup"><span data-stu-id="f68d2-146">Join Group Calls and Meetings as an app (preview)</span></span>|<span data-ttu-id="f68d2-147">Permite que o aplicativo ingresse em reuniões agendadas e chamadas de grupo em sua organização, sem um usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="f68d2-147">Allows the app to join group calls and scheduled meetings in your organization, without a signed-in user.</span></span> <span data-ttu-id="f68d2-148">O aplicativo será associado aos privilégios de um usuário do diretório para reuniões em seu locatário.</span><span class="sxs-lookup"><span data-stu-id="f68d2-148">The app will be joined with the privileges of a directory user to meetings in your tenant.</span></span>|<span data-ttu-id="f68d2-149">Sim</span><span class="sxs-lookup"><span data-stu-id="f68d2-149">Yes</span></span>|
|<span data-ttu-id="f68d2-150">_Calls.JoinGroupCallasGuest.All_</span><span class="sxs-lookup"><span data-stu-id="f68d2-150">_Calls.JoinGroupCallasGuest.All_</span></span>|<span data-ttu-id="f68d2-151">Ingressar em reuniões e chamadas de grupo como um convidado (visualização)</span><span class="sxs-lookup"><span data-stu-id="f68d2-151">Join Group Calls and Meetings as a guest (preview)</span></span>|<span data-ttu-id="f68d2-152">Permite que o aplicativo ingresse anonimamente no grupo chamadas e em reuniões agendadas em sua organização, sem um usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="f68d2-152">Allows the app to anonymously join group calls and scheduled meetings in your organization, without a signed-in user.</span></span> <span data-ttu-id="f68d2-153">O aplicativo ingressará como convidado para reuniões em seu locatário.</span><span class="sxs-lookup"><span data-stu-id="f68d2-153">The app will be joined as a guest to meetings in your tenant.</span></span>|<span data-ttu-id="f68d2-154">Sim</span><span class="sxs-lookup"><span data-stu-id="f68d2-154">Yes</span></span>|
|<span data-ttu-id="f68d2-155">_Calls. AccessMedia. All_ <sup> _Veja abaixo_</sup></span><span class="sxs-lookup"><span data-stu-id="f68d2-155">_Calls.AccessMedia.All_ <sup>_see below_</sup></span></span>|<span data-ttu-id="f68d2-156">Acessar fluxos de mídia em uma chamada como um aplicativo (visualização)</span><span class="sxs-lookup"><span data-stu-id="f68d2-156">Access media streams in a call as an app (preview)</span></span>|<span data-ttu-id="f68d2-157">Permite que o aplicativo obtenha acesso direto aos fluxos de mídia em uma chamada sem um usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="f68d2-157">Allows the app to get direct access to media streams in a call, without a signed-in user.</span></span>|<span data-ttu-id="f68d2-158">Sim</span><span class="sxs-lookup"><span data-stu-id="f68d2-158">Yes</span></span>|

> [!IMPORTANT]
> <span data-ttu-id="f68d2-159">Você **não pode** usar a API Microsoft. Graph. calls. Media para registrar ou manter o conteúdo de mídia de chamadas ou reuniões que seu bot acessa.</span><span class="sxs-lookup"><span data-stu-id="f68d2-159">You **cannot** use the Microsoft.Graph.Calls.Media API to record or otherwise persist media content from calls or meetings that your bot accesses.</span></span>

### <a name="application-permissions-online-meetings"></a><span data-ttu-id="f68d2-160">Permissões de aplicativo: reuniões online</span><span class="sxs-lookup"><span data-stu-id="f68d2-160">Application permissions: online meetings</span></span>

|<span data-ttu-id="f68d2-161">Permissão</span><span class="sxs-lookup"><span data-stu-id="f68d2-161">Permission</span></span>    |<span data-ttu-id="f68d2-162">Exibir Cadeia de Caracteres</span><span class="sxs-lookup"><span data-stu-id="f68d2-162">Display String</span></span>   |<span data-ttu-id="f68d2-163">Descrição</span><span class="sxs-lookup"><span data-stu-id="f68d2-163">Description</span></span> |<span data-ttu-id="f68d2-164">Consentimento Obrigatório do Administrador</span><span class="sxs-lookup"><span data-stu-id="f68d2-164">Admin Consent Required</span></span> |
|:-----------------------------|:-----------------------------------------|:-----------------|:-----------------|
|<span data-ttu-id="f68d2-165">_OnlineMeetings.Read.All_</span><span class="sxs-lookup"><span data-stu-id="f68d2-165">_OnlineMeetings.Read.All_</span></span>|<span data-ttu-id="f68d2-166">Ler detalhes de Reunião Online do aplicativo (visualização)</span><span class="sxs-lookup"><span data-stu-id="f68d2-166">Read Online Meeting details from the app (preview)</span></span>|<span data-ttu-id="f68d2-167">Permite que o aplicativo leia os detalhes da Reunião Online em sua organização, sem um usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="f68d2-167">Allows the app to read Online Meeting details in your organization, without a signed-in user.</span></span>|<span data-ttu-id="f68d2-168">Sim</span><span class="sxs-lookup"><span data-stu-id="f68d2-168">Yes</span></span>|
|<span data-ttu-id="f68d2-169">_OnlineMeetings.ReadWrite.All_</span><span class="sxs-lookup"><span data-stu-id="f68d2-169">_OnlineMeetings.ReadWrite.All_</span></span>|<span data-ttu-id="f68d2-170">Leia e crie reuniões Online do aplicativo (visualização) em nome de um usuário</span><span class="sxs-lookup"><span data-stu-id="f68d2-170">Read and Create Online Meetings from the app (preview) on behalf of a user</span></span>|<span data-ttu-id="f68d2-171">Permite que o aplicativo crie reuniões Online em sua organização em nome de usuário, sem um usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="f68d2-171">Allows the app to create Online Meetings in your organization on behalf of a user, without a signed-in user.</span></span>|<span data-ttu-id="f68d2-172">Sim</span><span class="sxs-lookup"><span data-stu-id="f68d2-172">Yes</span></span>|

### <a name="assigning-permissions"></a><span data-ttu-id="f68d2-173">Atribuindo permissões</span><span class="sxs-lookup"><span data-stu-id="f68d2-173">Assigning permissions</span></span>

<span data-ttu-id="f68d2-174">Você deve configurar as permissões de aplicativo para o bot com antecedência.</span><span class="sxs-lookup"><span data-stu-id="f68d2-174">You must configure the application permissions for your bot in advance.</span></span> <span data-ttu-id="f68d2-175">Recomendamos o uso do [portal de registro de aplicativos da Microsoft](https://apps.dev.microsoft.com/) , conforme descrito [aqui](/graph/auth_register_app_v2) , porque o seu bot foi configurado; no entanto, você ainda pode usar o [portal do Azure](https://aka.ms/aadapplist) se preferir usar o [ponto de extremidade do Azure ad v1](/azure/active-directory/develop/azure-ad-endpoint-comparison).</span><span class="sxs-lookup"><span data-stu-id="f68d2-175">We recommend using the [Microsoft App Registration Portal](https://apps.dev.microsoft.com/) as described [here](/graph/auth_register_app_v2) because that's where your bot was configured; however, you can still use the [Azure portal](https://aka.ms/aadapplist) if you prefer to use the [Azure AD V1 endpoint](/azure/active-directory/develop/azure-ad-endpoint-comparison).</span></span>

### <a name="getting-tenant-administrator-consent"></a><span data-ttu-id="f68d2-176">Obtendo consentimento do administrador de locatários</span><span class="sxs-lookup"><span data-stu-id="f68d2-176">Getting tenant administrator consent</span></span>

<span data-ttu-id="f68d2-177">Para aplicativos que usam o ponto de extremidade do Azure AD v1, um administrador de locatários pode consentir as permissões de aplicativo usando o [portal do Azure](https://portal.azure.com) quando o aplicativo é instalado em sua organização ou você pode fornecer uma experiência de inscrição no seu aplicativo através da qual os administradores podem consentir as permissões que você configurou.</span><span class="sxs-lookup"><span data-stu-id="f68d2-177">For apps using the Azure AD V1 endpoint, a tenant administrator can consent to the application permissions using the [Azure portal](https://portal.azure.com) when your app is installed in their organization, or you can provide a sign-up experience in your app through which administrators can consent to the permissions you configured.</span></span> <span data-ttu-id="f68d2-178">Depois que o consentimento do administrador é registrado pelo Azure AD, seu aplicativo pode solicitar tokens sem precisar solicitar o consentimento novamente.</span><span class="sxs-lookup"><span data-stu-id="f68d2-178">Once administrator consent is recorded by Azure AD, your app can request tokens without having to request consent again.</span></span>

<span data-ttu-id="f68d2-179">Você pode confiar em um administrador para conceder as permissões de que seu aplicativo precisa no [portal do Azure](https://portal.azure.com); no entanto, geralmente, uma opção melhor é fornecer uma experiência de inscrição para administradores usando o ponto de extremidade do Azure AD v2 `/adminconsent` .</span><span class="sxs-lookup"><span data-stu-id="f68d2-179">You can rely on an administrator to grant the permissions your app needs at the [Azure portal](https://portal.azure.com); though, often a better option is to provide a sign-up experience for administrators by using the Azure AD V2 `/adminconsent` endpoint.</span></span>  <span data-ttu-id="f68d2-180">Confira as [instruções sobre como criar uma URL de consentimento de administrador](https://developer.microsoft.com/graph/docs/concepts/auth_v2_service#3-get-administrator-consent) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="f68d2-180">Please refer to the [instructions on constructing an Admin Consent URL](https://developer.microsoft.com/graph/docs/concepts/auth_v2_service#3-get-administrator-consent) for more information.</span></span>

> [!NOTE]
> <span data-ttu-id="f68d2-181">A criação da URL de consentimento do administrador do locatário requer um URI de redirecionamento/URL de resposta configurado no [portal de registro do aplicativo](https://apps.dev.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="f68d2-181">Constructing the Tenant Admin Consent URL requires a configured Redirect URI/Reply URL in the [App Registration Portal](https://apps.dev.microsoft.com/).</span></span> <span data-ttu-id="f68d2-182">Para adicionar URLs de resposta para o bot, acesse o registro de bot, escolha opções avançadas-> editar manifesto de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f68d2-182">To add reply URLs for your bot, access your bot registration, choose Advanced Options -> Edit Application Manifest.</span></span>  <span data-ttu-id="f68d2-183">Adicione a URL de redirecionamento à `replyUrls` coleção.</span><span class="sxs-lookup"><span data-stu-id="f68d2-183">Add your Redirect URL to the `replyUrls` collection.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f68d2-184">Sempre que você fizer uma alteração nas permissões do aplicativo, também deverá repetir o processo de consentimento do administrador.</span><span class="sxs-lookup"><span data-stu-id="f68d2-184">Anytime you make a change to your application's permissions, you must also repeat the Admin Consent process.</span></span> <span data-ttu-id="f68d2-185">As alterações feitas no portal de registro de aplicativos não serão refletidas até que o consentimento tiver sido reaplicado pelo administrador do locatário.</span><span class="sxs-lookup"><span data-stu-id="f68d2-185">Changes made in the app registration portal will not be reflected until consent has been reapplied by the tenant's administrator.</span></span>
