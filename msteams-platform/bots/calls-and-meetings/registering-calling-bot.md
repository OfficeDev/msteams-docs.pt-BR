---
title: Registrando um bot de chamada e reunião para o Microsoft Teams
description: Saiba como registrar um novo bot de chamada de áudio/vídeo para o Microsoft Teams
keywords: áudio do bot de chamada mídia de vídeo de áudio/vídeo
ms.openlocfilehash: 5a832646d4fa622f746f88a3a969ae4ad3ce69a6
ms.sourcegitcommit: bfdcd122b6b4ffc52d92320d4741f870c07f0542
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/02/2020
ms.locfileid: "49552441"
---
# <a name="register-a-calling-bot-for-microsoft-teams"></a><span data-ttu-id="e4932-104">Registrar um bot de chamada para o Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="e4932-104">Register a calling bot for Microsoft Teams</span></span>

<span data-ttu-id="e4932-105">Um bot que participa de chamadas de áudio/vídeo e reuniões online é um simples bot do Microsoft Teams com alguns recursos adicionais:</span><span class="sxs-lookup"><span data-stu-id="e4932-105">A bot that participates in audio/video calls and online meetings is an ordinary Microsoft Teams bot with a few extra features:</span></span>

* <span data-ttu-id="e4932-106">Há uma nova versão do manifesto de aplicativo do teams com duas configurações adicionais `supportsCalling` e `supportsVideo` .</span><span class="sxs-lookup"><span data-stu-id="e4932-106">There's a new version of the Teams app manifest with two additional settings, `supportsCalling` and `supportsVideo`.</span></span> <span data-ttu-id="e4932-107">Essas configurações estão incluídas na versão de [visualização do desenvolvedor](../../resources/dev-preview/developer-preview-intro.md) do manifesto do aplicativo Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="e4932-107">These settings are included in the [Developer Preview](../../resources/dev-preview/developer-preview-intro.md) version of the Microsoft Teams app manifest.</span></span>
* <span data-ttu-id="e4932-108">[As permissões do Microsoft Graph](./registering-calling-bot.md#add-microsoft-graph-permissions) devem ser configuradas para a ID do aplicativo da Microsoft de seu bot.</span><span class="sxs-lookup"><span data-stu-id="e4932-108">[Microsoft Graph permissions](./registering-calling-bot.md#add-microsoft-graph-permissions) must be configured for your bot's Microsoft App ID.</span></span>
* <span data-ttu-id="e4932-109">As chamadas do Microsoft Graph e as permissões de APIs de reuniões online exigem o consentimento do administrador do locatário.</span><span class="sxs-lookup"><span data-stu-id="e4932-109">The Microsoft Graph calls and online meetings APIs permissions require tenant admin consent.</span></span>

<span data-ttu-id="e4932-110">Vamos discutir o acima mais detalhadamente.</span><span class="sxs-lookup"><span data-stu-id="e4932-110">Let's discuss the above in more detail.</span></span>

## <a name="new-manifest-settings"></a><span data-ttu-id="e4932-111">Novas configurações de manifesto</span><span class="sxs-lookup"><span data-stu-id="e4932-111">New manifest settings</span></span>

<span data-ttu-id="e4932-112">Os bots de chamadas e de reuniões online têm duas configurações adicionais no manifest.jsque permitem áudio/vídeo para o bot no Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="e4932-112">Calling and online meetings bots have two additional settings in the manifest.json that enable audio/video for your bot in Teams.</span></span>

* <span data-ttu-id="e4932-113">`bots[0].supportsCalling`.</span><span class="sxs-lookup"><span data-stu-id="e4932-113">`bots[0].supportsCalling`.</span></span> <span data-ttu-id="e4932-114">Se presente e definido como `true` , o Microsoft Teams permitirá que o bot participe de chamadas e reuniões online.</span><span class="sxs-lookup"><span data-stu-id="e4932-114">If present and set to `true`, Teams will allow your bot to participate in calls and online meetings.</span></span>
* <span data-ttu-id="e4932-115">`bots[0].supportsVideo`.</span><span class="sxs-lookup"><span data-stu-id="e4932-115">`bots[0].supportsVideo`.</span></span> <span data-ttu-id="e4932-116">Se presente e definido como `true` , o Teams sabe que seu bot oferece suporte a vídeo.</span><span class="sxs-lookup"><span data-stu-id="e4932-116">If present and set to `true`, Teams knows that your bot supports video.</span></span>

<span data-ttu-id="e4932-117">Se quiser que o IDE valide corretamente o manifest.jsno esquema para o seu bot de chamada e de reunião para estes valores, você pode alterar o `$schema` atributo da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="e4932-117">If you want your IDE to properly validate the manifest.json schema for your calling and meeting bot for these values, you can change the `$schema` attribute as follows:</span></span>

```json
"$schema": "https://raw.githubusercontent.com/OfficeDev/microsoft-teams-app-schema/preview/DevPreview/MicrosoftTeams.schema.json",
```

## <a name="creating-a-new-bot-or-adding-calling-capabilities-to-an-existing-bot"></a><span data-ttu-id="e4932-118">Criando um novo bot ou adicionando recursos de chamada a um bot existente</span><span class="sxs-lookup"><span data-stu-id="e4932-118">Creating a new bot or adding calling capabilities to an existing bot</span></span>

<span data-ttu-id="e4932-119">A criação de um novo bot é abordada em mais detalhes no tópico [criar um bot para o Microsoft Teams](../how-to/create-a-bot-for-teams.md) , mas repetiremos alguns deles:</span><span class="sxs-lookup"><span data-stu-id="e4932-119">Creating a new bot is covered in more detail in the [Create a bot for Microsoft Teams](../how-to/create-a-bot-for-teams.md) topic, but we'll repeat some of it here:</span></span>

1. <span data-ttu-id="e4932-120">Use este link para criar um novo bot: `https://dev.botframework.com/bots/new` .</span><span class="sxs-lookup"><span data-stu-id="e4932-120">Use this link to create a new bot: `https://dev.botframework.com/bots/new`.</span></span> <span data-ttu-id="e4932-121">Se, em vez disso, você selecionar o botão *criar um bot* no portal da estrutura do bot, você criará seu bot no Microsoft Azure, para o qual você precisará de uma conta do Azure.</span><span class="sxs-lookup"><span data-stu-id="e4932-121">If, instead,  you select the *Create a bot* button in the Bot Framework portal, you will create your bot in Microsoft Azure, for which you'll need an Azure account.</span></span>
1. <span data-ttu-id="e4932-122">Adicione o canal do Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="e4932-122">Add the Microsoft Teams channel.</span></span> <span data-ttu-id="e4932-123">Clique na guia "chamada" na página Microsoft Teams Channel e selecione **habilitar chamadas** e, em seguida, atualizar **webhook (para chamadas)** com a URL https onde você receberá notificações de entrada, por exemplo `https://contoso.com/teamsapp/api/calling` ,.</span><span class="sxs-lookup"><span data-stu-id="e4932-123">Click on the "Calling" tab on the Microsoft Teams channel page and select **Enable calling**, and then update **Webhook (for calling)** with your HTTPS URL where you will receive incoming notifications, e.g.`https://contoso.com/teamsapp/api/calling`.</span></span> <span data-ttu-id="e4932-124">Consulte [Configurando canais](/bot-framework/portal-configure-channels) para obter mais informações sobre como configurar canais.</span><span class="sxs-lookup"><span data-stu-id="e4932-124">Refer to [Configuring Channels](/bot-framework/portal-configure-channels) for more information on how to configure channels.</span></span>
  <span data-ttu-id="e4932-125">![Configurar informações de canal do Microsoft Teams](~/assets/images/calls-and-meetings/configure-msteams-channel.png)</span><span class="sxs-lookup"><span data-stu-id="e4932-125">![Configure Microsoft Teams channel information](~/assets/images/calls-and-meetings/configure-msteams-channel.png)</span></span>

## <a name="add-microsoft-graph-permissions"></a><span data-ttu-id="e4932-126">Adicionar permissões do Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="e4932-126">Add Microsoft Graph permissions</span></span>

<span data-ttu-id="e4932-127">O Microsoft Graph expõe permissões granulares que controlam o acesso que os aplicativos têm aos recursos.</span><span class="sxs-lookup"><span data-stu-id="e4932-127">Microsoft Graph exposes granular permissions controlling the access that apps have to resources.</span></span> <span data-ttu-id="e4932-128">Como desenvolvedor, você decide quais permissões para o Microsoft Graph seu aplicativo deverá solicitar.</span><span class="sxs-lookup"><span data-stu-id="e4932-128">As a developer, you decide which permissions for Microsoft Graph your app requests.</span></span>  <span data-ttu-id="e4932-129">As APIs de chamada do Microsoft Graph dão suporte a _permissões de aplicativo_, que são usadas por aplicativos executados sem um usuário conectado presente.</span><span class="sxs-lookup"><span data-stu-id="e4932-129">The Microsoft Graph Calling APIs support _Application permissions_, which are used by apps that run without a signed-in user present.</span></span>  <span data-ttu-id="e4932-130">Um administrador de locatários deve conceder consentimento às permissões do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e4932-130">A tenant administrator must grant consent to application permissions.</span></span> <span data-ttu-id="e4932-131">Veja a seguir uma lista dessas permissões:</span><span class="sxs-lookup"><span data-stu-id="e4932-131">Below is a list of those permissions:</span></span>

### <a name="application-permissions-calls"></a><span data-ttu-id="e4932-132">Permissões de aplicativo: chamadas</span><span class="sxs-lookup"><span data-stu-id="e4932-132">Application permissions: calls</span></span>

|<span data-ttu-id="e4932-133">Permissão</span><span class="sxs-lookup"><span data-stu-id="e4932-133">Permission</span></span>    |<span data-ttu-id="e4932-134">Exibir Cadeia de Caracteres</span><span class="sxs-lookup"><span data-stu-id="e4932-134">Display String</span></span>   |<span data-ttu-id="e4932-135">Descrição</span><span class="sxs-lookup"><span data-stu-id="e4932-135">Description</span></span> |<span data-ttu-id="e4932-136">Consentimento Obrigatório do Administrador</span><span class="sxs-lookup"><span data-stu-id="e4932-136">Admin Consent Required</span></span> |
|:-----------------------------|:-----------------------------------------|:-----------------|:-----------------|
|<span data-ttu-id="e4932-137">_Calls.Initiate.All_</span><span class="sxs-lookup"><span data-stu-id="e4932-137">_Calls.Initiate.All_</span></span>|<span data-ttu-id="e4932-138">Iniciar chamadas de saída 1:1 do aplicativo (visualização)</span><span class="sxs-lookup"><span data-stu-id="e4932-138">Initiate outgoing 1:1 calls from the app (preview)</span></span>|<span data-ttu-id="e4932-139">Permite que o aplicativo faça chamadas de saída para um único usuário e transfira chamadas para usuários no diretório da sua organização, sem um usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="e4932-139">Allows the app to place outbound calls to a single user and transfer calls to users in your organization’s directory, without a signed-in user.</span></span>|<span data-ttu-id="e4932-140">Sim</span><span class="sxs-lookup"><span data-stu-id="e4932-140">Yes</span></span>|
|<span data-ttu-id="e4932-141">_Calls.InitiateGroupCall.All_</span><span class="sxs-lookup"><span data-stu-id="e4932-141">_Calls.InitiateGroupCall.All_</span></span>|<span data-ttu-id="e4932-142">Iniciar a saída de chamadas de grupo do aplicativo (visualização)</span><span class="sxs-lookup"><span data-stu-id="e4932-142">Initiate outgoing group calls from the app (preview)</span></span>|<span data-ttu-id="e4932-143">Permite que o aplicativo faça chamadas para vários usuários e adicione participantes a reuniões em sua organização, sem um usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="e4932-143">Allows the app to place outbound calls to multiple users and add participants to meetings in your organization, without a signed-in user.</span></span>|<span data-ttu-id="e4932-144">Sim</span><span class="sxs-lookup"><span data-stu-id="e4932-144">Yes</span></span>|
|<span data-ttu-id="e4932-145">_Calls.JoinGroupCall.All_</span><span class="sxs-lookup"><span data-stu-id="e4932-145">_Calls.JoinGroupCall.All_</span></span>|<span data-ttu-id="e4932-146">Ingresse em reuniões e chamadas de grupo como um aplicativo (visualização)</span><span class="sxs-lookup"><span data-stu-id="e4932-146">Join Group Calls and Meetings as an app (preview)</span></span>|<span data-ttu-id="e4932-147">Permite que o aplicativo ingresse em reuniões agendadas e chamadas de grupo em sua organização, sem um usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="e4932-147">Allows the app to join group calls and scheduled meetings in your organization, without a signed-in user.</span></span> <span data-ttu-id="e4932-148">O aplicativo será associado aos privilégios de um usuário do diretório para reuniões em seu locatário.</span><span class="sxs-lookup"><span data-stu-id="e4932-148">The app will be joined with the privileges of a directory user to meetings in your tenant.</span></span>|<span data-ttu-id="e4932-149">Sim</span><span class="sxs-lookup"><span data-stu-id="e4932-149">Yes</span></span>|
|<span data-ttu-id="e4932-150">_Calls.JoinGroupCallasGuest.All_</span><span class="sxs-lookup"><span data-stu-id="e4932-150">_Calls.JoinGroupCallasGuest.All_</span></span>|<span data-ttu-id="e4932-151">Ingressar em reuniões e chamadas de grupo como um convidado (visualização)</span><span class="sxs-lookup"><span data-stu-id="e4932-151">Join Group Calls and Meetings as a guest (preview)</span></span>|<span data-ttu-id="e4932-152">Permite que o aplicativo ingresse anonimamente no grupo chamadas e em reuniões agendadas em sua organização, sem um usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="e4932-152">Allows the app to anonymously join group calls and scheduled meetings in your organization, without a signed-in user.</span></span> <span data-ttu-id="e4932-153">O aplicativo ingressará como convidado para reuniões em seu locatário.</span><span class="sxs-lookup"><span data-stu-id="e4932-153">The app will be joined as a guest to meetings in your tenant.</span></span>|<span data-ttu-id="e4932-154">Sim</span><span class="sxs-lookup"><span data-stu-id="e4932-154">Yes</span></span>|
|<span data-ttu-id="e4932-155">_Calls. AccessMedia. All_ <sup> _Veja abaixo_</sup></span><span class="sxs-lookup"><span data-stu-id="e4932-155">_Calls.AccessMedia.All_ <sup>_see below_</sup></span></span>|<span data-ttu-id="e4932-156">Acessar fluxos de mídia em uma chamada como um aplicativo (visualização)</span><span class="sxs-lookup"><span data-stu-id="e4932-156">Access media streams in a call as an app (preview)</span></span>|<span data-ttu-id="e4932-157">Permite que o aplicativo obtenha acesso direto aos fluxos de mídia em uma chamada sem um usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="e4932-157">Allows the app to get direct access to media streams in a call, without a signed-in user.</span></span>|<span data-ttu-id="e4932-158">Sim</span><span class="sxs-lookup"><span data-stu-id="e4932-158">Yes</span></span>|

> [!IMPORTANT]
> <span data-ttu-id="e4932-159">Você **não pode** usar a API de acesso à mídia para registrar ou persistir o conteúdo de mídia de chamadas ou reuniões que seu aplicativo acessa, ou dados derivados desse conteúdo de mídia ("Record" ou "Recording"), sem primeiro chamar a [ `updateRecordingStatus` API](/graph/api/call-updaterecordingstatus) para indicar que a gravação foi iniciada e receber uma resposta de êxito dessa API.</span><span class="sxs-lookup"><span data-stu-id="e4932-159">You **cannot** use the Media Access API to record or otherwise persist media content from calls or meetings that your application accesses, or data derived from that media content ("record" or "recording"), without first calling the [`updateRecordingStatus` API](/graph/api/call-updaterecordingstatus) to indicate that recording has begun, and receiving a success reply from that API.</span></span> <span data-ttu-id="e4932-160">Se o aplicativo começar a gravar qualquer reunião/chamada, ele deverá finalizar a gravação antes de chamar a `updateRecordingStatus` API para indicar que a gravação foi concluída.</span><span class="sxs-lookup"><span data-stu-id="e4932-160">If your application begins recording any meeting/call, it must end the recording prior to calling the `updateRecordingStatus` API to indicate that the recording has ended.</span></span>

### <a name="application-permissions-online-meetings"></a><span data-ttu-id="e4932-161">Permissões de aplicativo: reuniões online</span><span class="sxs-lookup"><span data-stu-id="e4932-161">Application permissions: online meetings</span></span>

|<span data-ttu-id="e4932-162">Permissão</span><span class="sxs-lookup"><span data-stu-id="e4932-162">Permission</span></span>    |<span data-ttu-id="e4932-163">Exibir Cadeia de Caracteres</span><span class="sxs-lookup"><span data-stu-id="e4932-163">Display String</span></span>   |<span data-ttu-id="e4932-164">Descrição</span><span class="sxs-lookup"><span data-stu-id="e4932-164">Description</span></span> |<span data-ttu-id="e4932-165">Consentimento Obrigatório do Administrador</span><span class="sxs-lookup"><span data-stu-id="e4932-165">Admin Consent Required</span></span> |
|:-----------------------------|:-----------------------------------------|:-----------------|:-----------------|
|<span data-ttu-id="e4932-166">_OnlineMeetings.Read.All_</span><span class="sxs-lookup"><span data-stu-id="e4932-166">_OnlineMeetings.Read.All_</span></span>|<span data-ttu-id="e4932-167">Ler detalhes de Reunião Online do aplicativo (visualização)</span><span class="sxs-lookup"><span data-stu-id="e4932-167">Read Online Meeting details from the app (preview)</span></span>|<span data-ttu-id="e4932-168">Permite que o aplicativo leia os detalhes da Reunião Online em sua organização, sem um usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="e4932-168">Allows the app to read Online Meeting details in your organization, without a signed-in user.</span></span>|<span data-ttu-id="e4932-169">Sim</span><span class="sxs-lookup"><span data-stu-id="e4932-169">Yes</span></span>|
|<span data-ttu-id="e4932-170">_OnlineMeetings.ReadWrite.All_</span><span class="sxs-lookup"><span data-stu-id="e4932-170">_OnlineMeetings.ReadWrite.All_</span></span>|<span data-ttu-id="e4932-171">Leia e crie reuniões Online do aplicativo (visualização) em nome de um usuário</span><span class="sxs-lookup"><span data-stu-id="e4932-171">Read and Create Online Meetings from the app (preview) on behalf of a user</span></span>|<span data-ttu-id="e4932-172">Permite que o aplicativo crie reuniões Online em sua organização em nome de usuário, sem um usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="e4932-172">Allows the app to create Online Meetings in your organization on behalf of a user, without a signed-in user.</span></span>|<span data-ttu-id="e4932-173">Sim</span><span class="sxs-lookup"><span data-stu-id="e4932-173">Yes</span></span>|

### <a name="assigning-permissions"></a><span data-ttu-id="e4932-174">Atribuindo permissões</span><span class="sxs-lookup"><span data-stu-id="e4932-174">Assigning permissions</span></span>

<span data-ttu-id="e4932-175">Você deve configurar as permissões de aplicativo para o bot com antecedência usando o [portal do Azure](https://aka.ms/aadapplist) se preferir usar o [ponto de extremidade do Azure ad v1](/azure/active-directory/develop/azure-ad-endpoint-comparison).</span><span class="sxs-lookup"><span data-stu-id="e4932-175">You must configure the application permissions for your bot in advance by using the [Azure portal](https://aka.ms/aadapplist) if you prefer to use the [Azure AD V1 endpoint](/azure/active-directory/develop/azure-ad-endpoint-comparison).</span></span>

### <a name="getting-tenant-administrator-consent"></a><span data-ttu-id="e4932-176">Obtendo consentimento do administrador de locatários</span><span class="sxs-lookup"><span data-stu-id="e4932-176">Getting tenant administrator consent</span></span>

<span data-ttu-id="e4932-177">Para aplicativos que usam o ponto de extremidade do Azure AD v1, um administrador de locatários pode consentir as permissões de aplicativo usando o [portal do Azure](https://portal.azure.com) quando o aplicativo é instalado em sua organização ou você pode fornecer uma experiência de inscrição no seu aplicativo através da qual os administradores podem consentir as permissões que você configurou.</span><span class="sxs-lookup"><span data-stu-id="e4932-177">For apps using the Azure AD V1 endpoint, a tenant administrator can consent to the application permissions using the [Azure portal](https://portal.azure.com) when your app is installed in their organization, or you can provide a sign-up experience in your app through which administrators can consent to the permissions you configured.</span></span> <span data-ttu-id="e4932-178">Depois que o consentimento do administrador é registrado pelo Azure AD, seu aplicativo pode solicitar tokens sem precisar solicitar o consentimento novamente.</span><span class="sxs-lookup"><span data-stu-id="e4932-178">Once administrator consent is recorded by Azure AD, your app can request tokens without having to request consent again.</span></span>

<span data-ttu-id="e4932-179">Você pode confiar em um administrador para conceder as permissões de que seu aplicativo precisa no [portal do Azure](https://portal.azure.com); no entanto, geralmente, uma opção melhor é fornecer uma experiência de inscrição para administradores usando o ponto de extremidade do Azure AD v2 `/adminconsent` .</span><span class="sxs-lookup"><span data-stu-id="e4932-179">You can rely on an administrator to grant the permissions your app needs at the [Azure portal](https://portal.azure.com); though, often a better option is to provide a sign-up experience for administrators by using the Azure AD V2 `/adminconsent` endpoint.</span></span>  <span data-ttu-id="e4932-180">Confira as [instruções sobre como criar uma URL de consentimento de administrador](https://developer.microsoft.com/graph/docs/concepts/auth_v2_service#3-get-administrator-consent) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="e4932-180">Please refer to the [instructions on constructing an Admin Consent URL](https://developer.microsoft.com/graph/docs/concepts/auth_v2_service#3-get-administrator-consent) for more information.</span></span>

> [!NOTE]
> <span data-ttu-id="e4932-181">A criação da URL de consentimento do administrador do locatário requer um URI de redirecionamento/URL de resposta configurado no [portal de registro do aplicativo](https://apps.dev.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="e4932-181">Constructing the Tenant Admin Consent URL requires a configured Redirect URI/Reply URL in the [App Registration Portal](https://apps.dev.microsoft.com/).</span></span> <span data-ttu-id="e4932-182">Para adicionar URLs de resposta para o bot, acesse o registro de bot, escolha opções avançadas-> editar manifesto de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e4932-182">To add reply URLs for your bot, access your bot registration, choose Advanced Options -> Edit Application Manifest.</span></span>  <span data-ttu-id="e4932-183">Adicione a URL de redirecionamento à `replyUrls` coleção.</span><span class="sxs-lookup"><span data-stu-id="e4932-183">Add your Redirect URL to the `replyUrls` collection.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e4932-184">Sempre que você fizer uma alteração nas permissões do aplicativo, também deverá repetir o processo de consentimento do administrador.</span><span class="sxs-lookup"><span data-stu-id="e4932-184">Anytime you make a change to your application's permissions, you must also repeat the Admin Consent process.</span></span> <span data-ttu-id="e4932-185">As alterações feitas no portal de registro de aplicativos não serão refletidas até que o consentimento tiver sido reaplicado pelo administrador do locatário.</span><span class="sxs-lookup"><span data-stu-id="e4932-185">Changes made in the app registration portal will not be reflected until consent has been reapplied by the tenant's administrator.</span></span>
